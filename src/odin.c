// Automatically generated by odin - do not edit
#include <R.h>
#include <Rmath.h>
#include <Rinternals.h>
#include <stdbool.h>
#include <R_ext/Rdynload.h>
typedef struct odin_model_determ_internal {
  double *age_I1;
  double *age_I1_prob;
  double *age_I1_trials;
  double age_per;
  double *age_R1;
  double *age_R1_prob;
  double *age_S;
  double *age_S_prob;
  double *age_S_trials;
  double *agec;
  double *agert;
  double *amplitudes_phases;
  double Beta_hm_1;
  double Beta_mh_1;
  double BG_FOI;
  double *births;
  double *births_lambda;
  double *deathrt;
  double *Delta;
  double Delta_season;
  double *Delta_wb;
  double DeltaBase;
  int dim_age_I1;
  int dim_age_I1_1;
  int dim_age_I1_12;
  int dim_age_I1_2;
  int dim_age_I1_3;
  int dim_age_I1_prob;
  int dim_age_I1_trials;
  int dim_age_I1_trials_1;
  int dim_age_I1_trials_12;
  int dim_age_I1_trials_2;
  int dim_age_I1_trials_3;
  int dim_age_R1;
  int dim_age_R1_1;
  int dim_age_R1_12;
  int dim_age_R1_2;
  int dim_age_R1_3;
  int dim_age_R1_prob;
  int dim_age_S;
  int dim_age_S_1;
  int dim_age_S_12;
  int dim_age_S_2;
  int dim_age_S_3;
  int dim_age_S_prob;
  int dim_age_S_trials;
  int dim_age_S_trials_1;
  int dim_age_S_trials_12;
  int dim_age_S_trials_2;
  int dim_age_S_trials_3;
  int dim_agec;
  int dim_agert;
  int dim_amplitudes_phases;
  int dim_amplitudes_phases_1;
  int dim_amplitudes_phases_2;
  int dim_births;
  int dim_births_lambda;
  int dim_deathrt;
  int dim_Delta;
  int dim_Delta_wb;
  int dim_eip;
  int dim_FOI1;
  int dim_FOI1nn;
  int dim_FOI1p;
  int dim_FOI1Y;
  int dim_I1;
  int dim_I1_1;
  int dim_I1_12;
  int dim_I1_2;
  int dim_I1_3;
  int dim_incubA;
  int dim_incubB;
  int dim_inf_1;
  int dim_inf_1_1;
  int dim_inf_1_12;
  int dim_inf_1_2;
  int dim_inf_1_3;
  int dim_inf_1_prob;
  int dim_inf_1_prob_1;
  int dim_inf_1_prob_12;
  int dim_inf_1_prob_2;
  int dim_inf_1_prob_3;
  int dim_infectious1;
  int dim_infectiousA;
  int dim_infectiousB;
  int dim_init_I1;
  int dim_init_I1_1;
  int dim_init_I1_12;
  int dim_init_I1_2;
  int dim_init_I1_3;
  int dim_init_R1;
  int dim_init_R1_1;
  int dim_init_R1_12;
  int dim_init_R1_2;
  int dim_init_R1_3;
  int dim_init_S;
  int dim_init_S_1;
  int dim_init_S_12;
  int dim_init_S_2;
  int dim_init_S_3;
  int dim_Kc;
  int dim_L_deathrt;
  int dim_L_dr;
  int dim_ln_pick;
  int dim_Lwb;
  int dim_Lwb_birth;
  int dim_Lwb_birth_lambda;
  int dim_Lwb_mature;
  int dim_Lwb_mature_prob;
  int dim_Lwt;
  int dim_Lwt_birth;
  int dim_Lwt_birth_lambda;
  int dim_Lwt_mature;
  int dim_Lwt_mature_prob;
  int dim_M_propinf;
  int dim_M_tot;
  int dim_Mwb_E1;
  int dim_Mwb_E1_incub;
  int dim_Mwb_E1_incub_prob;
  int dim_Mwb_E2;
  int dim_Mwb_E2_incub;
  int dim_Mwb_E2_incub_prob;
  int dim_Mwb_FOI1;
  int dim_Mwb_I1;
  int dim_Mwb_inf1;
  int dim_Mwb_inf1_prob;
  int dim_Mwb_intro;
  int dim_Mwb_propinf;
  int dim_Mwb_S;
  int dim_Mwb_tot;
  int dim_Mwt;
  int dim_Mwt_E1;
  int dim_Mwt_E1_incub;
  int dim_Mwt_E1_incub_prob;
  int dim_Mwt_E2;
  int dim_Mwt_E2_incub;
  int dim_Mwt_E2_incub_prob;
  int dim_Mwt_FOI1;
  int dim_Mwt_I1;
  int dim_Mwt_inf1;
  int dim_Mwt_inf1_prob;
  int dim_Mwt_propinf;
  int dim_Mwt_S;
  int dim_Mwt_tot;
  int dim_N_eq;
  int dim_n_I1;
  int dim_n_I1_1;
  int dim_n_I1_12;
  int dim_n_I1_2;
  int dim_n_I1_3;
  int dim_n_R1;
  int dim_n_R1_1;
  int dim_n_R1_12;
  int dim_n_R1_2;
  int dim_n_R1_3;
  int dim_n_S;
  int dim_n_S_1;
  int dim_n_S_12;
  int dim_n_S_2;
  int dim_n_S_3;
  int dim_Nb;
  int dim_nn;
  int dim_nn_1;
  int dim_nn_2;
  int dim_Ntotal;
  int dim_Ntotal_1;
  int dim_Ntotal_12;
  int dim_Ntotal_2;
  int dim_Ntotal_3;
  int dim_Ntotal_sum;
  int dim_Ntotal_sum_1;
  int dim_Ntotal_sum_2;
  int dim_NTp;
  int dim_O_I1;
  int dim_O_I1_1;
  int dim_O_I1_12;
  int dim_O_I1_2;
  int dim_O_I1_3;
  int dim_O_I1_prob;
  int dim_O_Lwb;
  int dim_O_Lwb_prob;
  int dim_O_Lwt;
  int dim_O_Lwt_prob;
  int dim_O_Mwb_E1;
  int dim_O_Mwb_E1_prob;
  int dim_O_Mwb_E2;
  int dim_O_Mwb_E2_prob;
  int dim_O_Mwb_I1;
  int dim_O_Mwb_I1_prob;
  int dim_O_Mwb_S;
  int dim_O_Mwb_S_prob;
  int dim_O_Mwt_E1;
  int dim_O_Mwt_E1_prob;
  int dim_O_Mwt_E2;
  int dim_O_Mwt_E2_prob;
  int dim_O_Mwt_I1;
  int dim_O_Mwt_I1_prob;
  int dim_O_Mwt_S;
  int dim_O_Mwt_S_prob;
  int dim_O_R1;
  int dim_O_R1_1;
  int dim_O_R1_12;
  int dim_O_R1_2;
  int dim_O_R1_3;
  int dim_O_R1_prob;
  int dim_O_S;
  int dim_O_S_1;
  int dim_O_S_12;
  int dim_O_S_2;
  int dim_O_S_3;
  int dim_O_S_prob;
  int dim_O_S_prob_1;
  int dim_O_S_prob_12;
  int dim_O_S_prob_2;
  int dim_O_S_prob_3;
  int dim_phi1;
  int dim_prop_Sp;
  int dim_prop_wb;
  int dim_R0t_1;
  int dim_R1;
  int dim_R1_1;
  int dim_R1_12;
  int dim_R1_2;
  int dim_R1_3;
  int dim_recov1;
  int dim_recov1_1;
  int dim_recov1_12;
  int dim_recov1_2;
  int dim_recov1_3;
  int dim_recov1_prob;
  int dim_rho1;
  int dim_S;
  int dim_S_1;
  int dim_S_12;
  int dim_S_2;
  int dim_S_3;
  int dim_season_amp;
  int dim_season_phases;
  int dim_sum_S;
  int dim_sum_S_1;
  int dim_sum_S_2;
  int dim_vacc_child_age;
  int dim_vacc_cu_age;
  int dim_vacc_noncov;
  int dim_vacc_noncov_1;
  int dim_vacc_noncov_2;
  int dim_vcu_noncov;
  int dim_vcu_noncov_1;
  int dim_vcu_noncov_2;
  int dim_Wb_introrate;
  int dim_Wb_introtime;
  int dim_Y1;
  int dim_Y1_1;
  int dim_Y1_12;
  int dim_Y1_2;
  int dim_Y1_3;
  int dim_Y1T;
  int dim_Y1T_sum;
  int dim_Y1T_sum_1;
  int dim_Y1T_sum_2;
  double DT;
  double *eip;
  double eip_mean;
  double eip_season;
  double Epsilon;
  double *FOI1;
  double *FOI1nn;
  double *FOI1p;
  double *FOI1Y;
  double Gamma;
  double incub;
  double *inf_1;
  double *inf_1_prob;
  double inf_per;
  double *infectious1;
  double *init_I1;
  double *init_R1;
  double *init_S;
  double *initial_I1;
  double *initial_incubA;
  double *initial_incubB;
  double *initial_infectiousA;
  double *initial_infectiousB;
  double *initial_Lwb;
  double *initial_Lwt;
  double *initial_Mwb_E1;
  double *initial_Mwb_E2;
  double *initial_Mwb_I1;
  double *initial_Mwb_S;
  double *initial_Mwt_E1;
  double *initial_Mwt_E2;
  double *initial_Mwt_I1;
  double *initial_Mwt_S;
  double *initial_R1;
  double *initial_S;
  double Kappa;
  double *Kc;
  double Kc_mean;
  double Kc_season;
  double *L_deathrt;
  double *L_dr;
  double ln_mean;
  double *ln_pick;
  double ln_sd;
  double *Lwb_birth;
  double *Lwb_birth_lambda;
  double *Lwb_mature;
  double *Lwb_mature_prob;
  double *Lwt_birth;
  double *Lwt_birth_lambda;
  double *Lwt_mature;
  double *Lwt_mature_prob;
  double *M_propinf;
  double *M_tot;
  double *Mwb_E1_incub;
  double *Mwb_E1_incub_prob;
  double *Mwb_E2_incub;
  double *Mwb_E2_incub_prob;
  double *Mwb_FOI1;
  double *Mwb_inf1;
  double *Mwb_inf1_prob;
  double *Mwb_intro;
  double *Mwb_propinf;
  double *Mwb_tot;
  double *Mwt;
  double Mwt_cv;
  double *Mwt_E1_incub;
  double *Mwt_E1_incub_prob;
  double *Mwt_E2_incub;
  double *Mwt_E2_incub_prob;
  double *Mwt_FOI1;
  double *Mwt_inf1;
  double *Mwt_inf1_prob;
  double Mwt_mean;
  double *Mwt_propinf;
  double *Mwt_tot;
  double *N_eq;
  double *n_I1;
  double *n_R1;
  double *n_S;
  int na;
  double *Nb;
  int *nn;
  int NP;
  double *Ntotal;
  double *Ntotal_sum;
  double *NTp;
  double nu;
  double *O_I1;
  double *O_I1_prob;
  double *O_Lwb;
  double *O_Lwb_prob;
  double *O_Lwt;
  double *O_Lwt_prob;
  double *O_Mwb_E1;
  double *O_Mwb_E1_prob;
  double *O_Mwb_E2;
  double *O_Mwb_E2_prob;
  double *O_Mwb_I1;
  double *O_Mwb_I1_prob;
  double *O_Mwb_S;
  double *O_Mwb_S_prob;
  double *O_Mwt_E1;
  double *O_Mwt_E1_prob;
  double *O_Mwt_E2;
  double *O_Mwt_E2_prob;
  double *O_Mwt_I1;
  double *O_Mwt_I1_prob;
  double *O_Mwt_S;
  double *O_Mwt_S_prob;
  double *O_R1;
  double *O_R1_prob;
  double *O_S;
  double *O_S_prob;
  int offset_output_age_I1;
  int offset_output_age_R1;
  int offset_output_age_S;
  int offset_output_births;
  int offset_output_deathrt;
  int offset_output_Delta;
  int offset_output_eip;
  int offset_output_FOI1;
  int offset_output_FOI1nn;
  int offset_output_FOI1p;
  int offset_output_FOI1Y;
  int offset_output_inf_1;
  int offset_output_inf_1_prob;
  int offset_output_infectious1;
  int offset_output_Kc;
  int offset_output_Lwb_birth;
  int offset_output_Lwb_mature;
  int offset_output_Lwt_birth;
  int offset_output_Lwt_mature;
  int offset_output_M_propinf;
  int offset_output_Mwb_inf1;
  int offset_output_Mwb_intro;
  int offset_output_Mwb_propinf;
  int offset_output_Mwb_tot;
  int offset_output_Mwt_FOI1;
  int offset_output_Mwt_inf1;
  int offset_output_Mwt_propinf;
  int offset_output_Mwt_tot;
  int offset_output_Ntotal;
  int offset_output_NTp;
  int offset_output_O_I1;
  int offset_output_O_R1;
  int offset_output_O_S;
  int offset_output_O_S_prob;
  int offset_output_prop_Sp;
  int offset_output_prop_wb;
  int offset_output_R0t_1;
  int offset_output_recov1;
  int offset_output_rho1;
  int offset_output_vacc_noncov;
  int offset_output_Wb_introrate;
  int offset_output_Y1T;
  int offset_variable_I1;
  int offset_variable_incubA;
  int offset_variable_incubB;
  int offset_variable_infectiousA;
  int offset_variable_infectiousB;
  int offset_variable_Lwb;
  int offset_variable_Mwb_E1;
  int offset_variable_Mwb_E2;
  int offset_variable_Mwb_I1;
  int offset_variable_Mwb_S;
  int offset_variable_Mwt_E1;
  int offset_variable_Mwt_E2;
  int offset_variable_Mwt_I1;
  int offset_variable_R1;
  int offset_variable_S;
  double Omega;
  double *phi1;
  double pi;
  double *prop_Sp;
  double *prop_wb;
  double propMwtControl;
  double propTransGlobal;
  double propTransNN;
  double *R0t_1;
  double *recov1;
  double *recov1_prob;
  double *rho1;
  double Rm;
  double *season_amp;
  double *season_phases;
  double Sigma;
  double *sum_S;
  double TimeMwtControlOff;
  double TimeMwtControlOn;
  double *vacc_child_age;
  double vacc_child_coverage;
  double vacc_child_starttime;
  double vacc_child_stoptime;
  double *vacc_cu_age;
  double vacc_cu_coverage;
  double vacc_cu_rndtime;
  double *vacc_noncov;
  double *vcu_noncov;
  int vnc_row;
  double Wb_cyto;
  double Wb_fF;
  double Wb_fM;
  double Wb_introduration;
  double Wb_introlevel;
  double *Wb_introrate;
  double *Wb_introtime;
  double Wb_mat;
  double Wb_relinf1;
  double Wb_relsusc1;
  double *Y1;
  double *Y1T;
  double *Y1T_sum;
  double YL;
} odin_model_determ_internal;
typedef struct odin_model_stoch_internal {
  double *age_I1;
  double *age_I1_prob;
  double *age_I1_trials;
  double age_per;
  double *age_R1;
  double *age_R1_prob;
  double *age_S;
  double *age_S_prob;
  double *age_S_trials;
  double *agec;
  double *agert;
  double Beta_hm_1;
  double Beta_mh_1;
  double BG_FOI;
  double *births;
  double *births_lambda;
  double *deathrt;
  double *Delta;
  double Delta_season;
  double DeltaBase;
  int dim_age_I1;
  int dim_age_I1_1;
  int dim_age_I1_12;
  int dim_age_I1_2;
  int dim_age_I1_3;
  int dim_age_I1_prob;
  int dim_age_I1_trials;
  int dim_age_I1_trials_1;
  int dim_age_I1_trials_12;
  int dim_age_I1_trials_2;
  int dim_age_I1_trials_3;
  int dim_age_R1;
  int dim_age_R1_1;
  int dim_age_R1_12;
  int dim_age_R1_2;
  int dim_age_R1_3;
  int dim_age_R1_prob;
  int dim_age_S;
  int dim_age_S_1;
  int dim_age_S_12;
  int dim_age_S_2;
  int dim_age_S_3;
  int dim_age_S_prob;
  int dim_age_S_trials;
  int dim_age_S_trials_1;
  int dim_age_S_trials_12;
  int dim_age_S_trials_2;
  int dim_age_S_trials_3;
  int dim_agec;
  int dim_agert;
  int dim_births;
  int dim_births_lambda;
  int dim_deathrt;
  int dim_Delta;
  int dim_eip;
  int dim_FOI1;
  int dim_FOI1nn;
  int dim_FOI1p;
  int dim_FOI1Y;
  int dim_I1;
  int dim_I1_1;
  int dim_I1_12;
  int dim_I1_2;
  int dim_I1_3;
  int dim_incubA;
  int dim_incubB;
  int dim_inf_1;
  int dim_inf_1_1;
  int dim_inf_1_12;
  int dim_inf_1_2;
  int dim_inf_1_3;
  int dim_inf_1_prob;
  int dim_inf_1_prob_1;
  int dim_inf_1_prob_12;
  int dim_inf_1_prob_2;
  int dim_inf_1_prob_3;
  int dim_infectious1;
  int dim_infectiousA;
  int dim_infectiousB;
  int dim_init_I1;
  int dim_init_I1_1;
  int dim_init_I1_12;
  int dim_init_I1_2;
  int dim_init_I1_3;
  int dim_init_R1;
  int dim_init_R1_1;
  int dim_init_R1_12;
  int dim_init_R1_2;
  int dim_init_R1_3;
  int dim_init_S;
  int dim_init_S_1;
  int dim_init_S_12;
  int dim_init_S_2;
  int dim_init_S_3;
  int dim_Kc;
  int dim_L_deathrt;
  int dim_L_dr;
  int dim_Lwt;
  int dim_Lwt_birth;
  int dim_Lwt_birth_lambda;
  int dim_Lwt_mature;
  int dim_Lwt_mature_prob;
  int dim_Mwt;
  int dim_Mwt_E1;
  int dim_Mwt_E1_incub;
  int dim_Mwt_E1_incub_prob;
  int dim_Mwt_E2;
  int dim_Mwt_E2_incub;
  int dim_Mwt_E2_incub_prob;
  int dim_Mwt_FOI1;
  int dim_Mwt_I1;
  int dim_Mwt_inf1;
  int dim_Mwt_inf1_prob;
  int dim_Mwt_S;
  int dim_Mwt_tot;
  int dim_N_eq;
  int dim_Nb;
  int dim_nn;
  int dim_nn_1;
  int dim_nn_2;
  int dim_Ntotal;
  int dim_Ntotal_1;
  int dim_Ntotal_12;
  int dim_Ntotal_2;
  int dim_Ntotal_3;
  int dim_Ntotal_sum;
  int dim_Ntotal_sum_1;
  int dim_Ntotal_sum_2;
  int dim_NTp;
  int dim_O_I1;
  int dim_O_I1_1;
  int dim_O_I1_12;
  int dim_O_I1_2;
  int dim_O_I1_3;
  int dim_O_I1_prob;
  int dim_O_Lwt;
  int dim_O_Lwt_prob;
  int dim_O_Mwt_E1;
  int dim_O_Mwt_E1_prob;
  int dim_O_Mwt_E2;
  int dim_O_Mwt_E2_prob;
  int dim_O_Mwt_I1;
  int dim_O_Mwt_I1_prob;
  int dim_O_Mwt_S;
  int dim_O_Mwt_S_prob;
  int dim_O_R1;
  int dim_O_R1_1;
  int dim_O_R1_12;
  int dim_O_R1_2;
  int dim_O_R1_3;
  int dim_O_R1_prob;
  int dim_O_S;
  int dim_O_S_1;
  int dim_O_S_12;
  int dim_O_S_2;
  int dim_O_S_3;
  int dim_O_S_prob;
  int dim_O_S_prob_1;
  int dim_O_S_prob_12;
  int dim_O_S_prob_2;
  int dim_O_S_prob_3;
  int dim_phi1;
  int dim_prop_Sp;
  int dim_R1;
  int dim_R1_1;
  int dim_R1_12;
  int dim_R1_2;
  int dim_R1_3;
  int dim_recov1;
  int dim_recov1_1;
  int dim_recov1_12;
  int dim_recov1_2;
  int dim_recov1_3;
  int dim_recov1_prob;
  int dim_rho1;
  int dim_S;
  int dim_S_1;
  int dim_S_12;
  int dim_S_2;
  int dim_S_3;
  int dim_season_amp;
  int dim_season_phase;
  int dim_sum_S;
  int dim_sum_S_1;
  int dim_sum_S_2;
  int dim_Y1;
  int dim_Y1_1;
  int dim_Y1_12;
  int dim_Y1_2;
  int dim_Y1_3;
  int dim_Y1T;
  int dim_Y1T_sum;
  int dim_Y1T_sum_1;
  int dim_Y1T_sum_2;
  double DT;
  double *eip;
  double eip_mean;
  double eip_season;
  double Epsilon;
  double *FOI1;
  double *FOI1nn;
  double *FOI1p;
  double *FOI1Y;
  double incub;
  double *inf_1;
  double *inf_1_prob;
  double inf_per;
  double *infectious1;
  double *init_I1;
  double *init_R1;
  double *init_S;
  double *initial_I1;
  double *initial_incubA;
  double *initial_incubB;
  double *initial_infectiousA;
  double *initial_infectiousB;
  double *initial_Lwt;
  double *initial_Mwt_E1;
  double *initial_Mwt_E2;
  double *initial_Mwt_I1;
  double *initial_Mwt_S;
  double *initial_R1;
  double *initial_S;
  double Kappa;
  double *Kc;
  double Kc_season;
  double *L_deathrt;
  double *L_dr;
  double *Lwt_birth;
  double *Lwt_birth_lambda;
  double *Lwt_mature;
  double *Lwt_mature_prob;
  double *Mwt;
  double *Mwt_E1_incub;
  double *Mwt_E1_incub_prob;
  double *Mwt_E2_incub;
  double *Mwt_E2_incub_prob;
  double *Mwt_FOI1;
  double *Mwt_inf1;
  double *Mwt_inf1_prob;
  double Mwt_mean;
  double *Mwt_tot;
  double *N_eq;
  int na;
  double *Nb;
  int *nn;
  int NP;
  double *Ntotal;
  double *Ntotal_sum;
  double *NTp;
  double nu;
  double *O_I1;
  double *O_I1_prob;
  double *O_Lwt;
  double *O_Lwt_prob;
  double *O_Mwt_E1;
  double *O_Mwt_E1_prob;
  double *O_Mwt_E2;
  double *O_Mwt_E2_prob;
  double *O_Mwt_I1;
  double *O_Mwt_I1_prob;
  double *O_Mwt_S;
  double *O_Mwt_S_prob;
  double *O_R1;
  double *O_R1_prob;
  double *O_S;
  double *O_S_prob;
  int offset_output_age_I1;
  int offset_output_age_R1;
  int offset_output_age_S;
  int offset_output_births;
  int offset_output_deathrt;
  int offset_output_Delta;
  int offset_output_eip;
  int offset_output_FOI1;
  int offset_output_FOI1nn;
  int offset_output_FOI1p;
  int offset_output_FOI1Y;
  int offset_output_inf_1;
  int offset_output_inf_1_prob;
  int offset_output_infectious1;
  int offset_output_Kc;
  int offset_output_Lwt_birth;
  int offset_output_Lwt_mature;
  int offset_output_Mwt_FOI1;
  int offset_output_Mwt_inf1;
  int offset_output_Mwt_tot;
  int offset_output_Ntotal;
  int offset_output_NTp;
  int offset_output_O_I1;
  int offset_output_O_Mwt_E1;
  int offset_output_O_Mwt_S;
  int offset_output_O_R1;
  int offset_output_O_S;
  int offset_output_O_S_prob;
  int offset_output_prop_Sp;
  int offset_output_recov1;
  int offset_output_rho1;
  int offset_output_Y1T;
  int offset_variable_I1;
  int offset_variable_incubA;
  int offset_variable_incubB;
  int offset_variable_infectiousA;
  int offset_variable_infectiousB;
  int offset_variable_Mwt_E1;
  int offset_variable_Mwt_E2;
  int offset_variable_Mwt_I1;
  int offset_variable_R1;
  int offset_variable_S;
  double Omega;
  double *phi1;
  double pi;
  double *prop_Sp;
  double propMwtControl;
  double propTransGlobal;
  double propTransNN;
  double *recov1;
  double *recov1_prob;
  double *rho1;
  double Rm;
  double *season_amp;
  double *season_phase;
  double Sigma;
  double *sum_S;
  double TimeMwtControlOff;
  double TimeMwtControlOn;
  int vnc_row;
  double Wb_cyto;
  double Wb_fF;
  double Wb_mat;
  double Wb_relinf1;
  double *Y1;
  double *Y1T;
  double *Y1T_sum;
  double YL;
} odin_model_stoch_internal;
odin_model_determ_internal* odin_model_determ_get_internal(SEXP internal_p, int closed_error);
static void odin_model_determ_finalise(SEXP internal_p);
SEXP odin_model_determ_create(SEXP user);
void odin_model_determ_initmod_desolve(void(* odeparms) (int *, double *));
SEXP odin_model_determ_contents(SEXP internal_p);
SEXP odin_model_determ_set_user(SEXP internal_p, SEXP user);
SEXP odin_model_determ_metadata(SEXP internal_p);
SEXP odin_model_determ_initial_conditions(SEXP internal_p, SEXP step_ptr);
void odin_model_determ_rhs(odin_model_determ_internal* internal, size_t step, double * state, double * state_next, double * output);
void odin_model_determ_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal);
SEXP odin_model_determ_rhs_r(SEXP internal_p, SEXP step, SEXP state);
odin_model_stoch_internal* odin_model_stoch_get_internal(SEXP internal_p, int closed_error);
static void odin_model_stoch_finalise(SEXP internal_p);
SEXP odin_model_stoch_create(SEXP user);
void odin_model_stoch_initmod_desolve(void(* odeparms) (int *, double *));
SEXP odin_model_stoch_contents(SEXP internal_p);
SEXP odin_model_stoch_set_user(SEXP internal_p, SEXP user);
SEXP odin_model_stoch_metadata(SEXP internal_p);
SEXP odin_model_stoch_initial_conditions(SEXP internal_p, SEXP step_ptr);
void odin_model_stoch_rhs(odin_model_stoch_internal* internal, size_t step, double * state, double * state_next, double * output);
void odin_model_stoch_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal);
SEXP odin_model_stoch_rhs_r(SEXP internal_p, SEXP step, SEXP state);
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max);
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max);
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name);
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name);
void user_check_values(SEXP value, double min, double max,
                           const char *name);
SEXP user_list_element(SEXP list, const char *name);
void odin_set_dim(SEXP target, int rank, ...);
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim);
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...);
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max);
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required);
double odin_sum1(double *x, size_t from, size_t to);
double odin_sum2(double* x, int from_i, int to_i, int from_j, int to_j, int dim_x_1);
double odin_sum3(double* x, int from_i, int to_i, int from_j, int to_j, int from_k, int to_k, int dim_x_1, int dim_x_12);
odin_model_determ_internal* odin_model_determ_get_internal(SEXP internal_p, int closed_error) {
  odin_model_determ_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (odin_model_determ_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void odin_model_determ_finalise(SEXP internal_p) {
  odin_model_determ_internal *internal = odin_model_determ_get_internal(internal_p, 0);
  if (internal_p) {
    Free(internal->age_I1);
    Free(internal->age_I1_prob);
    Free(internal->age_I1_trials);
    Free(internal->age_R1);
    Free(internal->age_R1_prob);
    Free(internal->age_S);
    Free(internal->age_S_prob);
    Free(internal->age_S_trials);
    Free(internal->agec);
    Free(internal->agert);
    Free(internal->amplitudes_phases);
    Free(internal->births);
    Free(internal->births_lambda);
    Free(internal->deathrt);
    Free(internal->Delta);
    Free(internal->Delta_wb);
    Free(internal->eip);
    Free(internal->FOI1);
    Free(internal->FOI1nn);
    Free(internal->FOI1p);
    Free(internal->FOI1Y);
    Free(internal->inf_1);
    Free(internal->inf_1_prob);
    Free(internal->infectious1);
    Free(internal->init_I1);
    Free(internal->init_R1);
    Free(internal->init_S);
    Free(internal->initial_I1);
    Free(internal->initial_incubA);
    Free(internal->initial_incubB);
    Free(internal->initial_infectiousA);
    Free(internal->initial_infectiousB);
    Free(internal->initial_Lwb);
    Free(internal->initial_Lwt);
    Free(internal->initial_Mwb_E1);
    Free(internal->initial_Mwb_E2);
    Free(internal->initial_Mwb_I1);
    Free(internal->initial_Mwb_S);
    Free(internal->initial_Mwt_E1);
    Free(internal->initial_Mwt_E2);
    Free(internal->initial_Mwt_I1);
    Free(internal->initial_Mwt_S);
    Free(internal->initial_R1);
    Free(internal->initial_S);
    Free(internal->Kc);
    Free(internal->L_deathrt);
    Free(internal->L_dr);
    Free(internal->ln_pick);
    Free(internal->Lwb_birth);
    Free(internal->Lwb_birth_lambda);
    Free(internal->Lwb_mature);
    Free(internal->Lwb_mature_prob);
    Free(internal->Lwt_birth);
    Free(internal->Lwt_birth_lambda);
    Free(internal->Lwt_mature);
    Free(internal->Lwt_mature_prob);
    Free(internal->M_propinf);
    Free(internal->M_tot);
    Free(internal->Mwb_E1_incub);
    Free(internal->Mwb_E1_incub_prob);
    Free(internal->Mwb_E2_incub);
    Free(internal->Mwb_E2_incub_prob);
    Free(internal->Mwb_FOI1);
    Free(internal->Mwb_inf1);
    Free(internal->Mwb_inf1_prob);
    Free(internal->Mwb_intro);
    Free(internal->Mwb_propinf);
    Free(internal->Mwb_tot);
    Free(internal->Mwt);
    Free(internal->Mwt_E1_incub);
    Free(internal->Mwt_E1_incub_prob);
    Free(internal->Mwt_E2_incub);
    Free(internal->Mwt_E2_incub_prob);
    Free(internal->Mwt_FOI1);
    Free(internal->Mwt_inf1);
    Free(internal->Mwt_inf1_prob);
    Free(internal->Mwt_propinf);
    Free(internal->Mwt_tot);
    Free(internal->N_eq);
    Free(internal->n_I1);
    Free(internal->n_R1);
    Free(internal->n_S);
    Free(internal->Nb);
    Free(internal->nn);
    Free(internal->Ntotal);
    Free(internal->Ntotal_sum);
    Free(internal->NTp);
    Free(internal->O_I1);
    Free(internal->O_I1_prob);
    Free(internal->O_Lwb);
    Free(internal->O_Lwb_prob);
    Free(internal->O_Lwt);
    Free(internal->O_Lwt_prob);
    Free(internal->O_Mwb_E1);
    Free(internal->O_Mwb_E1_prob);
    Free(internal->O_Mwb_E2);
    Free(internal->O_Mwb_E2_prob);
    Free(internal->O_Mwb_I1);
    Free(internal->O_Mwb_I1_prob);
    Free(internal->O_Mwb_S);
    Free(internal->O_Mwb_S_prob);
    Free(internal->O_Mwt_E1);
    Free(internal->O_Mwt_E1_prob);
    Free(internal->O_Mwt_E2);
    Free(internal->O_Mwt_E2_prob);
    Free(internal->O_Mwt_I1);
    Free(internal->O_Mwt_I1_prob);
    Free(internal->O_Mwt_S);
    Free(internal->O_Mwt_S_prob);
    Free(internal->O_R1);
    Free(internal->O_R1_prob);
    Free(internal->O_S);
    Free(internal->O_S_prob);
    Free(internal->phi1);
    Free(internal->prop_Sp);
    Free(internal->prop_wb);
    Free(internal->R0t_1);
    Free(internal->recov1);
    Free(internal->recov1_prob);
    Free(internal->rho1);
    Free(internal->season_amp);
    Free(internal->season_phases);
    Free(internal->sum_S);
    Free(internal->vacc_child_age);
    Free(internal->vacc_cu_age);
    Free(internal->vacc_noncov);
    Free(internal->vcu_noncov);
    Free(internal->Wb_introrate);
    Free(internal->Wb_introtime);
    Free(internal->Y1);
    Free(internal->Y1T);
    Free(internal->Y1T_sum);
    Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP odin_model_determ_create(SEXP user) {
  odin_model_determ_internal *internal = (odin_model_determ_internal*) Calloc(1, odin_model_determ_internal);
  internal->age_I1 = NULL;
  internal->age_I1_prob = NULL;
  internal->age_I1_trials = NULL;
  internal->age_R1 = NULL;
  internal->age_R1_prob = NULL;
  internal->age_S = NULL;
  internal->age_S_prob = NULL;
  internal->age_S_trials = NULL;
  internal->agec = NULL;
  internal->agert = NULL;
  internal->amplitudes_phases = NULL;
  internal->births = NULL;
  internal->births_lambda = NULL;
  internal->deathrt = NULL;
  internal->Delta = NULL;
  internal->Delta_wb = NULL;
  internal->eip = NULL;
  internal->FOI1 = NULL;
  internal->FOI1nn = NULL;
  internal->FOI1p = NULL;
  internal->FOI1Y = NULL;
  internal->inf_1 = NULL;
  internal->inf_1_prob = NULL;
  internal->infectious1 = NULL;
  internal->init_I1 = NULL;
  internal->init_R1 = NULL;
  internal->init_S = NULL;
  internal->initial_I1 = NULL;
  internal->initial_incubA = NULL;
  internal->initial_incubB = NULL;
  internal->initial_infectiousA = NULL;
  internal->initial_infectiousB = NULL;
  internal->initial_Lwb = NULL;
  internal->initial_Lwt = NULL;
  internal->initial_Mwb_E1 = NULL;
  internal->initial_Mwb_E2 = NULL;
  internal->initial_Mwb_I1 = NULL;
  internal->initial_Mwb_S = NULL;
  internal->initial_Mwt_E1 = NULL;
  internal->initial_Mwt_E2 = NULL;
  internal->initial_Mwt_I1 = NULL;
  internal->initial_Mwt_S = NULL;
  internal->initial_R1 = NULL;
  internal->initial_S = NULL;
  internal->Kc = NULL;
  internal->L_deathrt = NULL;
  internal->L_dr = NULL;
  internal->ln_pick = NULL;
  internal->Lwb_birth = NULL;
  internal->Lwb_birth_lambda = NULL;
  internal->Lwb_mature = NULL;
  internal->Lwb_mature_prob = NULL;
  internal->Lwt_birth = NULL;
  internal->Lwt_birth_lambda = NULL;
  internal->Lwt_mature = NULL;
  internal->Lwt_mature_prob = NULL;
  internal->M_propinf = NULL;
  internal->M_tot = NULL;
  internal->Mwb_E1_incub = NULL;
  internal->Mwb_E1_incub_prob = NULL;
  internal->Mwb_E2_incub = NULL;
  internal->Mwb_E2_incub_prob = NULL;
  internal->Mwb_FOI1 = NULL;
  internal->Mwb_inf1 = NULL;
  internal->Mwb_inf1_prob = NULL;
  internal->Mwb_intro = NULL;
  internal->Mwb_propinf = NULL;
  internal->Mwb_tot = NULL;
  internal->Mwt = NULL;
  internal->Mwt_E1_incub = NULL;
  internal->Mwt_E1_incub_prob = NULL;
  internal->Mwt_E2_incub = NULL;
  internal->Mwt_E2_incub_prob = NULL;
  internal->Mwt_FOI1 = NULL;
  internal->Mwt_inf1 = NULL;
  internal->Mwt_inf1_prob = NULL;
  internal->Mwt_propinf = NULL;
  internal->Mwt_tot = NULL;
  internal->N_eq = NULL;
  internal->n_I1 = NULL;
  internal->n_R1 = NULL;
  internal->n_S = NULL;
  internal->Nb = NULL;
  internal->nn = NULL;
  internal->Ntotal = NULL;
  internal->Ntotal_sum = NULL;
  internal->NTp = NULL;
  internal->O_I1 = NULL;
  internal->O_I1_prob = NULL;
  internal->O_Lwb = NULL;
  internal->O_Lwb_prob = NULL;
  internal->O_Lwt = NULL;
  internal->O_Lwt_prob = NULL;
  internal->O_Mwb_E1 = NULL;
  internal->O_Mwb_E1_prob = NULL;
  internal->O_Mwb_E2 = NULL;
  internal->O_Mwb_E2_prob = NULL;
  internal->O_Mwb_I1 = NULL;
  internal->O_Mwb_I1_prob = NULL;
  internal->O_Mwb_S = NULL;
  internal->O_Mwb_S_prob = NULL;
  internal->O_Mwt_E1 = NULL;
  internal->O_Mwt_E1_prob = NULL;
  internal->O_Mwt_E2 = NULL;
  internal->O_Mwt_E2_prob = NULL;
  internal->O_Mwt_I1 = NULL;
  internal->O_Mwt_I1_prob = NULL;
  internal->O_Mwt_S = NULL;
  internal->O_Mwt_S_prob = NULL;
  internal->O_R1 = NULL;
  internal->O_R1_prob = NULL;
  internal->O_S = NULL;
  internal->O_S_prob = NULL;
  internal->phi1 = NULL;
  internal->prop_Sp = NULL;
  internal->prop_wb = NULL;
  internal->R0t_1 = NULL;
  internal->recov1 = NULL;
  internal->recov1_prob = NULL;
  internal->rho1 = NULL;
  internal->season_amp = NULL;
  internal->season_phases = NULL;
  internal->sum_S = NULL;
  internal->vacc_child_age = NULL;
  internal->vacc_cu_age = NULL;
  internal->vacc_noncov = NULL;
  internal->vcu_noncov = NULL;
  internal->Wb_introrate = NULL;
  internal->Wb_introtime = NULL;
  internal->Y1 = NULL;
  internal->Y1T = NULL;
  internal->Y1T_sum = NULL;
  internal->dim_phi1 = 2;
  internal->dim_rho1 = 2;
  internal->age_per = NA_REAL;
  internal->agec = NULL;
  internal->amplitudes_phases = NULL;
  internal->Beta_hm_1 = NA_REAL;
  internal->Beta_mh_1 = NA_REAL;
  internal->BG_FOI = NA_REAL;
  internal->deathrt = NULL;
  internal->Delta_season = NA_REAL;
  internal->DeltaBase = NA_REAL;
  internal->DT = NA_REAL;
  internal->eip_mean = NA_REAL;
  internal->eip_season = NA_REAL;
  internal->Epsilon = NA_REAL;
  internal->incub = NA_REAL;
  internal->inf_per = NA_REAL;
  internal->init_I1 = NULL;
  internal->init_R1 = NULL;
  internal->init_S = NULL;
  internal->Kappa = NA_REAL;
  internal->Kc_season = NA_REAL;
  internal->Mwt_cv = NA_REAL;
  internal->Mwt_mean = NA_REAL;
  internal->N_eq = NULL;
  internal->na = NA_INTEGER;
  internal->Nb = NULL;
  internal->nn = NULL;
  internal->NP = NA_INTEGER;
  internal->nu = NA_REAL;
  internal->Omega = NA_REAL;
  internal->phi1 = NULL;
  internal->pi = NA_REAL;
  internal->propMwtControl = NA_REAL;
  internal->propTransGlobal = NA_REAL;
  internal->propTransNN = NA_REAL;
  internal->rho1 = NULL;
  internal->Rm = NA_REAL;
  internal->Sigma = NA_REAL;
  internal->TimeMwtControlOff = NA_REAL;
  internal->TimeMwtControlOn = NA_REAL;
  internal->vacc_child_age = NULL;
  internal->vacc_child_coverage = NA_REAL;
  internal->vacc_child_starttime = NA_REAL;
  internal->vacc_child_stoptime = NA_REAL;
  internal->vacc_cu_age = NULL;
  internal->vacc_cu_coverage = NA_REAL;
  internal->vacc_cu_rndtime = NA_REAL;
  internal->Wb_cyto = NA_REAL;
  internal->Wb_fF = NA_REAL;
  internal->Wb_fM = NA_REAL;
  internal->Wb_introduration = NA_REAL;
  internal->Wb_introlevel = NA_REAL;
  internal->Wb_introtime = NULL;
  internal->Wb_mat = NA_REAL;
  internal->Wb_relinf1 = NA_REAL;
  internal->Wb_relsusc1 = NA_REAL;
  internal->YL = NA_REAL;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, odin_model_determ_finalise);
  UNPROTECT(1);
  return ptr;
}
static odin_model_determ_internal *odin_model_determ_internal_ds;
void odin_model_determ_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  odin_model_determ_internal_ds = odin_model_determ_get_internal(get_desolve_gparms(), 1);
}
SEXP odin_model_determ_contents(SEXP internal_p) {
  odin_model_determ_internal *internal = odin_model_determ_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 474));
  SEXP age_I1 = PROTECT(allocVector(REALSXP, internal->dim_age_I1));
  memcpy(REAL(age_I1), internal->age_I1, internal->dim_age_I1 * sizeof(double));
  odin_set_dim(age_I1, 3, internal->dim_age_I1_1, internal->dim_age_I1_2, internal->dim_age_I1_3);
  SET_VECTOR_ELT(contents, 0, age_I1);
  SEXP age_I1_prob = PROTECT(allocVector(REALSXP, internal->dim_age_I1_prob));
  memcpy(REAL(age_I1_prob), internal->age_I1_prob, internal->dim_age_I1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 1, age_I1_prob);
  SEXP age_I1_trials = PROTECT(allocVector(REALSXP, internal->dim_age_I1_trials));
  memcpy(REAL(age_I1_trials), internal->age_I1_trials, internal->dim_age_I1_trials * sizeof(double));
  odin_set_dim(age_I1_trials, 3, internal->dim_age_I1_trials_1, internal->dim_age_I1_trials_2, internal->dim_age_I1_trials_3);
  SET_VECTOR_ELT(contents, 2, age_I1_trials);
  SET_VECTOR_ELT(contents, 3, ScalarReal(internal->age_per));
  SEXP age_R1 = PROTECT(allocVector(REALSXP, internal->dim_age_R1));
  memcpy(REAL(age_R1), internal->age_R1, internal->dim_age_R1 * sizeof(double));
  odin_set_dim(age_R1, 3, internal->dim_age_R1_1, internal->dim_age_R1_2, internal->dim_age_R1_3);
  SET_VECTOR_ELT(contents, 4, age_R1);
  SEXP age_R1_prob = PROTECT(allocVector(REALSXP, internal->dim_age_R1_prob));
  memcpy(REAL(age_R1_prob), internal->age_R1_prob, internal->dim_age_R1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 5, age_R1_prob);
  SEXP age_S = PROTECT(allocVector(REALSXP, internal->dim_age_S));
  memcpy(REAL(age_S), internal->age_S, internal->dim_age_S * sizeof(double));
  odin_set_dim(age_S, 3, internal->dim_age_S_1, internal->dim_age_S_2, internal->dim_age_S_3);
  SET_VECTOR_ELT(contents, 6, age_S);
  SEXP age_S_prob = PROTECT(allocVector(REALSXP, internal->dim_age_S_prob));
  memcpy(REAL(age_S_prob), internal->age_S_prob, internal->dim_age_S_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 7, age_S_prob);
  SEXP age_S_trials = PROTECT(allocVector(REALSXP, internal->dim_age_S_trials));
  memcpy(REAL(age_S_trials), internal->age_S_trials, internal->dim_age_S_trials * sizeof(double));
  odin_set_dim(age_S_trials, 3, internal->dim_age_S_trials_1, internal->dim_age_S_trials_2, internal->dim_age_S_trials_3);
  SET_VECTOR_ELT(contents, 8, age_S_trials);
  SEXP agec = PROTECT(allocVector(REALSXP, internal->dim_agec));
  memcpy(REAL(agec), internal->agec, internal->dim_agec * sizeof(double));
  SET_VECTOR_ELT(contents, 9, agec);
  SEXP agert = PROTECT(allocVector(REALSXP, internal->dim_agert));
  memcpy(REAL(agert), internal->agert, internal->dim_agert * sizeof(double));
  SET_VECTOR_ELT(contents, 10, agert);
  SEXP amplitudes_phases = PROTECT(allocVector(REALSXP, internal->dim_amplitudes_phases));
  memcpy(REAL(amplitudes_phases), internal->amplitudes_phases, internal->dim_amplitudes_phases * sizeof(double));
  odin_set_dim(amplitudes_phases, 2, internal->dim_amplitudes_phases_1, internal->dim_amplitudes_phases_2);
  SET_VECTOR_ELT(contents, 11, amplitudes_phases);
  SET_VECTOR_ELT(contents, 12, ScalarReal(internal->Beta_hm_1));
  SET_VECTOR_ELT(contents, 13, ScalarReal(internal->Beta_mh_1));
  SET_VECTOR_ELT(contents, 14, ScalarReal(internal->BG_FOI));
  SEXP births = PROTECT(allocVector(REALSXP, internal->dim_births));
  memcpy(REAL(births), internal->births, internal->dim_births * sizeof(double));
  SET_VECTOR_ELT(contents, 15, births);
  SEXP births_lambda = PROTECT(allocVector(REALSXP, internal->dim_births_lambda));
  memcpy(REAL(births_lambda), internal->births_lambda, internal->dim_births_lambda * sizeof(double));
  SET_VECTOR_ELT(contents, 16, births_lambda);
  SEXP deathrt = PROTECT(allocVector(REALSXP, internal->dim_deathrt));
  memcpy(REAL(deathrt), internal->deathrt, internal->dim_deathrt * sizeof(double));
  SET_VECTOR_ELT(contents, 17, deathrt);
  SEXP Delta = PROTECT(allocVector(REALSXP, internal->dim_Delta));
  memcpy(REAL(Delta), internal->Delta, internal->dim_Delta * sizeof(double));
  SET_VECTOR_ELT(contents, 18, Delta);
  SET_VECTOR_ELT(contents, 19, ScalarReal(internal->Delta_season));
  SEXP Delta_wb = PROTECT(allocVector(REALSXP, internal->dim_Delta_wb));
  memcpy(REAL(Delta_wb), internal->Delta_wb, internal->dim_Delta_wb * sizeof(double));
  SET_VECTOR_ELT(contents, 20, Delta_wb);
  SET_VECTOR_ELT(contents, 21, ScalarReal(internal->DeltaBase));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_age_I1));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_age_I1_1));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_age_I1_12));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_age_I1_2));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_age_I1_3));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_age_I1_prob));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_age_I1_trials));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_age_I1_trials_1));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_age_I1_trials_12));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_age_I1_trials_2));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_age_I1_trials_3));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_age_R1));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_age_R1_1));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_age_R1_12));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_age_R1_2));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_age_R1_3));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_age_R1_prob));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_age_S));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_age_S_1));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_age_S_12));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_age_S_2));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_age_S_3));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_age_S_prob));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_age_S_trials));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_age_S_trials_1));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_age_S_trials_12));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_age_S_trials_2));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_age_S_trials_3));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_agec));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_agert));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_amplitudes_phases));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_amplitudes_phases_1));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_amplitudes_phases_2));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_births));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_births_lambda));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_deathrt));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_Delta));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_Delta_wb));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_eip));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_FOI1));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_FOI1nn));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_FOI1p));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_FOI1Y));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_I1));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_I1_1));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_I1_12));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_I1_2));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_I1_3));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_incubA));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_incubB));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_inf_1));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_inf_1_1));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_inf_1_12));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_inf_1_2));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_inf_1_3));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_inf_1_prob));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_inf_1_prob_1));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_inf_1_prob_12));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_inf_1_prob_2));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_inf_1_prob_3));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_infectious1));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_infectiousA));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_infectiousB));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_init_I1));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_init_I1_1));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_init_I1_12));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_init_I1_2));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_init_I1_3));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_init_R1));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_init_R1_1));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_init_R1_12));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_init_R1_2));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_init_R1_3));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_init_S));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_init_S_1));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_init_S_12));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_init_S_2));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_init_S_3));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_Kc));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_L_deathrt));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_L_dr));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_ln_pick));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_Lwb));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_Lwb_birth));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_Lwb_birth_lambda));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_Lwb_mature));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_Lwb_mature_prob));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_Lwt));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_Lwt_birth));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_Lwt_birth_lambda));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_Lwt_mature));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_Lwt_mature_prob));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_M_propinf));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_M_tot));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_Mwb_E1));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_Mwb_E1_incub));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_Mwb_E1_incub_prob));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_Mwb_E2));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_Mwb_E2_incub));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_Mwb_E2_incub_prob));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_Mwb_FOI1));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_Mwb_I1));
  SET_VECTOR_ELT(contents, 124, ScalarInteger(internal->dim_Mwb_inf1));
  SET_VECTOR_ELT(contents, 125, ScalarInteger(internal->dim_Mwb_inf1_prob));
  SET_VECTOR_ELT(contents, 126, ScalarInteger(internal->dim_Mwb_intro));
  SET_VECTOR_ELT(contents, 127, ScalarInteger(internal->dim_Mwb_propinf));
  SET_VECTOR_ELT(contents, 128, ScalarInteger(internal->dim_Mwb_S));
  SET_VECTOR_ELT(contents, 129, ScalarInteger(internal->dim_Mwb_tot));
  SET_VECTOR_ELT(contents, 130, ScalarInteger(internal->dim_Mwt));
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->dim_Mwt_E1));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->dim_Mwt_E1_incub));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->dim_Mwt_E1_incub_prob));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->dim_Mwt_E2));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->dim_Mwt_E2_incub));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->dim_Mwt_E2_incub_prob));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->dim_Mwt_FOI1));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->dim_Mwt_I1));
  SET_VECTOR_ELT(contents, 139, ScalarInteger(internal->dim_Mwt_inf1));
  SET_VECTOR_ELT(contents, 140, ScalarInteger(internal->dim_Mwt_inf1_prob));
  SET_VECTOR_ELT(contents, 141, ScalarInteger(internal->dim_Mwt_propinf));
  SET_VECTOR_ELT(contents, 142, ScalarInteger(internal->dim_Mwt_S));
  SET_VECTOR_ELT(contents, 143, ScalarInteger(internal->dim_Mwt_tot));
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->dim_N_eq));
  SET_VECTOR_ELT(contents, 145, ScalarInteger(internal->dim_n_I1));
  SET_VECTOR_ELT(contents, 146, ScalarInteger(internal->dim_n_I1_1));
  SET_VECTOR_ELT(contents, 147, ScalarInteger(internal->dim_n_I1_12));
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->dim_n_I1_2));
  SET_VECTOR_ELT(contents, 149, ScalarInteger(internal->dim_n_I1_3));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->dim_n_R1));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->dim_n_R1_1));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->dim_n_R1_12));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->dim_n_R1_2));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->dim_n_R1_3));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->dim_n_S));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->dim_n_S_1));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->dim_n_S_12));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->dim_n_S_2));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->dim_n_S_3));
  SET_VECTOR_ELT(contents, 160, ScalarInteger(internal->dim_Nb));
  SET_VECTOR_ELT(contents, 161, ScalarInteger(internal->dim_nn));
  SET_VECTOR_ELT(contents, 162, ScalarInteger(internal->dim_nn_1));
  SET_VECTOR_ELT(contents, 163, ScalarInteger(internal->dim_nn_2));
  SET_VECTOR_ELT(contents, 164, ScalarInteger(internal->dim_Ntotal));
  SET_VECTOR_ELT(contents, 165, ScalarInteger(internal->dim_Ntotal_1));
  SET_VECTOR_ELT(contents, 166, ScalarInteger(internal->dim_Ntotal_12));
  SET_VECTOR_ELT(contents, 167, ScalarInteger(internal->dim_Ntotal_2));
  SET_VECTOR_ELT(contents, 168, ScalarInteger(internal->dim_Ntotal_3));
  SET_VECTOR_ELT(contents, 169, ScalarInteger(internal->dim_Ntotal_sum));
  SET_VECTOR_ELT(contents, 170, ScalarInteger(internal->dim_Ntotal_sum_1));
  SET_VECTOR_ELT(contents, 171, ScalarInteger(internal->dim_Ntotal_sum_2));
  SET_VECTOR_ELT(contents, 172, ScalarInteger(internal->dim_NTp));
  SET_VECTOR_ELT(contents, 173, ScalarInteger(internal->dim_O_I1));
  SET_VECTOR_ELT(contents, 174, ScalarInteger(internal->dim_O_I1_1));
  SET_VECTOR_ELT(contents, 175, ScalarInteger(internal->dim_O_I1_12));
  SET_VECTOR_ELT(contents, 176, ScalarInteger(internal->dim_O_I1_2));
  SET_VECTOR_ELT(contents, 177, ScalarInteger(internal->dim_O_I1_3));
  SET_VECTOR_ELT(contents, 178, ScalarInteger(internal->dim_O_I1_prob));
  SET_VECTOR_ELT(contents, 179, ScalarInteger(internal->dim_O_Lwb));
  SET_VECTOR_ELT(contents, 180, ScalarInteger(internal->dim_O_Lwb_prob));
  SET_VECTOR_ELT(contents, 181, ScalarInteger(internal->dim_O_Lwt));
  SET_VECTOR_ELT(contents, 182, ScalarInteger(internal->dim_O_Lwt_prob));
  SET_VECTOR_ELT(contents, 183, ScalarInteger(internal->dim_O_Mwb_E1));
  SET_VECTOR_ELT(contents, 184, ScalarInteger(internal->dim_O_Mwb_E1_prob));
  SET_VECTOR_ELT(contents, 185, ScalarInteger(internal->dim_O_Mwb_E2));
  SET_VECTOR_ELT(contents, 186, ScalarInteger(internal->dim_O_Mwb_E2_prob));
  SET_VECTOR_ELT(contents, 187, ScalarInteger(internal->dim_O_Mwb_I1));
  SET_VECTOR_ELT(contents, 188, ScalarInteger(internal->dim_O_Mwb_I1_prob));
  SET_VECTOR_ELT(contents, 189, ScalarInteger(internal->dim_O_Mwb_S));
  SET_VECTOR_ELT(contents, 190, ScalarInteger(internal->dim_O_Mwb_S_prob));
  SET_VECTOR_ELT(contents, 191, ScalarInteger(internal->dim_O_Mwt_E1));
  SET_VECTOR_ELT(contents, 192, ScalarInteger(internal->dim_O_Mwt_E1_prob));
  SET_VECTOR_ELT(contents, 193, ScalarInteger(internal->dim_O_Mwt_E2));
  SET_VECTOR_ELT(contents, 194, ScalarInteger(internal->dim_O_Mwt_E2_prob));
  SET_VECTOR_ELT(contents, 195, ScalarInteger(internal->dim_O_Mwt_I1));
  SET_VECTOR_ELT(contents, 196, ScalarInteger(internal->dim_O_Mwt_I1_prob));
  SET_VECTOR_ELT(contents, 197, ScalarInteger(internal->dim_O_Mwt_S));
  SET_VECTOR_ELT(contents, 198, ScalarInteger(internal->dim_O_Mwt_S_prob));
  SET_VECTOR_ELT(contents, 199, ScalarInteger(internal->dim_O_R1));
  SET_VECTOR_ELT(contents, 200, ScalarInteger(internal->dim_O_R1_1));
  SET_VECTOR_ELT(contents, 201, ScalarInteger(internal->dim_O_R1_12));
  SET_VECTOR_ELT(contents, 202, ScalarInteger(internal->dim_O_R1_2));
  SET_VECTOR_ELT(contents, 203, ScalarInteger(internal->dim_O_R1_3));
  SET_VECTOR_ELT(contents, 204, ScalarInteger(internal->dim_O_R1_prob));
  SET_VECTOR_ELT(contents, 205, ScalarInteger(internal->dim_O_S));
  SET_VECTOR_ELT(contents, 206, ScalarInteger(internal->dim_O_S_1));
  SET_VECTOR_ELT(contents, 207, ScalarInteger(internal->dim_O_S_12));
  SET_VECTOR_ELT(contents, 208, ScalarInteger(internal->dim_O_S_2));
  SET_VECTOR_ELT(contents, 209, ScalarInteger(internal->dim_O_S_3));
  SET_VECTOR_ELT(contents, 210, ScalarInteger(internal->dim_O_S_prob));
  SET_VECTOR_ELT(contents, 211, ScalarInteger(internal->dim_O_S_prob_1));
  SET_VECTOR_ELT(contents, 212, ScalarInteger(internal->dim_O_S_prob_12));
  SET_VECTOR_ELT(contents, 213, ScalarInteger(internal->dim_O_S_prob_2));
  SET_VECTOR_ELT(contents, 214, ScalarInteger(internal->dim_O_S_prob_3));
  SET_VECTOR_ELT(contents, 215, ScalarInteger(internal->dim_phi1));
  SET_VECTOR_ELT(contents, 216, ScalarInteger(internal->dim_prop_Sp));
  SET_VECTOR_ELT(contents, 217, ScalarInteger(internal->dim_prop_wb));
  SET_VECTOR_ELT(contents, 218, ScalarInteger(internal->dim_R0t_1));
  SET_VECTOR_ELT(contents, 219, ScalarInteger(internal->dim_R1));
  SET_VECTOR_ELT(contents, 220, ScalarInteger(internal->dim_R1_1));
  SET_VECTOR_ELT(contents, 221, ScalarInteger(internal->dim_R1_12));
  SET_VECTOR_ELT(contents, 222, ScalarInteger(internal->dim_R1_2));
  SET_VECTOR_ELT(contents, 223, ScalarInteger(internal->dim_R1_3));
  SET_VECTOR_ELT(contents, 224, ScalarInteger(internal->dim_recov1));
  SET_VECTOR_ELT(contents, 225, ScalarInteger(internal->dim_recov1_1));
  SET_VECTOR_ELT(contents, 226, ScalarInteger(internal->dim_recov1_12));
  SET_VECTOR_ELT(contents, 227, ScalarInteger(internal->dim_recov1_2));
  SET_VECTOR_ELT(contents, 228, ScalarInteger(internal->dim_recov1_3));
  SET_VECTOR_ELT(contents, 229, ScalarInteger(internal->dim_recov1_prob));
  SET_VECTOR_ELT(contents, 230, ScalarInteger(internal->dim_rho1));
  SET_VECTOR_ELT(contents, 231, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 232, ScalarInteger(internal->dim_S_1));
  SET_VECTOR_ELT(contents, 233, ScalarInteger(internal->dim_S_12));
  SET_VECTOR_ELT(contents, 234, ScalarInteger(internal->dim_S_2));
  SET_VECTOR_ELT(contents, 235, ScalarInteger(internal->dim_S_3));
  SET_VECTOR_ELT(contents, 236, ScalarInteger(internal->dim_season_amp));
  SET_VECTOR_ELT(contents, 237, ScalarInteger(internal->dim_season_phases));
  SET_VECTOR_ELT(contents, 238, ScalarInteger(internal->dim_sum_S));
  SET_VECTOR_ELT(contents, 239, ScalarInteger(internal->dim_sum_S_1));
  SET_VECTOR_ELT(contents, 240, ScalarInteger(internal->dim_sum_S_2));
  SET_VECTOR_ELT(contents, 241, ScalarInteger(internal->dim_vacc_child_age));
  SET_VECTOR_ELT(contents, 242, ScalarInteger(internal->dim_vacc_cu_age));
  SET_VECTOR_ELT(contents, 243, ScalarInteger(internal->dim_vacc_noncov));
  SET_VECTOR_ELT(contents, 244, ScalarInteger(internal->dim_vacc_noncov_1));
  SET_VECTOR_ELT(contents, 245, ScalarInteger(internal->dim_vacc_noncov_2));
  SET_VECTOR_ELT(contents, 246, ScalarInteger(internal->dim_vcu_noncov));
  SET_VECTOR_ELT(contents, 247, ScalarInteger(internal->dim_vcu_noncov_1));
  SET_VECTOR_ELT(contents, 248, ScalarInteger(internal->dim_vcu_noncov_2));
  SET_VECTOR_ELT(contents, 249, ScalarInteger(internal->dim_Wb_introrate));
  SET_VECTOR_ELT(contents, 250, ScalarInteger(internal->dim_Wb_introtime));
  SET_VECTOR_ELT(contents, 251, ScalarInteger(internal->dim_Y1));
  SET_VECTOR_ELT(contents, 252, ScalarInteger(internal->dim_Y1_1));
  SET_VECTOR_ELT(contents, 253, ScalarInteger(internal->dim_Y1_12));
  SET_VECTOR_ELT(contents, 254, ScalarInteger(internal->dim_Y1_2));
  SET_VECTOR_ELT(contents, 255, ScalarInteger(internal->dim_Y1_3));
  SET_VECTOR_ELT(contents, 256, ScalarInteger(internal->dim_Y1T));
  SET_VECTOR_ELT(contents, 257, ScalarInteger(internal->dim_Y1T_sum));
  SET_VECTOR_ELT(contents, 258, ScalarInteger(internal->dim_Y1T_sum_1));
  SET_VECTOR_ELT(contents, 259, ScalarInteger(internal->dim_Y1T_sum_2));
  SET_VECTOR_ELT(contents, 260, ScalarReal(internal->DT));
  SEXP eip = PROTECT(allocVector(REALSXP, internal->dim_eip));
  memcpy(REAL(eip), internal->eip, internal->dim_eip * sizeof(double));
  SET_VECTOR_ELT(contents, 261, eip);
  SET_VECTOR_ELT(contents, 262, ScalarReal(internal->eip_mean));
  SET_VECTOR_ELT(contents, 263, ScalarReal(internal->eip_season));
  SET_VECTOR_ELT(contents, 264, ScalarReal(internal->Epsilon));
  SEXP FOI1 = PROTECT(allocVector(REALSXP, internal->dim_FOI1));
  memcpy(REAL(FOI1), internal->FOI1, internal->dim_FOI1 * sizeof(double));
  SET_VECTOR_ELT(contents, 265, FOI1);
  SEXP FOI1nn = PROTECT(allocVector(REALSXP, internal->dim_FOI1nn));
  memcpy(REAL(FOI1nn), internal->FOI1nn, internal->dim_FOI1nn * sizeof(double));
  SET_VECTOR_ELT(contents, 266, FOI1nn);
  SEXP FOI1p = PROTECT(allocVector(REALSXP, internal->dim_FOI1p));
  memcpy(REAL(FOI1p), internal->FOI1p, internal->dim_FOI1p * sizeof(double));
  SET_VECTOR_ELT(contents, 267, FOI1p);
  SEXP FOI1Y = PROTECT(allocVector(REALSXP, internal->dim_FOI1Y));
  memcpy(REAL(FOI1Y), internal->FOI1Y, internal->dim_FOI1Y * sizeof(double));
  SET_VECTOR_ELT(contents, 268, FOI1Y);
  SET_VECTOR_ELT(contents, 269, ScalarReal(internal->Gamma));
  SET_VECTOR_ELT(contents, 270, ScalarReal(internal->incub));
  SEXP inf_1 = PROTECT(allocVector(REALSXP, internal->dim_inf_1));
  memcpy(REAL(inf_1), internal->inf_1, internal->dim_inf_1 * sizeof(double));
  odin_set_dim(inf_1, 3, internal->dim_inf_1_1, internal->dim_inf_1_2, internal->dim_inf_1_3);
  SET_VECTOR_ELT(contents, 271, inf_1);
  SEXP inf_1_prob = PROTECT(allocVector(REALSXP, internal->dim_inf_1_prob));
  memcpy(REAL(inf_1_prob), internal->inf_1_prob, internal->dim_inf_1_prob * sizeof(double));
  odin_set_dim(inf_1_prob, 3, internal->dim_inf_1_prob_1, internal->dim_inf_1_prob_2, internal->dim_inf_1_prob_3);
  SET_VECTOR_ELT(contents, 272, inf_1_prob);
  SET_VECTOR_ELT(contents, 273, ScalarReal(internal->inf_per));
  SEXP infectious1 = PROTECT(allocVector(REALSXP, internal->dim_infectious1));
  memcpy(REAL(infectious1), internal->infectious1, internal->dim_infectious1 * sizeof(double));
  SET_VECTOR_ELT(contents, 274, infectious1);
  SEXP init_I1 = PROTECT(allocVector(REALSXP, internal->dim_init_I1));
  memcpy(REAL(init_I1), internal->init_I1, internal->dim_init_I1 * sizeof(double));
  odin_set_dim(init_I1, 3, internal->dim_init_I1_1, internal->dim_init_I1_2, internal->dim_init_I1_3);
  SET_VECTOR_ELT(contents, 275, init_I1);
  SEXP init_R1 = PROTECT(allocVector(REALSXP, internal->dim_init_R1));
  memcpy(REAL(init_R1), internal->init_R1, internal->dim_init_R1 * sizeof(double));
  odin_set_dim(init_R1, 3, internal->dim_init_R1_1, internal->dim_init_R1_2, internal->dim_init_R1_3);
  SET_VECTOR_ELT(contents, 276, init_R1);
  SEXP init_S = PROTECT(allocVector(REALSXP, internal->dim_init_S));
  memcpy(REAL(init_S), internal->init_S, internal->dim_init_S * sizeof(double));
  odin_set_dim(init_S, 3, internal->dim_init_S_1, internal->dim_init_S_2, internal->dim_init_S_3);
  SET_VECTOR_ELT(contents, 277, init_S);
  SEXP initial_I1 = PROTECT(allocVector(REALSXP, internal->dim_I1));
  memcpy(REAL(initial_I1), internal->initial_I1, internal->dim_I1 * sizeof(double));
  odin_set_dim(initial_I1, 3, internal->dim_I1_1, internal->dim_I1_2, internal->dim_I1_3);
  SET_VECTOR_ELT(contents, 278, initial_I1);
  SEXP initial_incubA = PROTECT(allocVector(REALSXP, internal->dim_incubA));
  memcpy(REAL(initial_incubA), internal->initial_incubA, internal->dim_incubA * sizeof(double));
  SET_VECTOR_ELT(contents, 279, initial_incubA);
  SEXP initial_incubB = PROTECT(allocVector(REALSXP, internal->dim_incubB));
  memcpy(REAL(initial_incubB), internal->initial_incubB, internal->dim_incubB * sizeof(double));
  SET_VECTOR_ELT(contents, 280, initial_incubB);
  SEXP initial_infectiousA = PROTECT(allocVector(REALSXP, internal->dim_infectiousA));
  memcpy(REAL(initial_infectiousA), internal->initial_infectiousA, internal->dim_infectiousA * sizeof(double));
  SET_VECTOR_ELT(contents, 281, initial_infectiousA);
  SEXP initial_infectiousB = PROTECT(allocVector(REALSXP, internal->dim_infectiousB));
  memcpy(REAL(initial_infectiousB), internal->initial_infectiousB, internal->dim_infectiousB * sizeof(double));
  SET_VECTOR_ELT(contents, 282, initial_infectiousB);
  SEXP initial_Lwb = PROTECT(allocVector(REALSXP, internal->dim_Lwb));
  memcpy(REAL(initial_Lwb), internal->initial_Lwb, internal->dim_Lwb * sizeof(double));
  SET_VECTOR_ELT(contents, 283, initial_Lwb);
  SEXP initial_Lwt = PROTECT(allocVector(REALSXP, internal->dim_Lwt));
  memcpy(REAL(initial_Lwt), internal->initial_Lwt, internal->dim_Lwt * sizeof(double));
  SET_VECTOR_ELT(contents, 284, initial_Lwt);
  SEXP initial_Mwb_E1 = PROTECT(allocVector(REALSXP, internal->dim_Mwb_E1));
  memcpy(REAL(initial_Mwb_E1), internal->initial_Mwb_E1, internal->dim_Mwb_E1 * sizeof(double));
  SET_VECTOR_ELT(contents, 285, initial_Mwb_E1);
  SEXP initial_Mwb_E2 = PROTECT(allocVector(REALSXP, internal->dim_Mwb_E2));
  memcpy(REAL(initial_Mwb_E2), internal->initial_Mwb_E2, internal->dim_Mwb_E2 * sizeof(double));
  SET_VECTOR_ELT(contents, 286, initial_Mwb_E2);
  SEXP initial_Mwb_I1 = PROTECT(allocVector(REALSXP, internal->dim_Mwb_I1));
  memcpy(REAL(initial_Mwb_I1), internal->initial_Mwb_I1, internal->dim_Mwb_I1 * sizeof(double));
  SET_VECTOR_ELT(contents, 287, initial_Mwb_I1);
  SEXP initial_Mwb_S = PROTECT(allocVector(REALSXP, internal->dim_Mwb_S));
  memcpy(REAL(initial_Mwb_S), internal->initial_Mwb_S, internal->dim_Mwb_S * sizeof(double));
  SET_VECTOR_ELT(contents, 288, initial_Mwb_S);
  SEXP initial_Mwt_E1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E1));
  memcpy(REAL(initial_Mwt_E1), internal->initial_Mwt_E1, internal->dim_Mwt_E1 * sizeof(double));
  SET_VECTOR_ELT(contents, 289, initial_Mwt_E1);
  SEXP initial_Mwt_E2 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E2));
  memcpy(REAL(initial_Mwt_E2), internal->initial_Mwt_E2, internal->dim_Mwt_E2 * sizeof(double));
  SET_VECTOR_ELT(contents, 290, initial_Mwt_E2);
  SEXP initial_Mwt_I1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_I1));
  memcpy(REAL(initial_Mwt_I1), internal->initial_Mwt_I1, internal->dim_Mwt_I1 * sizeof(double));
  SET_VECTOR_ELT(contents, 291, initial_Mwt_I1);
  SEXP initial_Mwt_S = PROTECT(allocVector(REALSXP, internal->dim_Mwt_S));
  memcpy(REAL(initial_Mwt_S), internal->initial_Mwt_S, internal->dim_Mwt_S * sizeof(double));
  SET_VECTOR_ELT(contents, 292, initial_Mwt_S);
  SEXP initial_R1 = PROTECT(allocVector(REALSXP, internal->dim_R1));
  memcpy(REAL(initial_R1), internal->initial_R1, internal->dim_R1 * sizeof(double));
  odin_set_dim(initial_R1, 3, internal->dim_R1_1, internal->dim_R1_2, internal->dim_R1_3);
  SET_VECTOR_ELT(contents, 293, initial_R1);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  odin_set_dim(initial_S, 3, internal->dim_S_1, internal->dim_S_2, internal->dim_S_3);
  SET_VECTOR_ELT(contents, 294, initial_S);
  SET_VECTOR_ELT(contents, 295, ScalarReal(internal->Kappa));
  SEXP Kc = PROTECT(allocVector(REALSXP, internal->dim_Kc));
  memcpy(REAL(Kc), internal->Kc, internal->dim_Kc * sizeof(double));
  SET_VECTOR_ELT(contents, 296, Kc);
  SET_VECTOR_ELT(contents, 297, ScalarReal(internal->Kc_mean));
  SET_VECTOR_ELT(contents, 298, ScalarReal(internal->Kc_season));
  SEXP L_deathrt = PROTECT(allocVector(REALSXP, internal->dim_L_deathrt));
  memcpy(REAL(L_deathrt), internal->L_deathrt, internal->dim_L_deathrt * sizeof(double));
  SET_VECTOR_ELT(contents, 299, L_deathrt);
  SEXP L_dr = PROTECT(allocVector(REALSXP, internal->dim_L_dr));
  memcpy(REAL(L_dr), internal->L_dr, internal->dim_L_dr * sizeof(double));
  SET_VECTOR_ELT(contents, 300, L_dr);
  SET_VECTOR_ELT(contents, 301, ScalarReal(internal->ln_mean));
  SEXP ln_pick = PROTECT(allocVector(REALSXP, internal->dim_ln_pick));
  memcpy(REAL(ln_pick), internal->ln_pick, internal->dim_ln_pick * sizeof(double));
  SET_VECTOR_ELT(contents, 302, ln_pick);
  SET_VECTOR_ELT(contents, 303, ScalarReal(internal->ln_sd));
  SEXP Lwb_birth = PROTECT(allocVector(REALSXP, internal->dim_Lwb_birth));
  memcpy(REAL(Lwb_birth), internal->Lwb_birth, internal->dim_Lwb_birth * sizeof(double));
  SET_VECTOR_ELT(contents, 304, Lwb_birth);
  SEXP Lwb_birth_lambda = PROTECT(allocVector(REALSXP, internal->dim_Lwb_birth_lambda));
  memcpy(REAL(Lwb_birth_lambda), internal->Lwb_birth_lambda, internal->dim_Lwb_birth_lambda * sizeof(double));
  SET_VECTOR_ELT(contents, 305, Lwb_birth_lambda);
  SEXP Lwb_mature = PROTECT(allocVector(REALSXP, internal->dim_Lwb_mature));
  memcpy(REAL(Lwb_mature), internal->Lwb_mature, internal->dim_Lwb_mature * sizeof(double));
  SET_VECTOR_ELT(contents, 306, Lwb_mature);
  SEXP Lwb_mature_prob = PROTECT(allocVector(REALSXP, internal->dim_Lwb_mature_prob));
  memcpy(REAL(Lwb_mature_prob), internal->Lwb_mature_prob, internal->dim_Lwb_mature_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 307, Lwb_mature_prob);
  SEXP Lwt_birth = PROTECT(allocVector(REALSXP, internal->dim_Lwt_birth));
  memcpy(REAL(Lwt_birth), internal->Lwt_birth, internal->dim_Lwt_birth * sizeof(double));
  SET_VECTOR_ELT(contents, 308, Lwt_birth);
  SEXP Lwt_birth_lambda = PROTECT(allocVector(REALSXP, internal->dim_Lwt_birth_lambda));
  memcpy(REAL(Lwt_birth_lambda), internal->Lwt_birth_lambda, internal->dim_Lwt_birth_lambda * sizeof(double));
  SET_VECTOR_ELT(contents, 309, Lwt_birth_lambda);
  SEXP Lwt_mature = PROTECT(allocVector(REALSXP, internal->dim_Lwt_mature));
  memcpy(REAL(Lwt_mature), internal->Lwt_mature, internal->dim_Lwt_mature * sizeof(double));
  SET_VECTOR_ELT(contents, 310, Lwt_mature);
  SEXP Lwt_mature_prob = PROTECT(allocVector(REALSXP, internal->dim_Lwt_mature_prob));
  memcpy(REAL(Lwt_mature_prob), internal->Lwt_mature_prob, internal->dim_Lwt_mature_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 311, Lwt_mature_prob);
  SEXP M_propinf = PROTECT(allocVector(REALSXP, internal->dim_M_propinf));
  memcpy(REAL(M_propinf), internal->M_propinf, internal->dim_M_propinf * sizeof(double));
  SET_VECTOR_ELT(contents, 312, M_propinf);
  SEXP M_tot = PROTECT(allocVector(REALSXP, internal->dim_M_tot));
  memcpy(REAL(M_tot), internal->M_tot, internal->dim_M_tot * sizeof(double));
  SET_VECTOR_ELT(contents, 313, M_tot);
  SEXP Mwb_E1_incub = PROTECT(allocVector(REALSXP, internal->dim_Mwb_E1_incub));
  memcpy(REAL(Mwb_E1_incub), internal->Mwb_E1_incub, internal->dim_Mwb_E1_incub * sizeof(double));
  SET_VECTOR_ELT(contents, 314, Mwb_E1_incub);
  SEXP Mwb_E1_incub_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwb_E1_incub_prob));
  memcpy(REAL(Mwb_E1_incub_prob), internal->Mwb_E1_incub_prob, internal->dim_Mwb_E1_incub_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 315, Mwb_E1_incub_prob);
  SEXP Mwb_E2_incub = PROTECT(allocVector(REALSXP, internal->dim_Mwb_E2_incub));
  memcpy(REAL(Mwb_E2_incub), internal->Mwb_E2_incub, internal->dim_Mwb_E2_incub * sizeof(double));
  SET_VECTOR_ELT(contents, 316, Mwb_E2_incub);
  SEXP Mwb_E2_incub_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwb_E2_incub_prob));
  memcpy(REAL(Mwb_E2_incub_prob), internal->Mwb_E2_incub_prob, internal->dim_Mwb_E2_incub_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 317, Mwb_E2_incub_prob);
  SEXP Mwb_FOI1 = PROTECT(allocVector(REALSXP, internal->dim_Mwb_FOI1));
  memcpy(REAL(Mwb_FOI1), internal->Mwb_FOI1, internal->dim_Mwb_FOI1 * sizeof(double));
  SET_VECTOR_ELT(contents, 318, Mwb_FOI1);
  SEXP Mwb_inf1 = PROTECT(allocVector(REALSXP, internal->dim_Mwb_inf1));
  memcpy(REAL(Mwb_inf1), internal->Mwb_inf1, internal->dim_Mwb_inf1 * sizeof(double));
  SET_VECTOR_ELT(contents, 319, Mwb_inf1);
  SEXP Mwb_inf1_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwb_inf1_prob));
  memcpy(REAL(Mwb_inf1_prob), internal->Mwb_inf1_prob, internal->dim_Mwb_inf1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 320, Mwb_inf1_prob);
  SEXP Mwb_intro = PROTECT(allocVector(REALSXP, internal->dim_Mwb_intro));
  memcpy(REAL(Mwb_intro), internal->Mwb_intro, internal->dim_Mwb_intro * sizeof(double));
  SET_VECTOR_ELT(contents, 321, Mwb_intro);
  SEXP Mwb_propinf = PROTECT(allocVector(REALSXP, internal->dim_Mwb_propinf));
  memcpy(REAL(Mwb_propinf), internal->Mwb_propinf, internal->dim_Mwb_propinf * sizeof(double));
  SET_VECTOR_ELT(contents, 322, Mwb_propinf);
  SEXP Mwb_tot = PROTECT(allocVector(REALSXP, internal->dim_Mwb_tot));
  memcpy(REAL(Mwb_tot), internal->Mwb_tot, internal->dim_Mwb_tot * sizeof(double));
  SET_VECTOR_ELT(contents, 323, Mwb_tot);
  SEXP Mwt = PROTECT(allocVector(REALSXP, internal->dim_Mwt));
  memcpy(REAL(Mwt), internal->Mwt, internal->dim_Mwt * sizeof(double));
  SET_VECTOR_ELT(contents, 324, Mwt);
  SET_VECTOR_ELT(contents, 325, ScalarReal(internal->Mwt_cv));
  SEXP Mwt_E1_incub = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E1_incub));
  memcpy(REAL(Mwt_E1_incub), internal->Mwt_E1_incub, internal->dim_Mwt_E1_incub * sizeof(double));
  SET_VECTOR_ELT(contents, 326, Mwt_E1_incub);
  SEXP Mwt_E1_incub_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E1_incub_prob));
  memcpy(REAL(Mwt_E1_incub_prob), internal->Mwt_E1_incub_prob, internal->dim_Mwt_E1_incub_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 327, Mwt_E1_incub_prob);
  SEXP Mwt_E2_incub = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E2_incub));
  memcpy(REAL(Mwt_E2_incub), internal->Mwt_E2_incub, internal->dim_Mwt_E2_incub * sizeof(double));
  SET_VECTOR_ELT(contents, 328, Mwt_E2_incub);
  SEXP Mwt_E2_incub_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E2_incub_prob));
  memcpy(REAL(Mwt_E2_incub_prob), internal->Mwt_E2_incub_prob, internal->dim_Mwt_E2_incub_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 329, Mwt_E2_incub_prob);
  SEXP Mwt_FOI1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_FOI1));
  memcpy(REAL(Mwt_FOI1), internal->Mwt_FOI1, internal->dim_Mwt_FOI1 * sizeof(double));
  SET_VECTOR_ELT(contents, 330, Mwt_FOI1);
  SEXP Mwt_inf1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_inf1));
  memcpy(REAL(Mwt_inf1), internal->Mwt_inf1, internal->dim_Mwt_inf1 * sizeof(double));
  SET_VECTOR_ELT(contents, 331, Mwt_inf1);
  SEXP Mwt_inf1_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwt_inf1_prob));
  memcpy(REAL(Mwt_inf1_prob), internal->Mwt_inf1_prob, internal->dim_Mwt_inf1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 332, Mwt_inf1_prob);
  SET_VECTOR_ELT(contents, 333, ScalarReal(internal->Mwt_mean));
  SEXP Mwt_propinf = PROTECT(allocVector(REALSXP, internal->dim_Mwt_propinf));
  memcpy(REAL(Mwt_propinf), internal->Mwt_propinf, internal->dim_Mwt_propinf * sizeof(double));
  SET_VECTOR_ELT(contents, 334, Mwt_propinf);
  SEXP Mwt_tot = PROTECT(allocVector(REALSXP, internal->dim_Mwt_tot));
  memcpy(REAL(Mwt_tot), internal->Mwt_tot, internal->dim_Mwt_tot * sizeof(double));
  SET_VECTOR_ELT(contents, 335, Mwt_tot);
  SEXP N_eq = PROTECT(allocVector(REALSXP, internal->dim_N_eq));
  memcpy(REAL(N_eq), internal->N_eq, internal->dim_N_eq * sizeof(double));
  SET_VECTOR_ELT(contents, 336, N_eq);
  SEXP n_I1 = PROTECT(allocVector(REALSXP, internal->dim_n_I1));
  memcpy(REAL(n_I1), internal->n_I1, internal->dim_n_I1 * sizeof(double));
  odin_set_dim(n_I1, 3, internal->dim_n_I1_1, internal->dim_n_I1_2, internal->dim_n_I1_3);
  SET_VECTOR_ELT(contents, 337, n_I1);
  SEXP n_R1 = PROTECT(allocVector(REALSXP, internal->dim_n_R1));
  memcpy(REAL(n_R1), internal->n_R1, internal->dim_n_R1 * sizeof(double));
  odin_set_dim(n_R1, 3, internal->dim_n_R1_1, internal->dim_n_R1_2, internal->dim_n_R1_3);
  SET_VECTOR_ELT(contents, 338, n_R1);
  SEXP n_S = PROTECT(allocVector(REALSXP, internal->dim_n_S));
  memcpy(REAL(n_S), internal->n_S, internal->dim_n_S * sizeof(double));
  odin_set_dim(n_S, 3, internal->dim_n_S_1, internal->dim_n_S_2, internal->dim_n_S_3);
  SET_VECTOR_ELT(contents, 339, n_S);
  SET_VECTOR_ELT(contents, 340, ScalarInteger(internal->na));
  SEXP Nb = PROTECT(allocVector(REALSXP, internal->dim_Nb));
  memcpy(REAL(Nb), internal->Nb, internal->dim_Nb * sizeof(double));
  SET_VECTOR_ELT(contents, 341, Nb);
  SEXP nn = PROTECT(allocVector(INTSXP, internal->dim_nn));
  memcpy(INTEGER(nn), internal->nn, internal->dim_nn * sizeof(int));
  odin_set_dim(nn, 2, internal->dim_nn_1, internal->dim_nn_2);
  SET_VECTOR_ELT(contents, 342, nn);
  SET_VECTOR_ELT(contents, 343, ScalarInteger(internal->NP));
  SEXP Ntotal = PROTECT(allocVector(REALSXP, internal->dim_Ntotal));
  memcpy(REAL(Ntotal), internal->Ntotal, internal->dim_Ntotal * sizeof(double));
  odin_set_dim(Ntotal, 3, internal->dim_Ntotal_1, internal->dim_Ntotal_2, internal->dim_Ntotal_3);
  SET_VECTOR_ELT(contents, 344, Ntotal);
  SEXP Ntotal_sum = PROTECT(allocVector(REALSXP, internal->dim_Ntotal_sum));
  memcpy(REAL(Ntotal_sum), internal->Ntotal_sum, internal->dim_Ntotal_sum * sizeof(double));
  odin_set_dim(Ntotal_sum, 2, internal->dim_Ntotal_sum_1, internal->dim_Ntotal_sum_2);
  SET_VECTOR_ELT(contents, 345, Ntotal_sum);
  SEXP NTp = PROTECT(allocVector(REALSXP, internal->dim_NTp));
  memcpy(REAL(NTp), internal->NTp, internal->dim_NTp * sizeof(double));
  SET_VECTOR_ELT(contents, 346, NTp);
  SET_VECTOR_ELT(contents, 347, ScalarReal(internal->nu));
  SEXP O_I1 = PROTECT(allocVector(REALSXP, internal->dim_O_I1));
  memcpy(REAL(O_I1), internal->O_I1, internal->dim_O_I1 * sizeof(double));
  odin_set_dim(O_I1, 3, internal->dim_O_I1_1, internal->dim_O_I1_2, internal->dim_O_I1_3);
  SET_VECTOR_ELT(contents, 348, O_I1);
  SEXP O_I1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_I1_prob));
  memcpy(REAL(O_I1_prob), internal->O_I1_prob, internal->dim_O_I1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 349, O_I1_prob);
  SEXP O_Lwb = PROTECT(allocVector(REALSXP, internal->dim_O_Lwb));
  memcpy(REAL(O_Lwb), internal->O_Lwb, internal->dim_O_Lwb * sizeof(double));
  SET_VECTOR_ELT(contents, 350, O_Lwb);
  SEXP O_Lwb_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Lwb_prob));
  memcpy(REAL(O_Lwb_prob), internal->O_Lwb_prob, internal->dim_O_Lwb_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 351, O_Lwb_prob);
  SEXP O_Lwt = PROTECT(allocVector(REALSXP, internal->dim_O_Lwt));
  memcpy(REAL(O_Lwt), internal->O_Lwt, internal->dim_O_Lwt * sizeof(double));
  SET_VECTOR_ELT(contents, 352, O_Lwt);
  SEXP O_Lwt_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Lwt_prob));
  memcpy(REAL(O_Lwt_prob), internal->O_Lwt_prob, internal->dim_O_Lwt_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 353, O_Lwt_prob);
  SEXP O_Mwb_E1 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_E1));
  memcpy(REAL(O_Mwb_E1), internal->O_Mwb_E1, internal->dim_O_Mwb_E1 * sizeof(double));
  SET_VECTOR_ELT(contents, 354, O_Mwb_E1);
  SEXP O_Mwb_E1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_E1_prob));
  memcpy(REAL(O_Mwb_E1_prob), internal->O_Mwb_E1_prob, internal->dim_O_Mwb_E1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 355, O_Mwb_E1_prob);
  SEXP O_Mwb_E2 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_E2));
  memcpy(REAL(O_Mwb_E2), internal->O_Mwb_E2, internal->dim_O_Mwb_E2 * sizeof(double));
  SET_VECTOR_ELT(contents, 356, O_Mwb_E2);
  SEXP O_Mwb_E2_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_E2_prob));
  memcpy(REAL(O_Mwb_E2_prob), internal->O_Mwb_E2_prob, internal->dim_O_Mwb_E2_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 357, O_Mwb_E2_prob);
  SEXP O_Mwb_I1 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_I1));
  memcpy(REAL(O_Mwb_I1), internal->O_Mwb_I1, internal->dim_O_Mwb_I1 * sizeof(double));
  SET_VECTOR_ELT(contents, 358, O_Mwb_I1);
  SEXP O_Mwb_I1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_I1_prob));
  memcpy(REAL(O_Mwb_I1_prob), internal->O_Mwb_I1_prob, internal->dim_O_Mwb_I1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 359, O_Mwb_I1_prob);
  SEXP O_Mwb_S = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_S));
  memcpy(REAL(O_Mwb_S), internal->O_Mwb_S, internal->dim_O_Mwb_S * sizeof(double));
  SET_VECTOR_ELT(contents, 360, O_Mwb_S);
  SEXP O_Mwb_S_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwb_S_prob));
  memcpy(REAL(O_Mwb_S_prob), internal->O_Mwb_S_prob, internal->dim_O_Mwb_S_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 361, O_Mwb_S_prob);
  SEXP O_Mwt_E1 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E1));
  memcpy(REAL(O_Mwt_E1), internal->O_Mwt_E1, internal->dim_O_Mwt_E1 * sizeof(double));
  SET_VECTOR_ELT(contents, 362, O_Mwt_E1);
  SEXP O_Mwt_E1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E1_prob));
  memcpy(REAL(O_Mwt_E1_prob), internal->O_Mwt_E1_prob, internal->dim_O_Mwt_E1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 363, O_Mwt_E1_prob);
  SEXP O_Mwt_E2 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E2));
  memcpy(REAL(O_Mwt_E2), internal->O_Mwt_E2, internal->dim_O_Mwt_E2 * sizeof(double));
  SET_VECTOR_ELT(contents, 364, O_Mwt_E2);
  SEXP O_Mwt_E2_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E2_prob));
  memcpy(REAL(O_Mwt_E2_prob), internal->O_Mwt_E2_prob, internal->dim_O_Mwt_E2_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 365, O_Mwt_E2_prob);
  SEXP O_Mwt_I1 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_I1));
  memcpy(REAL(O_Mwt_I1), internal->O_Mwt_I1, internal->dim_O_Mwt_I1 * sizeof(double));
  SET_VECTOR_ELT(contents, 366, O_Mwt_I1);
  SEXP O_Mwt_I1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_I1_prob));
  memcpy(REAL(O_Mwt_I1_prob), internal->O_Mwt_I1_prob, internal->dim_O_Mwt_I1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 367, O_Mwt_I1_prob);
  SEXP O_Mwt_S = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_S));
  memcpy(REAL(O_Mwt_S), internal->O_Mwt_S, internal->dim_O_Mwt_S * sizeof(double));
  SET_VECTOR_ELT(contents, 368, O_Mwt_S);
  SEXP O_Mwt_S_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_S_prob));
  memcpy(REAL(O_Mwt_S_prob), internal->O_Mwt_S_prob, internal->dim_O_Mwt_S_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 369, O_Mwt_S_prob);
  SEXP O_R1 = PROTECT(allocVector(REALSXP, internal->dim_O_R1));
  memcpy(REAL(O_R1), internal->O_R1, internal->dim_O_R1 * sizeof(double));
  odin_set_dim(O_R1, 3, internal->dim_O_R1_1, internal->dim_O_R1_2, internal->dim_O_R1_3);
  SET_VECTOR_ELT(contents, 370, O_R1);
  SEXP O_R1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_R1_prob));
  memcpy(REAL(O_R1_prob), internal->O_R1_prob, internal->dim_O_R1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 371, O_R1_prob);
  SEXP O_S = PROTECT(allocVector(REALSXP, internal->dim_O_S));
  memcpy(REAL(O_S), internal->O_S, internal->dim_O_S * sizeof(double));
  odin_set_dim(O_S, 3, internal->dim_O_S_1, internal->dim_O_S_2, internal->dim_O_S_3);
  SET_VECTOR_ELT(contents, 372, O_S);
  SEXP O_S_prob = PROTECT(allocVector(REALSXP, internal->dim_O_S_prob));
  memcpy(REAL(O_S_prob), internal->O_S_prob, internal->dim_O_S_prob * sizeof(double));
  odin_set_dim(O_S_prob, 3, internal->dim_O_S_prob_1, internal->dim_O_S_prob_2, internal->dim_O_S_prob_3);
  SET_VECTOR_ELT(contents, 373, O_S_prob);
  SET_VECTOR_ELT(contents, 374, ScalarInteger(internal->offset_output_age_I1));
  SET_VECTOR_ELT(contents, 375, ScalarInteger(internal->offset_output_age_R1));
  SET_VECTOR_ELT(contents, 376, ScalarInteger(internal->offset_output_age_S));
  SET_VECTOR_ELT(contents, 377, ScalarInteger(internal->offset_output_births));
  SET_VECTOR_ELT(contents, 378, ScalarInteger(internal->offset_output_deathrt));
  SET_VECTOR_ELT(contents, 379, ScalarInteger(internal->offset_output_Delta));
  SET_VECTOR_ELT(contents, 380, ScalarInteger(internal->offset_output_eip));
  SET_VECTOR_ELT(contents, 381, ScalarInteger(internal->offset_output_FOI1));
  SET_VECTOR_ELT(contents, 382, ScalarInteger(internal->offset_output_FOI1nn));
  SET_VECTOR_ELT(contents, 383, ScalarInteger(internal->offset_output_FOI1p));
  SET_VECTOR_ELT(contents, 384, ScalarInteger(internal->offset_output_FOI1Y));
  SET_VECTOR_ELT(contents, 385, ScalarInteger(internal->offset_output_inf_1));
  SET_VECTOR_ELT(contents, 386, ScalarInteger(internal->offset_output_inf_1_prob));
  SET_VECTOR_ELT(contents, 387, ScalarInteger(internal->offset_output_infectious1));
  SET_VECTOR_ELT(contents, 388, ScalarInteger(internal->offset_output_Kc));
  SET_VECTOR_ELT(contents, 389, ScalarInteger(internal->offset_output_Lwb_birth));
  SET_VECTOR_ELT(contents, 390, ScalarInteger(internal->offset_output_Lwb_mature));
  SET_VECTOR_ELT(contents, 391, ScalarInteger(internal->offset_output_Lwt_birth));
  SET_VECTOR_ELT(contents, 392, ScalarInteger(internal->offset_output_Lwt_mature));
  SET_VECTOR_ELT(contents, 393, ScalarInteger(internal->offset_output_M_propinf));
  SET_VECTOR_ELT(contents, 394, ScalarInteger(internal->offset_output_Mwb_inf1));
  SET_VECTOR_ELT(contents, 395, ScalarInteger(internal->offset_output_Mwb_intro));
  SET_VECTOR_ELT(contents, 396, ScalarInteger(internal->offset_output_Mwb_propinf));
  SET_VECTOR_ELT(contents, 397, ScalarInteger(internal->offset_output_Mwb_tot));
  SET_VECTOR_ELT(contents, 398, ScalarInteger(internal->offset_output_Mwt_FOI1));
  SET_VECTOR_ELT(contents, 399, ScalarInteger(internal->offset_output_Mwt_inf1));
  SET_VECTOR_ELT(contents, 400, ScalarInteger(internal->offset_output_Mwt_propinf));
  SET_VECTOR_ELT(contents, 401, ScalarInteger(internal->offset_output_Mwt_tot));
  SET_VECTOR_ELT(contents, 402, ScalarInteger(internal->offset_output_Ntotal));
  SET_VECTOR_ELT(contents, 403, ScalarInteger(internal->offset_output_NTp));
  SET_VECTOR_ELT(contents, 404, ScalarInteger(internal->offset_output_O_I1));
  SET_VECTOR_ELT(contents, 405, ScalarInteger(internal->offset_output_O_R1));
  SET_VECTOR_ELT(contents, 406, ScalarInteger(internal->offset_output_O_S));
  SET_VECTOR_ELT(contents, 407, ScalarInteger(internal->offset_output_O_S_prob));
  SET_VECTOR_ELT(contents, 408, ScalarInteger(internal->offset_output_prop_Sp));
  SET_VECTOR_ELT(contents, 409, ScalarInteger(internal->offset_output_prop_wb));
  SET_VECTOR_ELT(contents, 410, ScalarInteger(internal->offset_output_R0t_1));
  SET_VECTOR_ELT(contents, 411, ScalarInteger(internal->offset_output_recov1));
  SET_VECTOR_ELT(contents, 412, ScalarInteger(internal->offset_output_rho1));
  SET_VECTOR_ELT(contents, 413, ScalarInteger(internal->offset_output_vacc_noncov));
  SET_VECTOR_ELT(contents, 414, ScalarInteger(internal->offset_output_Wb_introrate));
  SET_VECTOR_ELT(contents, 415, ScalarInteger(internal->offset_output_Y1T));
  SET_VECTOR_ELT(contents, 416, ScalarInteger(internal->offset_variable_I1));
  SET_VECTOR_ELT(contents, 417, ScalarInteger(internal->offset_variable_incubA));
  SET_VECTOR_ELT(contents, 418, ScalarInteger(internal->offset_variable_incubB));
  SET_VECTOR_ELT(contents, 419, ScalarInteger(internal->offset_variable_infectiousA));
  SET_VECTOR_ELT(contents, 420, ScalarInteger(internal->offset_variable_infectiousB));
  SET_VECTOR_ELT(contents, 421, ScalarInteger(internal->offset_variable_Lwb));
  SET_VECTOR_ELT(contents, 422, ScalarInteger(internal->offset_variable_Mwb_E1));
  SET_VECTOR_ELT(contents, 423, ScalarInteger(internal->offset_variable_Mwb_E2));
  SET_VECTOR_ELT(contents, 424, ScalarInteger(internal->offset_variable_Mwb_I1));
  SET_VECTOR_ELT(contents, 425, ScalarInteger(internal->offset_variable_Mwb_S));
  SET_VECTOR_ELT(contents, 426, ScalarInteger(internal->offset_variable_Mwt_E1));
  SET_VECTOR_ELT(contents, 427, ScalarInteger(internal->offset_variable_Mwt_E2));
  SET_VECTOR_ELT(contents, 428, ScalarInteger(internal->offset_variable_Mwt_I1));
  SET_VECTOR_ELT(contents, 429, ScalarInteger(internal->offset_variable_R1));
  SET_VECTOR_ELT(contents, 430, ScalarInteger(internal->offset_variable_S));
  SET_VECTOR_ELT(contents, 431, ScalarReal(internal->Omega));
  SEXP phi1 = PROTECT(allocVector(REALSXP, internal->dim_phi1));
  memcpy(REAL(phi1), internal->phi1, internal->dim_phi1 * sizeof(double));
  SET_VECTOR_ELT(contents, 432, phi1);
  SET_VECTOR_ELT(contents, 433, ScalarReal(internal->pi));
  SEXP prop_Sp = PROTECT(allocVector(REALSXP, internal->dim_prop_Sp));
  memcpy(REAL(prop_Sp), internal->prop_Sp, internal->dim_prop_Sp * sizeof(double));
  SET_VECTOR_ELT(contents, 434, prop_Sp);
  SEXP prop_wb = PROTECT(allocVector(REALSXP, internal->dim_prop_wb));
  memcpy(REAL(prop_wb), internal->prop_wb, internal->dim_prop_wb * sizeof(double));
  SET_VECTOR_ELT(contents, 435, prop_wb);
  SET_VECTOR_ELT(contents, 436, ScalarReal(internal->propMwtControl));
  SET_VECTOR_ELT(contents, 437, ScalarReal(internal->propTransGlobal));
  SET_VECTOR_ELT(contents, 438, ScalarReal(internal->propTransNN));
  SEXP R0t_1 = PROTECT(allocVector(REALSXP, internal->dim_R0t_1));
  memcpy(REAL(R0t_1), internal->R0t_1, internal->dim_R0t_1 * sizeof(double));
  SET_VECTOR_ELT(contents, 439, R0t_1);
  SEXP recov1 = PROTECT(allocVector(REALSXP, internal->dim_recov1));
  memcpy(REAL(recov1), internal->recov1, internal->dim_recov1 * sizeof(double));
  odin_set_dim(recov1, 3, internal->dim_recov1_1, internal->dim_recov1_2, internal->dim_recov1_3);
  SET_VECTOR_ELT(contents, 440, recov1);
  SEXP recov1_prob = PROTECT(allocVector(REALSXP, internal->dim_recov1_prob));
  memcpy(REAL(recov1_prob), internal->recov1_prob, internal->dim_recov1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 441, recov1_prob);
  SEXP rho1 = PROTECT(allocVector(REALSXP, internal->dim_rho1));
  memcpy(REAL(rho1), internal->rho1, internal->dim_rho1 * sizeof(double));
  SET_VECTOR_ELT(contents, 442, rho1);
  SET_VECTOR_ELT(contents, 443, ScalarReal(internal->Rm));
  SEXP season_amp = PROTECT(allocVector(REALSXP, internal->dim_season_amp));
  memcpy(REAL(season_amp), internal->season_amp, internal->dim_season_amp * sizeof(double));
  SET_VECTOR_ELT(contents, 444, season_amp);
  SEXP season_phases = PROTECT(allocVector(REALSXP, internal->dim_season_phases));
  memcpy(REAL(season_phases), internal->season_phases, internal->dim_season_phases * sizeof(double));
  SET_VECTOR_ELT(contents, 445, season_phases);
  SET_VECTOR_ELT(contents, 446, ScalarReal(internal->Sigma));
  SEXP sum_S = PROTECT(allocVector(REALSXP, internal->dim_sum_S));
  memcpy(REAL(sum_S), internal->sum_S, internal->dim_sum_S * sizeof(double));
  odin_set_dim(sum_S, 2, internal->dim_sum_S_1, internal->dim_sum_S_2);
  SET_VECTOR_ELT(contents, 447, sum_S);
  SET_VECTOR_ELT(contents, 448, ScalarReal(internal->TimeMwtControlOff));
  SET_VECTOR_ELT(contents, 449, ScalarReal(internal->TimeMwtControlOn));
  SEXP vacc_child_age = PROTECT(allocVector(REALSXP, internal->dim_vacc_child_age));
  memcpy(REAL(vacc_child_age), internal->vacc_child_age, internal->dim_vacc_child_age * sizeof(double));
  SET_VECTOR_ELT(contents, 450, vacc_child_age);
  SET_VECTOR_ELT(contents, 451, ScalarReal(internal->vacc_child_coverage));
  SET_VECTOR_ELT(contents, 452, ScalarReal(internal->vacc_child_starttime));
  SET_VECTOR_ELT(contents, 453, ScalarReal(internal->vacc_child_stoptime));
  SEXP vacc_cu_age = PROTECT(allocVector(REALSXP, internal->dim_vacc_cu_age));
  memcpy(REAL(vacc_cu_age), internal->vacc_cu_age, internal->dim_vacc_cu_age * sizeof(double));
  SET_VECTOR_ELT(contents, 454, vacc_cu_age);
  SET_VECTOR_ELT(contents, 455, ScalarReal(internal->vacc_cu_coverage));
  SET_VECTOR_ELT(contents, 456, ScalarReal(internal->vacc_cu_rndtime));
  SEXP vacc_noncov = PROTECT(allocVector(REALSXP, internal->dim_vacc_noncov));
  memcpy(REAL(vacc_noncov), internal->vacc_noncov, internal->dim_vacc_noncov * sizeof(double));
  odin_set_dim(vacc_noncov, 2, internal->dim_vacc_noncov_1, internal->dim_vacc_noncov_2);
  SET_VECTOR_ELT(contents, 457, vacc_noncov);
  SEXP vcu_noncov = PROTECT(allocVector(REALSXP, internal->dim_vcu_noncov));
  memcpy(REAL(vcu_noncov), internal->vcu_noncov, internal->dim_vcu_noncov * sizeof(double));
  odin_set_dim(vcu_noncov, 2, internal->dim_vcu_noncov_1, internal->dim_vcu_noncov_2);
  SET_VECTOR_ELT(contents, 458, vcu_noncov);
  SET_VECTOR_ELT(contents, 459, ScalarInteger(internal->vnc_row));
  SET_VECTOR_ELT(contents, 460, ScalarReal(internal->Wb_cyto));
  SET_VECTOR_ELT(contents, 461, ScalarReal(internal->Wb_fF));
  SET_VECTOR_ELT(contents, 462, ScalarReal(internal->Wb_fM));
  SET_VECTOR_ELT(contents, 463, ScalarReal(internal->Wb_introduration));
  SET_VECTOR_ELT(contents, 464, ScalarReal(internal->Wb_introlevel));
  SEXP Wb_introrate = PROTECT(allocVector(REALSXP, internal->dim_Wb_introrate));
  memcpy(REAL(Wb_introrate), internal->Wb_introrate, internal->dim_Wb_introrate * sizeof(double));
  SET_VECTOR_ELT(contents, 465, Wb_introrate);
  SEXP Wb_introtime = PROTECT(allocVector(REALSXP, internal->dim_Wb_introtime));
  memcpy(REAL(Wb_introtime), internal->Wb_introtime, internal->dim_Wb_introtime * sizeof(double));
  SET_VECTOR_ELT(contents, 466, Wb_introtime);
  SET_VECTOR_ELT(contents, 467, ScalarReal(internal->Wb_mat));
  SET_VECTOR_ELT(contents, 468, ScalarReal(internal->Wb_relinf1));
  SET_VECTOR_ELT(contents, 469, ScalarReal(internal->Wb_relsusc1));
  SEXP Y1 = PROTECT(allocVector(REALSXP, internal->dim_Y1));
  memcpy(REAL(Y1), internal->Y1, internal->dim_Y1 * sizeof(double));
  odin_set_dim(Y1, 3, internal->dim_Y1_1, internal->dim_Y1_2, internal->dim_Y1_3);
  SET_VECTOR_ELT(contents, 470, Y1);
  SEXP Y1T = PROTECT(allocVector(REALSXP, internal->dim_Y1T));
  memcpy(REAL(Y1T), internal->Y1T, internal->dim_Y1T * sizeof(double));
  SET_VECTOR_ELT(contents, 471, Y1T);
  SEXP Y1T_sum = PROTECT(allocVector(REALSXP, internal->dim_Y1T_sum));
  memcpy(REAL(Y1T_sum), internal->Y1T_sum, internal->dim_Y1T_sum * sizeof(double));
  odin_set_dim(Y1T_sum, 2, internal->dim_Y1T_sum_1, internal->dim_Y1T_sum_2);
  SET_VECTOR_ELT(contents, 472, Y1T_sum);
  SET_VECTOR_ELT(contents, 473, ScalarReal(internal->YL));
  SEXP nms = PROTECT(allocVector(STRSXP, 474));
  SET_STRING_ELT(nms, 0, mkChar("age_I1"));
  SET_STRING_ELT(nms, 1, mkChar("age_I1_prob"));
  SET_STRING_ELT(nms, 2, mkChar("age_I1_trials"));
  SET_STRING_ELT(nms, 3, mkChar("age_per"));
  SET_STRING_ELT(nms, 4, mkChar("age_R1"));
  SET_STRING_ELT(nms, 5, mkChar("age_R1_prob"));
  SET_STRING_ELT(nms, 6, mkChar("age_S"));
  SET_STRING_ELT(nms, 7, mkChar("age_S_prob"));
  SET_STRING_ELT(nms, 8, mkChar("age_S_trials"));
  SET_STRING_ELT(nms, 9, mkChar("agec"));
  SET_STRING_ELT(nms, 10, mkChar("agert"));
  SET_STRING_ELT(nms, 11, mkChar("amplitudes_phases"));
  SET_STRING_ELT(nms, 12, mkChar("Beta_hm_1"));
  SET_STRING_ELT(nms, 13, mkChar("Beta_mh_1"));
  SET_STRING_ELT(nms, 14, mkChar("BG_FOI"));
  SET_STRING_ELT(nms, 15, mkChar("births"));
  SET_STRING_ELT(nms, 16, mkChar("births_lambda"));
  SET_STRING_ELT(nms, 17, mkChar("deathrt"));
  SET_STRING_ELT(nms, 18, mkChar("Delta"));
  SET_STRING_ELT(nms, 19, mkChar("Delta_season"));
  SET_STRING_ELT(nms, 20, mkChar("Delta_wb"));
  SET_STRING_ELT(nms, 21, mkChar("DeltaBase"));
  SET_STRING_ELT(nms, 22, mkChar("dim_age_I1"));
  SET_STRING_ELT(nms, 23, mkChar("dim_age_I1_1"));
  SET_STRING_ELT(nms, 24, mkChar("dim_age_I1_12"));
  SET_STRING_ELT(nms, 25, mkChar("dim_age_I1_2"));
  SET_STRING_ELT(nms, 26, mkChar("dim_age_I1_3"));
  SET_STRING_ELT(nms, 27, mkChar("dim_age_I1_prob"));
  SET_STRING_ELT(nms, 28, mkChar("dim_age_I1_trials"));
  SET_STRING_ELT(nms, 29, mkChar("dim_age_I1_trials_1"));
  SET_STRING_ELT(nms, 30, mkChar("dim_age_I1_trials_12"));
  SET_STRING_ELT(nms, 31, mkChar("dim_age_I1_trials_2"));
  SET_STRING_ELT(nms, 32, mkChar("dim_age_I1_trials_3"));
  SET_STRING_ELT(nms, 33, mkChar("dim_age_R1"));
  SET_STRING_ELT(nms, 34, mkChar("dim_age_R1_1"));
  SET_STRING_ELT(nms, 35, mkChar("dim_age_R1_12"));
  SET_STRING_ELT(nms, 36, mkChar("dim_age_R1_2"));
  SET_STRING_ELT(nms, 37, mkChar("dim_age_R1_3"));
  SET_STRING_ELT(nms, 38, mkChar("dim_age_R1_prob"));
  SET_STRING_ELT(nms, 39, mkChar("dim_age_S"));
  SET_STRING_ELT(nms, 40, mkChar("dim_age_S_1"));
  SET_STRING_ELT(nms, 41, mkChar("dim_age_S_12"));
  SET_STRING_ELT(nms, 42, mkChar("dim_age_S_2"));
  SET_STRING_ELT(nms, 43, mkChar("dim_age_S_3"));
  SET_STRING_ELT(nms, 44, mkChar("dim_age_S_prob"));
  SET_STRING_ELT(nms, 45, mkChar("dim_age_S_trials"));
  SET_STRING_ELT(nms, 46, mkChar("dim_age_S_trials_1"));
  SET_STRING_ELT(nms, 47, mkChar("dim_age_S_trials_12"));
  SET_STRING_ELT(nms, 48, mkChar("dim_age_S_trials_2"));
  SET_STRING_ELT(nms, 49, mkChar("dim_age_S_trials_3"));
  SET_STRING_ELT(nms, 50, mkChar("dim_agec"));
  SET_STRING_ELT(nms, 51, mkChar("dim_agert"));
  SET_STRING_ELT(nms, 52, mkChar("dim_amplitudes_phases"));
  SET_STRING_ELT(nms, 53, mkChar("dim_amplitudes_phases_1"));
  SET_STRING_ELT(nms, 54, mkChar("dim_amplitudes_phases_2"));
  SET_STRING_ELT(nms, 55, mkChar("dim_births"));
  SET_STRING_ELT(nms, 56, mkChar("dim_births_lambda"));
  SET_STRING_ELT(nms, 57, mkChar("dim_deathrt"));
  SET_STRING_ELT(nms, 58, mkChar("dim_Delta"));
  SET_STRING_ELT(nms, 59, mkChar("dim_Delta_wb"));
  SET_STRING_ELT(nms, 60, mkChar("dim_eip"));
  SET_STRING_ELT(nms, 61, mkChar("dim_FOI1"));
  SET_STRING_ELT(nms, 62, mkChar("dim_FOI1nn"));
  SET_STRING_ELT(nms, 63, mkChar("dim_FOI1p"));
  SET_STRING_ELT(nms, 64, mkChar("dim_FOI1Y"));
  SET_STRING_ELT(nms, 65, mkChar("dim_I1"));
  SET_STRING_ELT(nms, 66, mkChar("dim_I1_1"));
  SET_STRING_ELT(nms, 67, mkChar("dim_I1_12"));
  SET_STRING_ELT(nms, 68, mkChar("dim_I1_2"));
  SET_STRING_ELT(nms, 69, mkChar("dim_I1_3"));
  SET_STRING_ELT(nms, 70, mkChar("dim_incubA"));
  SET_STRING_ELT(nms, 71, mkChar("dim_incubB"));
  SET_STRING_ELT(nms, 72, mkChar("dim_inf_1"));
  SET_STRING_ELT(nms, 73, mkChar("dim_inf_1_1"));
  SET_STRING_ELT(nms, 74, mkChar("dim_inf_1_12"));
  SET_STRING_ELT(nms, 75, mkChar("dim_inf_1_2"));
  SET_STRING_ELT(nms, 76, mkChar("dim_inf_1_3"));
  SET_STRING_ELT(nms, 77, mkChar("dim_inf_1_prob"));
  SET_STRING_ELT(nms, 78, mkChar("dim_inf_1_prob_1"));
  SET_STRING_ELT(nms, 79, mkChar("dim_inf_1_prob_12"));
  SET_STRING_ELT(nms, 80, mkChar("dim_inf_1_prob_2"));
  SET_STRING_ELT(nms, 81, mkChar("dim_inf_1_prob_3"));
  SET_STRING_ELT(nms, 82, mkChar("dim_infectious1"));
  SET_STRING_ELT(nms, 83, mkChar("dim_infectiousA"));
  SET_STRING_ELT(nms, 84, mkChar("dim_infectiousB"));
  SET_STRING_ELT(nms, 85, mkChar("dim_init_I1"));
  SET_STRING_ELT(nms, 86, mkChar("dim_init_I1_1"));
  SET_STRING_ELT(nms, 87, mkChar("dim_init_I1_12"));
  SET_STRING_ELT(nms, 88, mkChar("dim_init_I1_2"));
  SET_STRING_ELT(nms, 89, mkChar("dim_init_I1_3"));
  SET_STRING_ELT(nms, 90, mkChar("dim_init_R1"));
  SET_STRING_ELT(nms, 91, mkChar("dim_init_R1_1"));
  SET_STRING_ELT(nms, 92, mkChar("dim_init_R1_12"));
  SET_STRING_ELT(nms, 93, mkChar("dim_init_R1_2"));
  SET_STRING_ELT(nms, 94, mkChar("dim_init_R1_3"));
  SET_STRING_ELT(nms, 95, mkChar("dim_init_S"));
  SET_STRING_ELT(nms, 96, mkChar("dim_init_S_1"));
  SET_STRING_ELT(nms, 97, mkChar("dim_init_S_12"));
  SET_STRING_ELT(nms, 98, mkChar("dim_init_S_2"));
  SET_STRING_ELT(nms, 99, mkChar("dim_init_S_3"));
  SET_STRING_ELT(nms, 100, mkChar("dim_Kc"));
  SET_STRING_ELT(nms, 101, mkChar("dim_L_deathrt"));
  SET_STRING_ELT(nms, 102, mkChar("dim_L_dr"));
  SET_STRING_ELT(nms, 103, mkChar("dim_ln_pick"));
  SET_STRING_ELT(nms, 104, mkChar("dim_Lwb"));
  SET_STRING_ELT(nms, 105, mkChar("dim_Lwb_birth"));
  SET_STRING_ELT(nms, 106, mkChar("dim_Lwb_birth_lambda"));
  SET_STRING_ELT(nms, 107, mkChar("dim_Lwb_mature"));
  SET_STRING_ELT(nms, 108, mkChar("dim_Lwb_mature_prob"));
  SET_STRING_ELT(nms, 109, mkChar("dim_Lwt"));
  SET_STRING_ELT(nms, 110, mkChar("dim_Lwt_birth"));
  SET_STRING_ELT(nms, 111, mkChar("dim_Lwt_birth_lambda"));
  SET_STRING_ELT(nms, 112, mkChar("dim_Lwt_mature"));
  SET_STRING_ELT(nms, 113, mkChar("dim_Lwt_mature_prob"));
  SET_STRING_ELT(nms, 114, mkChar("dim_M_propinf"));
  SET_STRING_ELT(nms, 115, mkChar("dim_M_tot"));
  SET_STRING_ELT(nms, 116, mkChar("dim_Mwb_E1"));
  SET_STRING_ELT(nms, 117, mkChar("dim_Mwb_E1_incub"));
  SET_STRING_ELT(nms, 118, mkChar("dim_Mwb_E1_incub_prob"));
  SET_STRING_ELT(nms, 119, mkChar("dim_Mwb_E2"));
  SET_STRING_ELT(nms, 120, mkChar("dim_Mwb_E2_incub"));
  SET_STRING_ELT(nms, 121, mkChar("dim_Mwb_E2_incub_prob"));
  SET_STRING_ELT(nms, 122, mkChar("dim_Mwb_FOI1"));
  SET_STRING_ELT(nms, 123, mkChar("dim_Mwb_I1"));
  SET_STRING_ELT(nms, 124, mkChar("dim_Mwb_inf1"));
  SET_STRING_ELT(nms, 125, mkChar("dim_Mwb_inf1_prob"));
  SET_STRING_ELT(nms, 126, mkChar("dim_Mwb_intro"));
  SET_STRING_ELT(nms, 127, mkChar("dim_Mwb_propinf"));
  SET_STRING_ELT(nms, 128, mkChar("dim_Mwb_S"));
  SET_STRING_ELT(nms, 129, mkChar("dim_Mwb_tot"));
  SET_STRING_ELT(nms, 130, mkChar("dim_Mwt"));
  SET_STRING_ELT(nms, 131, mkChar("dim_Mwt_E1"));
  SET_STRING_ELT(nms, 132, mkChar("dim_Mwt_E1_incub"));
  SET_STRING_ELT(nms, 133, mkChar("dim_Mwt_E1_incub_prob"));
  SET_STRING_ELT(nms, 134, mkChar("dim_Mwt_E2"));
  SET_STRING_ELT(nms, 135, mkChar("dim_Mwt_E2_incub"));
  SET_STRING_ELT(nms, 136, mkChar("dim_Mwt_E2_incub_prob"));
  SET_STRING_ELT(nms, 137, mkChar("dim_Mwt_FOI1"));
  SET_STRING_ELT(nms, 138, mkChar("dim_Mwt_I1"));
  SET_STRING_ELT(nms, 139, mkChar("dim_Mwt_inf1"));
  SET_STRING_ELT(nms, 140, mkChar("dim_Mwt_inf1_prob"));
  SET_STRING_ELT(nms, 141, mkChar("dim_Mwt_propinf"));
  SET_STRING_ELT(nms, 142, mkChar("dim_Mwt_S"));
  SET_STRING_ELT(nms, 143, mkChar("dim_Mwt_tot"));
  SET_STRING_ELT(nms, 144, mkChar("dim_N_eq"));
  SET_STRING_ELT(nms, 145, mkChar("dim_n_I1"));
  SET_STRING_ELT(nms, 146, mkChar("dim_n_I1_1"));
  SET_STRING_ELT(nms, 147, mkChar("dim_n_I1_12"));
  SET_STRING_ELT(nms, 148, mkChar("dim_n_I1_2"));
  SET_STRING_ELT(nms, 149, mkChar("dim_n_I1_3"));
  SET_STRING_ELT(nms, 150, mkChar("dim_n_R1"));
  SET_STRING_ELT(nms, 151, mkChar("dim_n_R1_1"));
  SET_STRING_ELT(nms, 152, mkChar("dim_n_R1_12"));
  SET_STRING_ELT(nms, 153, mkChar("dim_n_R1_2"));
  SET_STRING_ELT(nms, 154, mkChar("dim_n_R1_3"));
  SET_STRING_ELT(nms, 155, mkChar("dim_n_S"));
  SET_STRING_ELT(nms, 156, mkChar("dim_n_S_1"));
  SET_STRING_ELT(nms, 157, mkChar("dim_n_S_12"));
  SET_STRING_ELT(nms, 158, mkChar("dim_n_S_2"));
  SET_STRING_ELT(nms, 159, mkChar("dim_n_S_3"));
  SET_STRING_ELT(nms, 160, mkChar("dim_Nb"));
  SET_STRING_ELT(nms, 161, mkChar("dim_nn"));
  SET_STRING_ELT(nms, 162, mkChar("dim_nn_1"));
  SET_STRING_ELT(nms, 163, mkChar("dim_nn_2"));
  SET_STRING_ELT(nms, 164, mkChar("dim_Ntotal"));
  SET_STRING_ELT(nms, 165, mkChar("dim_Ntotal_1"));
  SET_STRING_ELT(nms, 166, mkChar("dim_Ntotal_12"));
  SET_STRING_ELT(nms, 167, mkChar("dim_Ntotal_2"));
  SET_STRING_ELT(nms, 168, mkChar("dim_Ntotal_3"));
  SET_STRING_ELT(nms, 169, mkChar("dim_Ntotal_sum"));
  SET_STRING_ELT(nms, 170, mkChar("dim_Ntotal_sum_1"));
  SET_STRING_ELT(nms, 171, mkChar("dim_Ntotal_sum_2"));
  SET_STRING_ELT(nms, 172, mkChar("dim_NTp"));
  SET_STRING_ELT(nms, 173, mkChar("dim_O_I1"));
  SET_STRING_ELT(nms, 174, mkChar("dim_O_I1_1"));
  SET_STRING_ELT(nms, 175, mkChar("dim_O_I1_12"));
  SET_STRING_ELT(nms, 176, mkChar("dim_O_I1_2"));
  SET_STRING_ELT(nms, 177, mkChar("dim_O_I1_3"));
  SET_STRING_ELT(nms, 178, mkChar("dim_O_I1_prob"));
  SET_STRING_ELT(nms, 179, mkChar("dim_O_Lwb"));
  SET_STRING_ELT(nms, 180, mkChar("dim_O_Lwb_prob"));
  SET_STRING_ELT(nms, 181, mkChar("dim_O_Lwt"));
  SET_STRING_ELT(nms, 182, mkChar("dim_O_Lwt_prob"));
  SET_STRING_ELT(nms, 183, mkChar("dim_O_Mwb_E1"));
  SET_STRING_ELT(nms, 184, mkChar("dim_O_Mwb_E1_prob"));
  SET_STRING_ELT(nms, 185, mkChar("dim_O_Mwb_E2"));
  SET_STRING_ELT(nms, 186, mkChar("dim_O_Mwb_E2_prob"));
  SET_STRING_ELT(nms, 187, mkChar("dim_O_Mwb_I1"));
  SET_STRING_ELT(nms, 188, mkChar("dim_O_Mwb_I1_prob"));
  SET_STRING_ELT(nms, 189, mkChar("dim_O_Mwb_S"));
  SET_STRING_ELT(nms, 190, mkChar("dim_O_Mwb_S_prob"));
  SET_STRING_ELT(nms, 191, mkChar("dim_O_Mwt_E1"));
  SET_STRING_ELT(nms, 192, mkChar("dim_O_Mwt_E1_prob"));
  SET_STRING_ELT(nms, 193, mkChar("dim_O_Mwt_E2"));
  SET_STRING_ELT(nms, 194, mkChar("dim_O_Mwt_E2_prob"));
  SET_STRING_ELT(nms, 195, mkChar("dim_O_Mwt_I1"));
  SET_STRING_ELT(nms, 196, mkChar("dim_O_Mwt_I1_prob"));
  SET_STRING_ELT(nms, 197, mkChar("dim_O_Mwt_S"));
  SET_STRING_ELT(nms, 198, mkChar("dim_O_Mwt_S_prob"));
  SET_STRING_ELT(nms, 199, mkChar("dim_O_R1"));
  SET_STRING_ELT(nms, 200, mkChar("dim_O_R1_1"));
  SET_STRING_ELT(nms, 201, mkChar("dim_O_R1_12"));
  SET_STRING_ELT(nms, 202, mkChar("dim_O_R1_2"));
  SET_STRING_ELT(nms, 203, mkChar("dim_O_R1_3"));
  SET_STRING_ELT(nms, 204, mkChar("dim_O_R1_prob"));
  SET_STRING_ELT(nms, 205, mkChar("dim_O_S"));
  SET_STRING_ELT(nms, 206, mkChar("dim_O_S_1"));
  SET_STRING_ELT(nms, 207, mkChar("dim_O_S_12"));
  SET_STRING_ELT(nms, 208, mkChar("dim_O_S_2"));
  SET_STRING_ELT(nms, 209, mkChar("dim_O_S_3"));
  SET_STRING_ELT(nms, 210, mkChar("dim_O_S_prob"));
  SET_STRING_ELT(nms, 211, mkChar("dim_O_S_prob_1"));
  SET_STRING_ELT(nms, 212, mkChar("dim_O_S_prob_12"));
  SET_STRING_ELT(nms, 213, mkChar("dim_O_S_prob_2"));
  SET_STRING_ELT(nms, 214, mkChar("dim_O_S_prob_3"));
  SET_STRING_ELT(nms, 215, mkChar("dim_phi1"));
  SET_STRING_ELT(nms, 216, mkChar("dim_prop_Sp"));
  SET_STRING_ELT(nms, 217, mkChar("dim_prop_wb"));
  SET_STRING_ELT(nms, 218, mkChar("dim_R0t_1"));
  SET_STRING_ELT(nms, 219, mkChar("dim_R1"));
  SET_STRING_ELT(nms, 220, mkChar("dim_R1_1"));
  SET_STRING_ELT(nms, 221, mkChar("dim_R1_12"));
  SET_STRING_ELT(nms, 222, mkChar("dim_R1_2"));
  SET_STRING_ELT(nms, 223, mkChar("dim_R1_3"));
  SET_STRING_ELT(nms, 224, mkChar("dim_recov1"));
  SET_STRING_ELT(nms, 225, mkChar("dim_recov1_1"));
  SET_STRING_ELT(nms, 226, mkChar("dim_recov1_12"));
  SET_STRING_ELT(nms, 227, mkChar("dim_recov1_2"));
  SET_STRING_ELT(nms, 228, mkChar("dim_recov1_3"));
  SET_STRING_ELT(nms, 229, mkChar("dim_recov1_prob"));
  SET_STRING_ELT(nms, 230, mkChar("dim_rho1"));
  SET_STRING_ELT(nms, 231, mkChar("dim_S"));
  SET_STRING_ELT(nms, 232, mkChar("dim_S_1"));
  SET_STRING_ELT(nms, 233, mkChar("dim_S_12"));
  SET_STRING_ELT(nms, 234, mkChar("dim_S_2"));
  SET_STRING_ELT(nms, 235, mkChar("dim_S_3"));
  SET_STRING_ELT(nms, 236, mkChar("dim_season_amp"));
  SET_STRING_ELT(nms, 237, mkChar("dim_season_phases"));
  SET_STRING_ELT(nms, 238, mkChar("dim_sum_S"));
  SET_STRING_ELT(nms, 239, mkChar("dim_sum_S_1"));
  SET_STRING_ELT(nms, 240, mkChar("dim_sum_S_2"));
  SET_STRING_ELT(nms, 241, mkChar("dim_vacc_child_age"));
  SET_STRING_ELT(nms, 242, mkChar("dim_vacc_cu_age"));
  SET_STRING_ELT(nms, 243, mkChar("dim_vacc_noncov"));
  SET_STRING_ELT(nms, 244, mkChar("dim_vacc_noncov_1"));
  SET_STRING_ELT(nms, 245, mkChar("dim_vacc_noncov_2"));
  SET_STRING_ELT(nms, 246, mkChar("dim_vcu_noncov"));
  SET_STRING_ELT(nms, 247, mkChar("dim_vcu_noncov_1"));
  SET_STRING_ELT(nms, 248, mkChar("dim_vcu_noncov_2"));
  SET_STRING_ELT(nms, 249, mkChar("dim_Wb_introrate"));
  SET_STRING_ELT(nms, 250, mkChar("dim_Wb_introtime"));
  SET_STRING_ELT(nms, 251, mkChar("dim_Y1"));
  SET_STRING_ELT(nms, 252, mkChar("dim_Y1_1"));
  SET_STRING_ELT(nms, 253, mkChar("dim_Y1_12"));
  SET_STRING_ELT(nms, 254, mkChar("dim_Y1_2"));
  SET_STRING_ELT(nms, 255, mkChar("dim_Y1_3"));
  SET_STRING_ELT(nms, 256, mkChar("dim_Y1T"));
  SET_STRING_ELT(nms, 257, mkChar("dim_Y1T_sum"));
  SET_STRING_ELT(nms, 258, mkChar("dim_Y1T_sum_1"));
  SET_STRING_ELT(nms, 259, mkChar("dim_Y1T_sum_2"));
  SET_STRING_ELT(nms, 260, mkChar("DT"));
  SET_STRING_ELT(nms, 261, mkChar("eip"));
  SET_STRING_ELT(nms, 262, mkChar("eip_mean"));
  SET_STRING_ELT(nms, 263, mkChar("eip_season"));
  SET_STRING_ELT(nms, 264, mkChar("Epsilon"));
  SET_STRING_ELT(nms, 265, mkChar("FOI1"));
  SET_STRING_ELT(nms, 266, mkChar("FOI1nn"));
  SET_STRING_ELT(nms, 267, mkChar("FOI1p"));
  SET_STRING_ELT(nms, 268, mkChar("FOI1Y"));
  SET_STRING_ELT(nms, 269, mkChar("Gamma"));
  SET_STRING_ELT(nms, 270, mkChar("incub"));
  SET_STRING_ELT(nms, 271, mkChar("inf_1"));
  SET_STRING_ELT(nms, 272, mkChar("inf_1_prob"));
  SET_STRING_ELT(nms, 273, mkChar("inf_per"));
  SET_STRING_ELT(nms, 274, mkChar("infectious1"));
  SET_STRING_ELT(nms, 275, mkChar("init_I1"));
  SET_STRING_ELT(nms, 276, mkChar("init_R1"));
  SET_STRING_ELT(nms, 277, mkChar("init_S"));
  SET_STRING_ELT(nms, 278, mkChar("initial_I1"));
  SET_STRING_ELT(nms, 279, mkChar("initial_incubA"));
  SET_STRING_ELT(nms, 280, mkChar("initial_incubB"));
  SET_STRING_ELT(nms, 281, mkChar("initial_infectiousA"));
  SET_STRING_ELT(nms, 282, mkChar("initial_infectiousB"));
  SET_STRING_ELT(nms, 283, mkChar("initial_Lwb"));
  SET_STRING_ELT(nms, 284, mkChar("initial_Lwt"));
  SET_STRING_ELT(nms, 285, mkChar("initial_Mwb_E1"));
  SET_STRING_ELT(nms, 286, mkChar("initial_Mwb_E2"));
  SET_STRING_ELT(nms, 287, mkChar("initial_Mwb_I1"));
  SET_STRING_ELT(nms, 288, mkChar("initial_Mwb_S"));
  SET_STRING_ELT(nms, 289, mkChar("initial_Mwt_E1"));
  SET_STRING_ELT(nms, 290, mkChar("initial_Mwt_E2"));
  SET_STRING_ELT(nms, 291, mkChar("initial_Mwt_I1"));
  SET_STRING_ELT(nms, 292, mkChar("initial_Mwt_S"));
  SET_STRING_ELT(nms, 293, mkChar("initial_R1"));
  SET_STRING_ELT(nms, 294, mkChar("initial_S"));
  SET_STRING_ELT(nms, 295, mkChar("Kappa"));
  SET_STRING_ELT(nms, 296, mkChar("Kc"));
  SET_STRING_ELT(nms, 297, mkChar("Kc_mean"));
  SET_STRING_ELT(nms, 298, mkChar("Kc_season"));
  SET_STRING_ELT(nms, 299, mkChar("L_deathrt"));
  SET_STRING_ELT(nms, 300, mkChar("L_dr"));
  SET_STRING_ELT(nms, 301, mkChar("ln_mean"));
  SET_STRING_ELT(nms, 302, mkChar("ln_pick"));
  SET_STRING_ELT(nms, 303, mkChar("ln_sd"));
  SET_STRING_ELT(nms, 304, mkChar("Lwb_birth"));
  SET_STRING_ELT(nms, 305, mkChar("Lwb_birth_lambda"));
  SET_STRING_ELT(nms, 306, mkChar("Lwb_mature"));
  SET_STRING_ELT(nms, 307, mkChar("Lwb_mature_prob"));
  SET_STRING_ELT(nms, 308, mkChar("Lwt_birth"));
  SET_STRING_ELT(nms, 309, mkChar("Lwt_birth_lambda"));
  SET_STRING_ELT(nms, 310, mkChar("Lwt_mature"));
  SET_STRING_ELT(nms, 311, mkChar("Lwt_mature_prob"));
  SET_STRING_ELT(nms, 312, mkChar("M_propinf"));
  SET_STRING_ELT(nms, 313, mkChar("M_tot"));
  SET_STRING_ELT(nms, 314, mkChar("Mwb_E1_incub"));
  SET_STRING_ELT(nms, 315, mkChar("Mwb_E1_incub_prob"));
  SET_STRING_ELT(nms, 316, mkChar("Mwb_E2_incub"));
  SET_STRING_ELT(nms, 317, mkChar("Mwb_E2_incub_prob"));
  SET_STRING_ELT(nms, 318, mkChar("Mwb_FOI1"));
  SET_STRING_ELT(nms, 319, mkChar("Mwb_inf1"));
  SET_STRING_ELT(nms, 320, mkChar("Mwb_inf1_prob"));
  SET_STRING_ELT(nms, 321, mkChar("Mwb_intro"));
  SET_STRING_ELT(nms, 322, mkChar("Mwb_propinf"));
  SET_STRING_ELT(nms, 323, mkChar("Mwb_tot"));
  SET_STRING_ELT(nms, 324, mkChar("Mwt"));
  SET_STRING_ELT(nms, 325, mkChar("Mwt_cv"));
  SET_STRING_ELT(nms, 326, mkChar("Mwt_E1_incub"));
  SET_STRING_ELT(nms, 327, mkChar("Mwt_E1_incub_prob"));
  SET_STRING_ELT(nms, 328, mkChar("Mwt_E2_incub"));
  SET_STRING_ELT(nms, 329, mkChar("Mwt_E2_incub_prob"));
  SET_STRING_ELT(nms, 330, mkChar("Mwt_FOI1"));
  SET_STRING_ELT(nms, 331, mkChar("Mwt_inf1"));
  SET_STRING_ELT(nms, 332, mkChar("Mwt_inf1_prob"));
  SET_STRING_ELT(nms, 333, mkChar("Mwt_mean"));
  SET_STRING_ELT(nms, 334, mkChar("Mwt_propinf"));
  SET_STRING_ELT(nms, 335, mkChar("Mwt_tot"));
  SET_STRING_ELT(nms, 336, mkChar("N_eq"));
  SET_STRING_ELT(nms, 337, mkChar("n_I1"));
  SET_STRING_ELT(nms, 338, mkChar("n_R1"));
  SET_STRING_ELT(nms, 339, mkChar("n_S"));
  SET_STRING_ELT(nms, 340, mkChar("na"));
  SET_STRING_ELT(nms, 341, mkChar("Nb"));
  SET_STRING_ELT(nms, 342, mkChar("nn"));
  SET_STRING_ELT(nms, 343, mkChar("NP"));
  SET_STRING_ELT(nms, 344, mkChar("Ntotal"));
  SET_STRING_ELT(nms, 345, mkChar("Ntotal_sum"));
  SET_STRING_ELT(nms, 346, mkChar("NTp"));
  SET_STRING_ELT(nms, 347, mkChar("nu"));
  SET_STRING_ELT(nms, 348, mkChar("O_I1"));
  SET_STRING_ELT(nms, 349, mkChar("O_I1_prob"));
  SET_STRING_ELT(nms, 350, mkChar("O_Lwb"));
  SET_STRING_ELT(nms, 351, mkChar("O_Lwb_prob"));
  SET_STRING_ELT(nms, 352, mkChar("O_Lwt"));
  SET_STRING_ELT(nms, 353, mkChar("O_Lwt_prob"));
  SET_STRING_ELT(nms, 354, mkChar("O_Mwb_E1"));
  SET_STRING_ELT(nms, 355, mkChar("O_Mwb_E1_prob"));
  SET_STRING_ELT(nms, 356, mkChar("O_Mwb_E2"));
  SET_STRING_ELT(nms, 357, mkChar("O_Mwb_E2_prob"));
  SET_STRING_ELT(nms, 358, mkChar("O_Mwb_I1"));
  SET_STRING_ELT(nms, 359, mkChar("O_Mwb_I1_prob"));
  SET_STRING_ELT(nms, 360, mkChar("O_Mwb_S"));
  SET_STRING_ELT(nms, 361, mkChar("O_Mwb_S_prob"));
  SET_STRING_ELT(nms, 362, mkChar("O_Mwt_E1"));
  SET_STRING_ELT(nms, 363, mkChar("O_Mwt_E1_prob"));
  SET_STRING_ELT(nms, 364, mkChar("O_Mwt_E2"));
  SET_STRING_ELT(nms, 365, mkChar("O_Mwt_E2_prob"));
  SET_STRING_ELT(nms, 366, mkChar("O_Mwt_I1"));
  SET_STRING_ELT(nms, 367, mkChar("O_Mwt_I1_prob"));
  SET_STRING_ELT(nms, 368, mkChar("O_Mwt_S"));
  SET_STRING_ELT(nms, 369, mkChar("O_Mwt_S_prob"));
  SET_STRING_ELT(nms, 370, mkChar("O_R1"));
  SET_STRING_ELT(nms, 371, mkChar("O_R1_prob"));
  SET_STRING_ELT(nms, 372, mkChar("O_S"));
  SET_STRING_ELT(nms, 373, mkChar("O_S_prob"));
  SET_STRING_ELT(nms, 374, mkChar("offset_output_age_I1"));
  SET_STRING_ELT(nms, 375, mkChar("offset_output_age_R1"));
  SET_STRING_ELT(nms, 376, mkChar("offset_output_age_S"));
  SET_STRING_ELT(nms, 377, mkChar("offset_output_births"));
  SET_STRING_ELT(nms, 378, mkChar("offset_output_deathrt"));
  SET_STRING_ELT(nms, 379, mkChar("offset_output_Delta"));
  SET_STRING_ELT(nms, 380, mkChar("offset_output_eip"));
  SET_STRING_ELT(nms, 381, mkChar("offset_output_FOI1"));
  SET_STRING_ELT(nms, 382, mkChar("offset_output_FOI1nn"));
  SET_STRING_ELT(nms, 383, mkChar("offset_output_FOI1p"));
  SET_STRING_ELT(nms, 384, mkChar("offset_output_FOI1Y"));
  SET_STRING_ELT(nms, 385, mkChar("offset_output_inf_1"));
  SET_STRING_ELT(nms, 386, mkChar("offset_output_inf_1_prob"));
  SET_STRING_ELT(nms, 387, mkChar("offset_output_infectious1"));
  SET_STRING_ELT(nms, 388, mkChar("offset_output_Kc"));
  SET_STRING_ELT(nms, 389, mkChar("offset_output_Lwb_birth"));
  SET_STRING_ELT(nms, 390, mkChar("offset_output_Lwb_mature"));
  SET_STRING_ELT(nms, 391, mkChar("offset_output_Lwt_birth"));
  SET_STRING_ELT(nms, 392, mkChar("offset_output_Lwt_mature"));
  SET_STRING_ELT(nms, 393, mkChar("offset_output_M_propinf"));
  SET_STRING_ELT(nms, 394, mkChar("offset_output_Mwb_inf1"));
  SET_STRING_ELT(nms, 395, mkChar("offset_output_Mwb_intro"));
  SET_STRING_ELT(nms, 396, mkChar("offset_output_Mwb_propinf"));
  SET_STRING_ELT(nms, 397, mkChar("offset_output_Mwb_tot"));
  SET_STRING_ELT(nms, 398, mkChar("offset_output_Mwt_FOI1"));
  SET_STRING_ELT(nms, 399, mkChar("offset_output_Mwt_inf1"));
  SET_STRING_ELT(nms, 400, mkChar("offset_output_Mwt_propinf"));
  SET_STRING_ELT(nms, 401, mkChar("offset_output_Mwt_tot"));
  SET_STRING_ELT(nms, 402, mkChar("offset_output_Ntotal"));
  SET_STRING_ELT(nms, 403, mkChar("offset_output_NTp"));
  SET_STRING_ELT(nms, 404, mkChar("offset_output_O_I1"));
  SET_STRING_ELT(nms, 405, mkChar("offset_output_O_R1"));
  SET_STRING_ELT(nms, 406, mkChar("offset_output_O_S"));
  SET_STRING_ELT(nms, 407, mkChar("offset_output_O_S_prob"));
  SET_STRING_ELT(nms, 408, mkChar("offset_output_prop_Sp"));
  SET_STRING_ELT(nms, 409, mkChar("offset_output_prop_wb"));
  SET_STRING_ELT(nms, 410, mkChar("offset_output_R0t_1"));
  SET_STRING_ELT(nms, 411, mkChar("offset_output_recov1"));
  SET_STRING_ELT(nms, 412, mkChar("offset_output_rho1"));
  SET_STRING_ELT(nms, 413, mkChar("offset_output_vacc_noncov"));
  SET_STRING_ELT(nms, 414, mkChar("offset_output_Wb_introrate"));
  SET_STRING_ELT(nms, 415, mkChar("offset_output_Y1T"));
  SET_STRING_ELT(nms, 416, mkChar("offset_variable_I1"));
  SET_STRING_ELT(nms, 417, mkChar("offset_variable_incubA"));
  SET_STRING_ELT(nms, 418, mkChar("offset_variable_incubB"));
  SET_STRING_ELT(nms, 419, mkChar("offset_variable_infectiousA"));
  SET_STRING_ELT(nms, 420, mkChar("offset_variable_infectiousB"));
  SET_STRING_ELT(nms, 421, mkChar("offset_variable_Lwb"));
  SET_STRING_ELT(nms, 422, mkChar("offset_variable_Mwb_E1"));
  SET_STRING_ELT(nms, 423, mkChar("offset_variable_Mwb_E2"));
  SET_STRING_ELT(nms, 424, mkChar("offset_variable_Mwb_I1"));
  SET_STRING_ELT(nms, 425, mkChar("offset_variable_Mwb_S"));
  SET_STRING_ELT(nms, 426, mkChar("offset_variable_Mwt_E1"));
  SET_STRING_ELT(nms, 427, mkChar("offset_variable_Mwt_E2"));
  SET_STRING_ELT(nms, 428, mkChar("offset_variable_Mwt_I1"));
  SET_STRING_ELT(nms, 429, mkChar("offset_variable_R1"));
  SET_STRING_ELT(nms, 430, mkChar("offset_variable_S"));
  SET_STRING_ELT(nms, 431, mkChar("Omega"));
  SET_STRING_ELT(nms, 432, mkChar("phi1"));
  SET_STRING_ELT(nms, 433, mkChar("pi"));
  SET_STRING_ELT(nms, 434, mkChar("prop_Sp"));
  SET_STRING_ELT(nms, 435, mkChar("prop_wb"));
  SET_STRING_ELT(nms, 436, mkChar("propMwtControl"));
  SET_STRING_ELT(nms, 437, mkChar("propTransGlobal"));
  SET_STRING_ELT(nms, 438, mkChar("propTransNN"));
  SET_STRING_ELT(nms, 439, mkChar("R0t_1"));
  SET_STRING_ELT(nms, 440, mkChar("recov1"));
  SET_STRING_ELT(nms, 441, mkChar("recov1_prob"));
  SET_STRING_ELT(nms, 442, mkChar("rho1"));
  SET_STRING_ELT(nms, 443, mkChar("Rm"));
  SET_STRING_ELT(nms, 444, mkChar("season_amp"));
  SET_STRING_ELT(nms, 445, mkChar("season_phases"));
  SET_STRING_ELT(nms, 446, mkChar("Sigma"));
  SET_STRING_ELT(nms, 447, mkChar("sum_S"));
  SET_STRING_ELT(nms, 448, mkChar("TimeMwtControlOff"));
  SET_STRING_ELT(nms, 449, mkChar("TimeMwtControlOn"));
  SET_STRING_ELT(nms, 450, mkChar("vacc_child_age"));
  SET_STRING_ELT(nms, 451, mkChar("vacc_child_coverage"));
  SET_STRING_ELT(nms, 452, mkChar("vacc_child_starttime"));
  SET_STRING_ELT(nms, 453, mkChar("vacc_child_stoptime"));
  SET_STRING_ELT(nms, 454, mkChar("vacc_cu_age"));
  SET_STRING_ELT(nms, 455, mkChar("vacc_cu_coverage"));
  SET_STRING_ELT(nms, 456, mkChar("vacc_cu_rndtime"));
  SET_STRING_ELT(nms, 457, mkChar("vacc_noncov"));
  SET_STRING_ELT(nms, 458, mkChar("vcu_noncov"));
  SET_STRING_ELT(nms, 459, mkChar("vnc_row"));
  SET_STRING_ELT(nms, 460, mkChar("Wb_cyto"));
  SET_STRING_ELT(nms, 461, mkChar("Wb_fF"));
  SET_STRING_ELT(nms, 462, mkChar("Wb_fM"));
  SET_STRING_ELT(nms, 463, mkChar("Wb_introduration"));
  SET_STRING_ELT(nms, 464, mkChar("Wb_introlevel"));
  SET_STRING_ELT(nms, 465, mkChar("Wb_introrate"));
  SET_STRING_ELT(nms, 466, mkChar("Wb_introtime"));
  SET_STRING_ELT(nms, 467, mkChar("Wb_mat"));
  SET_STRING_ELT(nms, 468, mkChar("Wb_relinf1"));
  SET_STRING_ELT(nms, 469, mkChar("Wb_relsusc1"));
  SET_STRING_ELT(nms, 470, mkChar("Y1"));
  SET_STRING_ELT(nms, 471, mkChar("Y1T"));
  SET_STRING_ELT(nms, 472, mkChar("Y1T_sum"));
  SET_STRING_ELT(nms, 473, mkChar("YL"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(134);
  return contents;
}
SEXP odin_model_determ_set_user(SEXP internal_p, SEXP user) {
  odin_model_determ_internal *internal = odin_model_determ_get_internal(internal_p, 1);
  internal->age_per = user_get_scalar_double(user, "age_per", internal->age_per, NA_REAL, NA_REAL);
  internal->Beta_hm_1 = user_get_scalar_double(user, "Beta_hm_1", internal->Beta_hm_1, NA_REAL, NA_REAL);
  internal->Beta_mh_1 = user_get_scalar_double(user, "Beta_mh_1", internal->Beta_mh_1, NA_REAL, NA_REAL);
  internal->BG_FOI = user_get_scalar_double(user, "BG_FOI", internal->BG_FOI, NA_REAL, NA_REAL);
  internal->Delta_season = user_get_scalar_double(user, "Delta_season", internal->Delta_season, NA_REAL, NA_REAL);
  internal->DeltaBase = user_get_scalar_double(user, "DeltaBase", internal->DeltaBase, NA_REAL, NA_REAL);
  internal->DT = user_get_scalar_double(user, "DT", internal->DT, NA_REAL, NA_REAL);
  internal->eip_mean = user_get_scalar_double(user, "eip_mean", internal->eip_mean, NA_REAL, NA_REAL);
  internal->eip_season = user_get_scalar_double(user, "eip_season", internal->eip_season, NA_REAL, NA_REAL);
  internal->Epsilon = user_get_scalar_double(user, "Epsilon", internal->Epsilon, NA_REAL, NA_REAL);
  internal->incub = user_get_scalar_double(user, "incub", internal->incub, NA_REAL, NA_REAL);
  internal->inf_per = user_get_scalar_double(user, "inf_per", internal->inf_per, NA_REAL, NA_REAL);
  internal->Kappa = user_get_scalar_double(user, "Kappa", internal->Kappa, NA_REAL, NA_REAL);
  internal->Kc_season = user_get_scalar_double(user, "Kc_season", internal->Kc_season, NA_REAL, NA_REAL);
  internal->Mwt_cv = user_get_scalar_double(user, "Mwt_cv", internal->Mwt_cv, NA_REAL, NA_REAL);
  internal->Mwt_mean = user_get_scalar_double(user, "Mwt_mean", internal->Mwt_mean, NA_REAL, NA_REAL);
  internal->na = user_get_scalar_int(user, "na", internal->na, NA_REAL, NA_REAL);
  internal->NP = user_get_scalar_int(user, "NP", internal->NP, NA_REAL, NA_REAL);
  internal->nu = user_get_scalar_double(user, "nu", internal->nu, NA_REAL, NA_REAL);
  internal->Omega = user_get_scalar_double(user, "Omega", internal->Omega, NA_REAL, NA_REAL);
  internal->pi = user_get_scalar_double(user, "pi", internal->pi, NA_REAL, NA_REAL);
  internal->propMwtControl = user_get_scalar_double(user, "propMwtControl", internal->propMwtControl, NA_REAL, NA_REAL);
  internal->propTransGlobal = user_get_scalar_double(user, "propTransGlobal", internal->propTransGlobal, NA_REAL, NA_REAL);
  internal->propTransNN = user_get_scalar_double(user, "propTransNN", internal->propTransNN, NA_REAL, NA_REAL);
  internal->Rm = user_get_scalar_double(user, "Rm", internal->Rm, NA_REAL, NA_REAL);
  internal->Sigma = user_get_scalar_double(user, "Sigma", internal->Sigma, NA_REAL, NA_REAL);
  internal->TimeMwtControlOff = user_get_scalar_double(user, "TimeMwtControlOff", internal->TimeMwtControlOff, NA_REAL, NA_REAL);
  internal->TimeMwtControlOn = user_get_scalar_double(user, "TimeMwtControlOn", internal->TimeMwtControlOn, NA_REAL, NA_REAL);
  internal->vacc_child_coverage = user_get_scalar_double(user, "vacc_child_coverage", internal->vacc_child_coverage, NA_REAL, NA_REAL);
  internal->vacc_child_starttime = user_get_scalar_double(user, "vacc_child_starttime", internal->vacc_child_starttime, NA_REAL, NA_REAL);
  internal->vacc_child_stoptime = user_get_scalar_double(user, "vacc_child_stoptime", internal->vacc_child_stoptime, NA_REAL, NA_REAL);
  internal->vacc_cu_coverage = user_get_scalar_double(user, "vacc_cu_coverage", internal->vacc_cu_coverage, NA_REAL, NA_REAL);
  internal->vacc_cu_rndtime = user_get_scalar_double(user, "vacc_cu_rndtime", internal->vacc_cu_rndtime, NA_REAL, NA_REAL);
  internal->Wb_cyto = user_get_scalar_double(user, "Wb_cyto", internal->Wb_cyto, NA_REAL, NA_REAL);
  internal->Wb_fF = user_get_scalar_double(user, "Wb_fF", internal->Wb_fF, NA_REAL, NA_REAL);
  internal->Wb_fM = user_get_scalar_double(user, "Wb_fM", internal->Wb_fM, NA_REAL, NA_REAL);
  internal->Wb_introduration = user_get_scalar_double(user, "Wb_introduration", internal->Wb_introduration, NA_REAL, NA_REAL);
  internal->Wb_introlevel = user_get_scalar_double(user, "Wb_introlevel", internal->Wb_introlevel, NA_REAL, NA_REAL);
  internal->Wb_mat = user_get_scalar_double(user, "Wb_mat", internal->Wb_mat, NA_REAL, NA_REAL);
  internal->Wb_relinf1 = user_get_scalar_double(user, "Wb_relinf1", internal->Wb_relinf1, NA_REAL, NA_REAL);
  internal->Wb_relsusc1 = user_get_scalar_double(user, "Wb_relsusc1", internal->Wb_relsusc1, NA_REAL, NA_REAL);
  internal->YL = user_get_scalar_double(user, "YL", internal->YL, NA_REAL, NA_REAL);
  internal->dim_age_I1_prob = internal->na;
  internal->dim_age_I1_trials_1 = internal->na;
  internal->dim_age_I1_trials_2 = 2;
  internal->dim_age_I1_trials_3 = internal->NP;
  internal->dim_age_R1_prob = internal->na;
  internal->dim_age_S_1 = internal->na;
  internal->dim_age_S_2 = 2;
  internal->dim_age_S_3 = internal->NP;
  internal->dim_age_S_prob = internal->na;
  internal->dim_age_S_trials_1 = internal->na;
  internal->dim_age_S_trials_2 = 2;
  internal->dim_age_S_trials_3 = internal->NP;
  internal->dim_agec = internal->na;
  internal->dim_agert = internal->na;
  internal->dim_amplitudes_phases_1 = internal->NP;
  internal->dim_amplitudes_phases_2 = 3;
  internal->dim_births = internal->NP;
  internal->dim_births_lambda = internal->NP;
  internal->dim_deathrt = internal->na;
  internal->dim_Delta = internal->NP;
  internal->dim_Delta_wb = internal->NP;
  internal->dim_eip = internal->NP;
  internal->dim_FOI1 = internal->NP;
  internal->dim_FOI1nn = internal->NP;
  internal->dim_FOI1p = internal->NP;
  internal->dim_FOI1Y = internal->NP;
  internal->dim_I1_1 = internal->na;
  internal->dim_I1_2 = 2;
  internal->dim_I1_3 = internal->NP;
  internal->dim_incubA = internal->NP;
  internal->dim_incubB = internal->NP;
  internal->dim_inf_1_1 = internal->na;
  internal->dim_inf_1_2 = 2;
  internal->dim_inf_1_3 = internal->NP;
  internal->dim_inf_1_prob_1 = internal->na;
  internal->dim_inf_1_prob_2 = 2;
  internal->dim_inf_1_prob_3 = internal->NP;
  internal->dim_infectious1 = internal->NP;
  internal->dim_infectiousA = internal->NP;
  internal->dim_infectiousB = internal->NP;
  internal->dim_init_I1_1 = internal->na;
  internal->dim_init_I1_2 = 2;
  internal->dim_init_I1_3 = internal->NP;
  internal->dim_init_R1_1 = internal->na;
  internal->dim_init_R1_2 = 2;
  internal->dim_init_R1_3 = internal->NP;
  internal->dim_init_S_1 = internal->na;
  internal->dim_init_S_2 = 2;
  internal->dim_init_S_3 = internal->NP;
  internal->dim_Kc = internal->NP;
  internal->dim_L_deathrt = internal->NP;
  internal->dim_L_dr = internal->NP;
  internal->dim_ln_pick = internal->NP;
  internal->dim_Lwb = internal->NP;
  internal->dim_Lwb_birth = internal->NP;
  internal->dim_Lwb_birth_lambda = internal->NP;
  internal->dim_Lwb_mature = internal->NP;
  internal->dim_Lwb_mature_prob = internal->NP;
  internal->dim_Lwt = internal->NP;
  internal->dim_Lwt_birth = internal->NP;
  internal->dim_Lwt_birth_lambda = internal->NP;
  internal->dim_Lwt_mature = internal->NP;
  internal->dim_Lwt_mature_prob = internal->NP;
  internal->dim_M_propinf = internal->NP;
  internal->dim_M_tot = internal->NP;
  internal->dim_Mwb_E1 = internal->NP;
  internal->dim_Mwb_E1_incub = internal->NP;
  internal->dim_Mwb_E1_incub_prob = internal->NP;
  internal->dim_Mwb_E2 = internal->NP;
  internal->dim_Mwb_E2_incub = internal->NP;
  internal->dim_Mwb_E2_incub_prob = internal->NP;
  internal->dim_Mwb_FOI1 = internal->NP;
  internal->dim_Mwb_I1 = internal->NP;
  internal->dim_Mwb_inf1 = internal->NP;
  internal->dim_Mwb_inf1_prob = internal->NP;
  internal->dim_Mwb_intro = internal->NP;
  internal->dim_Mwb_propinf = internal->NP;
  internal->dim_Mwb_S = internal->NP;
  internal->dim_Mwb_tot = internal->NP;
  internal->dim_Mwt = internal->NP;
  internal->dim_Mwt_E1 = internal->NP;
  internal->dim_Mwt_E1_incub = internal->NP;
  internal->dim_Mwt_E1_incub_prob = internal->NP;
  internal->dim_Mwt_E2 = internal->NP;
  internal->dim_Mwt_E2_incub = internal->NP;
  internal->dim_Mwt_E2_incub_prob = internal->NP;
  internal->dim_Mwt_FOI1 = internal->NP;
  internal->dim_Mwt_I1 = internal->NP;
  internal->dim_Mwt_inf1 = internal->NP;
  internal->dim_Mwt_inf1_prob = internal->NP;
  internal->dim_Mwt_propinf = internal->NP;
  internal->dim_Mwt_S = internal->NP;
  internal->dim_Mwt_tot = internal->NP;
  internal->dim_N_eq = internal->NP;
  internal->dim_n_I1_1 = internal->na;
  internal->dim_n_I1_2 = 2;
  internal->dim_n_I1_3 = internal->NP;
  internal->dim_n_R1_1 = internal->na;
  internal->dim_n_R1_2 = 2;
  internal->dim_n_R1_3 = internal->NP;
  internal->dim_n_S_1 = internal->na;
  internal->dim_n_S_2 = 2;
  internal->dim_n_S_3 = internal->NP;
  internal->dim_Nb = internal->NP;
  internal->dim_nn_1 = internal->NP;
  internal->dim_nn_2 = 8;
  internal->dim_Ntotal_1 = internal->na;
  internal->dim_Ntotal_2 = 2;
  internal->dim_Ntotal_3 = internal->NP;
  internal->dim_Ntotal_sum_1 = internal->na;
  internal->dim_Ntotal_sum_2 = internal->NP;
  internal->dim_NTp = internal->NP;
  internal->dim_O_I1_1 = internal->na;
  internal->dim_O_I1_2 = 2;
  internal->dim_O_I1_3 = internal->NP;
  internal->dim_O_I1_prob = internal->na;
  internal->dim_O_Lwb = internal->NP;
  internal->dim_O_Lwb_prob = internal->NP;
  internal->dim_O_Lwt = internal->NP;
  internal->dim_O_Lwt_prob = internal->NP;
  internal->dim_O_Mwb_E1 = internal->NP;
  internal->dim_O_Mwb_E1_prob = internal->NP;
  internal->dim_O_Mwb_E2 = internal->NP;
  internal->dim_O_Mwb_E2_prob = internal->NP;
  internal->dim_O_Mwb_I1 = internal->NP;
  internal->dim_O_Mwb_I1_prob = internal->NP;
  internal->dim_O_Mwb_S = internal->NP;
  internal->dim_O_Mwb_S_prob = internal->NP;
  internal->dim_O_Mwt_E1 = internal->NP;
  internal->dim_O_Mwt_E1_prob = internal->NP;
  internal->dim_O_Mwt_E2 = internal->NP;
  internal->dim_O_Mwt_E2_prob = internal->NP;
  internal->dim_O_Mwt_I1 = internal->NP;
  internal->dim_O_Mwt_I1_prob = internal->NP;
  internal->dim_O_Mwt_S = internal->NP;
  internal->dim_O_Mwt_S_prob = internal->NP;
  internal->dim_O_R1_1 = internal->na;
  internal->dim_O_R1_2 = 2;
  internal->dim_O_R1_3 = internal->NP;
  internal->dim_O_R1_prob = internal->na;
  internal->dim_O_S_1 = internal->na;
  internal->dim_O_S_2 = 2;
  internal->dim_O_S_3 = internal->NP;
  internal->dim_O_S_prob_1 = internal->na;
  internal->dim_O_S_prob_2 = 2;
  internal->dim_O_S_prob_3 = internal->NP;
  internal->dim_prop_Sp = internal->NP;
  internal->dim_prop_wb = internal->NP;
  internal->dim_R0t_1 = internal->NP;
  internal->dim_R1_1 = internal->na;
  internal->dim_R1_2 = 2;
  internal->dim_R1_3 = internal->NP;
  internal->dim_recov1_1 = internal->na;
  internal->dim_recov1_2 = 2;
  internal->dim_recov1_3 = internal->NP;
  internal->dim_recov1_prob = internal->na;
  internal->dim_S_1 = internal->na;
  internal->dim_S_2 = 2;
  internal->dim_S_3 = internal->NP;
  internal->dim_season_amp = internal->NP;
  internal->dim_season_phases = internal->NP;
  internal->dim_sum_S_1 = internal->na;
  internal->dim_sum_S_2 = internal->NP;
  internal->dim_Wb_introrate = internal->NP;
  internal->dim_Wb_introtime = internal->NP;
  internal->dim_Y1_1 = internal->na;
  internal->dim_Y1_2 = 2;
  internal->dim_Y1_3 = internal->NP;
  internal->dim_Y1T = internal->NP;
  internal->dim_Y1T_sum_1 = internal->na;
  internal->dim_Y1T_sum_2 = internal->NP;
  internal->Gamma = internal->Rm * internal->DeltaBase * (internal->Epsilon + internal->Sigma) / (double) internal->Epsilon;
  internal->ln_sd = sqrt(log(1 + internal->Mwt_cv * internal->Mwt_cv));
  internal->phi1 = (double*) user_get_array(user, false, internal->phi1, "phi1", NA_REAL, NA_REAL, 1, internal->dim_phi1);
  internal->rho1 = (double*) user_get_array(user, false, internal->rho1, "rho1", NA_REAL, NA_REAL, 1, internal->dim_rho1);
  internal->vnc_row = internal->na + 1;
  internal->agec = (double*) user_get_array(user, false, internal->agec, "agec", NA_REAL, NA_REAL, 1, internal->dim_agec);
  Free(internal->age_I1_prob);
  internal->age_I1_prob = (double*) Calloc(internal->dim_age_I1_prob, double);
  Free(internal->age_R1_prob);
  internal->age_R1_prob = (double*) Calloc(internal->dim_age_R1_prob, double);
  Free(internal->age_S_prob);
  internal->age_S_prob = (double*) Calloc(internal->dim_age_S_prob, double);
  Free(internal->agert);
  internal->agert = (double*) Calloc(internal->dim_agert, double);
  Free(internal->births);
  internal->births = (double*) Calloc(internal->dim_births, double);
  Free(internal->births_lambda);
  internal->births_lambda = (double*) Calloc(internal->dim_births_lambda, double);
  Free(internal->Delta);
  internal->Delta = (double*) Calloc(internal->dim_Delta, double);
  Free(internal->Delta_wb);
  internal->Delta_wb = (double*) Calloc(internal->dim_Delta_wb, double);
  Free(internal->eip);
  internal->eip = (double*) Calloc(internal->dim_eip, double);
  Free(internal->FOI1);
  internal->FOI1 = (double*) Calloc(internal->dim_FOI1, double);
  Free(internal->FOI1nn);
  internal->FOI1nn = (double*) Calloc(internal->dim_FOI1nn, double);
  Free(internal->FOI1p);
  internal->FOI1p = (double*) Calloc(internal->dim_FOI1p, double);
  Free(internal->FOI1Y);
  internal->FOI1Y = (double*) Calloc(internal->dim_FOI1Y, double);
  Free(internal->infectious1);
  internal->infectious1 = (double*) Calloc(internal->dim_infectious1, double);
  Free(internal->initial_incubA);
  internal->initial_incubA = (double*) Calloc(internal->dim_incubA, double);
  Free(internal->initial_incubB);
  internal->initial_incubB = (double*) Calloc(internal->dim_incubB, double);
  Free(internal->initial_infectiousA);
  internal->initial_infectiousA = (double*) Calloc(internal->dim_infectiousA, double);
  Free(internal->initial_infectiousB);
  internal->initial_infectiousB = (double*) Calloc(internal->dim_infectiousB, double);
  Free(internal->initial_Lwb);
  internal->initial_Lwb = (double*) Calloc(internal->dim_Lwb, double);
  Free(internal->initial_Lwt);
  internal->initial_Lwt = (double*) Calloc(internal->dim_Lwt, double);
  Free(internal->initial_Mwb_E1);
  internal->initial_Mwb_E1 = (double*) Calloc(internal->dim_Mwb_E1, double);
  Free(internal->initial_Mwb_E2);
  internal->initial_Mwb_E2 = (double*) Calloc(internal->dim_Mwb_E2, double);
  Free(internal->initial_Mwb_I1);
  internal->initial_Mwb_I1 = (double*) Calloc(internal->dim_Mwb_I1, double);
  Free(internal->initial_Mwb_S);
  internal->initial_Mwb_S = (double*) Calloc(internal->dim_Mwb_S, double);
  Free(internal->initial_Mwt_E1);
  internal->initial_Mwt_E1 = (double*) Calloc(internal->dim_Mwt_E1, double);
  Free(internal->initial_Mwt_E2);
  internal->initial_Mwt_E2 = (double*) Calloc(internal->dim_Mwt_E2, double);
  Free(internal->initial_Mwt_I1);
  internal->initial_Mwt_I1 = (double*) Calloc(internal->dim_Mwt_I1, double);
  Free(internal->initial_Mwt_S);
  internal->initial_Mwt_S = (double*) Calloc(internal->dim_Mwt_S, double);
  Free(internal->Kc);
  internal->Kc = (double*) Calloc(internal->dim_Kc, double);
  Free(internal->L_deathrt);
  internal->L_deathrt = (double*) Calloc(internal->dim_L_deathrt, double);
  Free(internal->L_dr);
  internal->L_dr = (double*) Calloc(internal->dim_L_dr, double);
  Free(internal->ln_pick);
  internal->ln_pick = (double*) Calloc(internal->dim_ln_pick, double);
  Free(internal->Lwb_birth);
  internal->Lwb_birth = (double*) Calloc(internal->dim_Lwb_birth, double);
  Free(internal->Lwb_birth_lambda);
  internal->Lwb_birth_lambda = (double*) Calloc(internal->dim_Lwb_birth_lambda, double);
  Free(internal->Lwb_mature);
  internal->Lwb_mature = (double*) Calloc(internal->dim_Lwb_mature, double);
  Free(internal->Lwb_mature_prob);
  internal->Lwb_mature_prob = (double*) Calloc(internal->dim_Lwb_mature_prob, double);
  Free(internal->Lwt_birth);
  internal->Lwt_birth = (double*) Calloc(internal->dim_Lwt_birth, double);
  Free(internal->Lwt_birth_lambda);
  internal->Lwt_birth_lambda = (double*) Calloc(internal->dim_Lwt_birth_lambda, double);
  Free(internal->Lwt_mature);
  internal->Lwt_mature = (double*) Calloc(internal->dim_Lwt_mature, double);
  Free(internal->Lwt_mature_prob);
  internal->Lwt_mature_prob = (double*) Calloc(internal->dim_Lwt_mature_prob, double);
  Free(internal->M_propinf);
  internal->M_propinf = (double*) Calloc(internal->dim_M_propinf, double);
  Free(internal->M_tot);
  internal->M_tot = (double*) Calloc(internal->dim_M_tot, double);
  Free(internal->Mwb_E1_incub);
  internal->Mwb_E1_incub = (double*) Calloc(internal->dim_Mwb_E1_incub, double);
  Free(internal->Mwb_E1_incub_prob);
  internal->Mwb_E1_incub_prob = (double*) Calloc(internal->dim_Mwb_E1_incub_prob, double);
  Free(internal->Mwb_E2_incub);
  internal->Mwb_E2_incub = (double*) Calloc(internal->dim_Mwb_E2_incub, double);
  Free(internal->Mwb_E2_incub_prob);
  internal->Mwb_E2_incub_prob = (double*) Calloc(internal->dim_Mwb_E2_incub_prob, double);
  Free(internal->Mwb_FOI1);
  internal->Mwb_FOI1 = (double*) Calloc(internal->dim_Mwb_FOI1, double);
  Free(internal->Mwb_inf1);
  internal->Mwb_inf1 = (double*) Calloc(internal->dim_Mwb_inf1, double);
  Free(internal->Mwb_inf1_prob);
  internal->Mwb_inf1_prob = (double*) Calloc(internal->dim_Mwb_inf1_prob, double);
  Free(internal->Mwb_intro);
  internal->Mwb_intro = (double*) Calloc(internal->dim_Mwb_intro, double);
  Free(internal->Mwb_propinf);
  internal->Mwb_propinf = (double*) Calloc(internal->dim_Mwb_propinf, double);
  Free(internal->Mwb_tot);
  internal->Mwb_tot = (double*) Calloc(internal->dim_Mwb_tot, double);
  Free(internal->Mwt);
  internal->Mwt = (double*) Calloc(internal->dim_Mwt, double);
  Free(internal->Mwt_E1_incub);
  internal->Mwt_E1_incub = (double*) Calloc(internal->dim_Mwt_E1_incub, double);
  Free(internal->Mwt_E1_incub_prob);
  internal->Mwt_E1_incub_prob = (double*) Calloc(internal->dim_Mwt_E1_incub_prob, double);
  Free(internal->Mwt_E2_incub);
  internal->Mwt_E2_incub = (double*) Calloc(internal->dim_Mwt_E2_incub, double);
  Free(internal->Mwt_E2_incub_prob);
  internal->Mwt_E2_incub_prob = (double*) Calloc(internal->dim_Mwt_E2_incub_prob, double);
  Free(internal->Mwt_FOI1);
  internal->Mwt_FOI1 = (double*) Calloc(internal->dim_Mwt_FOI1, double);
  Free(internal->Mwt_inf1);
  internal->Mwt_inf1 = (double*) Calloc(internal->dim_Mwt_inf1, double);
  Free(internal->Mwt_inf1_prob);
  internal->Mwt_inf1_prob = (double*) Calloc(internal->dim_Mwt_inf1_prob, double);
  Free(internal->Mwt_propinf);
  internal->Mwt_propinf = (double*) Calloc(internal->dim_Mwt_propinf, double);
  Free(internal->Mwt_tot);
  internal->Mwt_tot = (double*) Calloc(internal->dim_Mwt_tot, double);
  Free(internal->NTp);
  internal->NTp = (double*) Calloc(internal->dim_NTp, double);
  Free(internal->O_I1_prob);
  internal->O_I1_prob = (double*) Calloc(internal->dim_O_I1_prob, double);
  Free(internal->O_Lwb);
  internal->O_Lwb = (double*) Calloc(internal->dim_O_Lwb, double);
  Free(internal->O_Lwb_prob);
  internal->O_Lwb_prob = (double*) Calloc(internal->dim_O_Lwb_prob, double);
  Free(internal->O_Lwt);
  internal->O_Lwt = (double*) Calloc(internal->dim_O_Lwt, double);
  Free(internal->O_Lwt_prob);
  internal->O_Lwt_prob = (double*) Calloc(internal->dim_O_Lwt_prob, double);
  Free(internal->O_Mwb_E1);
  internal->O_Mwb_E1 = (double*) Calloc(internal->dim_O_Mwb_E1, double);
  Free(internal->O_Mwb_E1_prob);
  internal->O_Mwb_E1_prob = (double*) Calloc(internal->dim_O_Mwb_E1_prob, double);
  Free(internal->O_Mwb_E2);
  internal->O_Mwb_E2 = (double*) Calloc(internal->dim_O_Mwb_E2, double);
  Free(internal->O_Mwb_E2_prob);
  internal->O_Mwb_E2_prob = (double*) Calloc(internal->dim_O_Mwb_E2_prob, double);
  Free(internal->O_Mwb_I1);
  internal->O_Mwb_I1 = (double*) Calloc(internal->dim_O_Mwb_I1, double);
  Free(internal->O_Mwb_I1_prob);
  internal->O_Mwb_I1_prob = (double*) Calloc(internal->dim_O_Mwb_I1_prob, double);
  Free(internal->O_Mwb_S);
  internal->O_Mwb_S = (double*) Calloc(internal->dim_O_Mwb_S, double);
  Free(internal->O_Mwb_S_prob);
  internal->O_Mwb_S_prob = (double*) Calloc(internal->dim_O_Mwb_S_prob, double);
  Free(internal->O_Mwt_E1);
  internal->O_Mwt_E1 = (double*) Calloc(internal->dim_O_Mwt_E1, double);
  Free(internal->O_Mwt_E1_prob);
  internal->O_Mwt_E1_prob = (double*) Calloc(internal->dim_O_Mwt_E1_prob, double);
  Free(internal->O_Mwt_E2);
  internal->O_Mwt_E2 = (double*) Calloc(internal->dim_O_Mwt_E2, double);
  Free(internal->O_Mwt_E2_prob);
  internal->O_Mwt_E2_prob = (double*) Calloc(internal->dim_O_Mwt_E2_prob, double);
  Free(internal->O_Mwt_I1);
  internal->O_Mwt_I1 = (double*) Calloc(internal->dim_O_Mwt_I1, double);
  Free(internal->O_Mwt_I1_prob);
  internal->O_Mwt_I1_prob = (double*) Calloc(internal->dim_O_Mwt_I1_prob, double);
  Free(internal->O_Mwt_S);
  internal->O_Mwt_S = (double*) Calloc(internal->dim_O_Mwt_S, double);
  Free(internal->O_Mwt_S_prob);
  internal->O_Mwt_S_prob = (double*) Calloc(internal->dim_O_Mwt_S_prob, double);
  Free(internal->O_R1_prob);
  internal->O_R1_prob = (double*) Calloc(internal->dim_O_R1_prob, double);
  Free(internal->prop_Sp);
  internal->prop_Sp = (double*) Calloc(internal->dim_prop_Sp, double);
  Free(internal->prop_wb);
  internal->prop_wb = (double*) Calloc(internal->dim_prop_wb, double);
  Free(internal->R0t_1);
  internal->R0t_1 = (double*) Calloc(internal->dim_R0t_1, double);
  Free(internal->recov1_prob);
  internal->recov1_prob = (double*) Calloc(internal->dim_recov1_prob, double);
  Free(internal->season_amp);
  internal->season_amp = (double*) Calloc(internal->dim_season_amp, double);
  Free(internal->season_phases);
  internal->season_phases = (double*) Calloc(internal->dim_season_phases, double);
  Free(internal->Wb_introrate);
  internal->Wb_introrate = (double*) Calloc(internal->dim_Wb_introrate, double);
  Free(internal->Y1T);
  internal->Y1T = (double*) Calloc(internal->dim_Y1T, double);
  internal->deathrt = (double*) user_get_array(user, false, internal->deathrt, "deathrt", NA_REAL, NA_REAL, 1, internal->dim_deathrt);
  internal->dim_age_I1_1 = internal->vnc_row;
  internal->dim_age_I1_2 = 2;
  internal->dim_age_I1_3 = internal->NP;
  internal->dim_age_I1_trials = internal->dim_age_I1_trials_1 * internal->dim_age_I1_trials_2 * internal->dim_age_I1_trials_3;
  internal->dim_age_I1_trials_12 = internal->dim_age_I1_trials_1 * internal->dim_age_I1_trials_2;
  internal->dim_age_R1_1 = internal->vnc_row;
  internal->dim_age_R1_2 = 2;
  internal->dim_age_R1_3 = internal->NP;
  internal->dim_age_S = internal->dim_age_S_1 * internal->dim_age_S_2 * internal->dim_age_S_3;
  internal->dim_age_S_12 = internal->dim_age_S_1 * internal->dim_age_S_2;
  internal->dim_age_S_trials = internal->dim_age_S_trials_1 * internal->dim_age_S_trials_2 * internal->dim_age_S_trials_3;
  internal->dim_age_S_trials_12 = internal->dim_age_S_trials_1 * internal->dim_age_S_trials_2;
  internal->dim_amplitudes_phases = internal->dim_amplitudes_phases_1 * internal->dim_amplitudes_phases_2;
  internal->dim_I1 = internal->dim_I1_1 * internal->dim_I1_2 * internal->dim_I1_3;
  internal->dim_I1_12 = internal->dim_I1_1 * internal->dim_I1_2;
  internal->dim_inf_1 = internal->dim_inf_1_1 * internal->dim_inf_1_2 * internal->dim_inf_1_3;
  internal->dim_inf_1_12 = internal->dim_inf_1_1 * internal->dim_inf_1_2;
  internal->dim_inf_1_prob = internal->dim_inf_1_prob_1 * internal->dim_inf_1_prob_2 * internal->dim_inf_1_prob_3;
  internal->dim_inf_1_prob_12 = internal->dim_inf_1_prob_1 * internal->dim_inf_1_prob_2;
  internal->dim_init_I1 = internal->dim_init_I1_1 * internal->dim_init_I1_2 * internal->dim_init_I1_3;
  internal->dim_init_I1_12 = internal->dim_init_I1_1 * internal->dim_init_I1_2;
  internal->dim_init_R1 = internal->dim_init_R1_1 * internal->dim_init_R1_2 * internal->dim_init_R1_3;
  internal->dim_init_R1_12 = internal->dim_init_R1_1 * internal->dim_init_R1_2;
  internal->dim_init_S = internal->dim_init_S_1 * internal->dim_init_S_2 * internal->dim_init_S_3;
  internal->dim_init_S_12 = internal->dim_init_S_1 * internal->dim_init_S_2;
  internal->dim_n_I1 = internal->dim_n_I1_1 * internal->dim_n_I1_2 * internal->dim_n_I1_3;
  internal->dim_n_I1_12 = internal->dim_n_I1_1 * internal->dim_n_I1_2;
  internal->dim_n_R1 = internal->dim_n_R1_1 * internal->dim_n_R1_2 * internal->dim_n_R1_3;
  internal->dim_n_R1_12 = internal->dim_n_R1_1 * internal->dim_n_R1_2;
  internal->dim_n_S = internal->dim_n_S_1 * internal->dim_n_S_2 * internal->dim_n_S_3;
  internal->dim_n_S_12 = internal->dim_n_S_1 * internal->dim_n_S_2;
  internal->dim_nn = internal->dim_nn_1 * internal->dim_nn_2;
  internal->dim_Ntotal = internal->dim_Ntotal_1 * internal->dim_Ntotal_2 * internal->dim_Ntotal_3;
  internal->dim_Ntotal_12 = internal->dim_Ntotal_1 * internal->dim_Ntotal_2;
  internal->dim_Ntotal_sum = internal->dim_Ntotal_sum_1 * internal->dim_Ntotal_sum_2;
  internal->dim_O_I1 = internal->dim_O_I1_1 * internal->dim_O_I1_2 * internal->dim_O_I1_3;
  internal->dim_O_I1_12 = internal->dim_O_I1_1 * internal->dim_O_I1_2;
  internal->dim_O_R1 = internal->dim_O_R1_1 * internal->dim_O_R1_2 * internal->dim_O_R1_3;
  internal->dim_O_R1_12 = internal->dim_O_R1_1 * internal->dim_O_R1_2;
  internal->dim_O_S = internal->dim_O_S_1 * internal->dim_O_S_2 * internal->dim_O_S_3;
  internal->dim_O_S_12 = internal->dim_O_S_1 * internal->dim_O_S_2;
  internal->dim_O_S_prob = internal->dim_O_S_prob_1 * internal->dim_O_S_prob_2 * internal->dim_O_S_prob_3;
  internal->dim_O_S_prob_12 = internal->dim_O_S_prob_1 * internal->dim_O_S_prob_2;
  internal->dim_R1 = internal->dim_R1_1 * internal->dim_R1_2 * internal->dim_R1_3;
  internal->dim_R1_12 = internal->dim_R1_1 * internal->dim_R1_2;
  internal->dim_recov1 = internal->dim_recov1_1 * internal->dim_recov1_2 * internal->dim_recov1_3;
  internal->dim_recov1_12 = internal->dim_recov1_1 * internal->dim_recov1_2;
  internal->dim_S = internal->dim_S_1 * internal->dim_S_2 * internal->dim_S_3;
  internal->dim_S_12 = internal->dim_S_1 * internal->dim_S_2;
  internal->dim_sum_S = internal->dim_sum_S_1 * internal->dim_sum_S_2;
  internal->dim_vacc_child_age = internal->vnc_row;
  internal->dim_vacc_cu_age = internal->vnc_row;
  internal->dim_vacc_noncov_1 = internal->vnc_row;
  internal->dim_vacc_noncov_2 = 2;
  internal->dim_vcu_noncov_1 = internal->vnc_row;
  internal->dim_vcu_noncov_2 = 2;
  internal->dim_Y1 = internal->dim_Y1_1 * internal->dim_Y1_2 * internal->dim_Y1_3;
  internal->dim_Y1_12 = internal->dim_Y1_1 * internal->dim_Y1_2;
  internal->dim_Y1T_sum = internal->dim_Y1T_sum_1 * internal->dim_Y1T_sum_2;
  for (int i = 1; i <= internal->dim_incubA; ++i) {
    internal->initial_incubA[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_incubB; ++i) {
    internal->initial_incubB[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_infectiousA; ++i) {
    internal->initial_infectiousA[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_infectiousB; ++i) {
    internal->initial_infectiousB[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Lwb; ++i) {
    internal->initial_Lwb[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwb_E1; ++i) {
    internal->initial_Mwb_E1[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwb_E2; ++i) {
    internal->initial_Mwb_E2[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwb_I1; ++i) {
    internal->initial_Mwb_I1[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwb_S; ++i) {
    internal->initial_Mwb_S[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwt_E1; ++i) {
    internal->initial_Mwt_E1[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwt_E2; ++i) {
    internal->initial_Mwt_E2[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwt_I1; ++i) {
    internal->initial_Mwt_I1[i - 1] = 0;
  }
  internal->Kc_mean = internal->DeltaBase * (pow((internal->Epsilon * (internal->Gamma - internal->DeltaBase) / (double) (internal->DeltaBase * internal->Sigma) - 1), (-(1) / (double) internal->Omega))) / (double) internal->Epsilon;
  internal->ln_mean = log(internal->Mwt_mean) - (internal->ln_sd * internal->ln_sd) / (double) 2;
  internal->N_eq = (double*) user_get_array(user, false, internal->N_eq, "N_eq", NA_REAL, NA_REAL, 1, internal->dim_N_eq);
  internal->Nb = (double*) user_get_array(user, false, internal->Nb, "Nb", NA_REAL, NA_REAL, 1, internal->dim_Nb);
  internal->offset_output_births = 9 + internal->dim_agert + internal->dim_deathrt;
  internal->offset_output_deathrt = 9 + internal->dim_agert;
  internal->offset_output_Delta = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip;
  internal->offset_output_eip = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc;
  internal->offset_output_FOI1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T;
  internal->offset_output_FOI1nn = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p;
  internal->offset_output_FOI1p = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1;
  internal->offset_output_FOI1Y = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp;
  internal->offset_output_infectious1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1;
  internal->offset_output_Kc = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y;
  internal->offset_output_Lwb_birth = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot;
  internal->offset_output_Lwb_mature = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth;
  internal->offset_output_Lwt_birth = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot;
  internal->offset_output_Lwt_mature = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth;
  internal->offset_output_M_propinf = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb;
  internal->offset_output_Mwb_inf1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature;
  internal->offset_output_Mwb_intro = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate;
  internal->offset_output_Mwb_propinf = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1;
  internal->offset_output_Mwb_tot = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf;
  internal->offset_output_Mwt_FOI1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp;
  internal->offset_output_Mwt_inf1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature;
  internal->offset_output_Mwt_propinf = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1;
  internal->offset_output_Mwt_tot = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1;
  internal->offset_output_NTp = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta;
  internal->offset_output_prop_Sp = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn;
  internal->offset_output_prop_wb = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro;
  internal->offset_output_R0t_1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1;
  internal->offset_output_rho1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1;
  internal->offset_output_vacc_noncov = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf;
  internal->offset_output_Wb_introrate = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf;
  internal->offset_output_Y1T = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births;
  internal->offset_variable_incubA = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1;
  internal->offset_variable_incubB = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1 + internal->dim_incubA;
  internal->offset_variable_infectiousA = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1 + internal->dim_incubA + internal->dim_incubB;
  internal->offset_variable_infectiousB = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA;
  internal->offset_variable_Lwb = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1;
  internal->offset_variable_Mwb_E1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S;
  internal->offset_variable_Mwb_E2 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1;
  internal->offset_variable_Mwb_I1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2;
  internal->offset_variable_Mwb_S = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb;
  internal->offset_variable_Mwt_E1 = internal->dim_Lwt + internal->dim_Mwt_S;
  internal->offset_variable_Mwt_E2 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1;
  internal->offset_variable_Mwt_I1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2;
  internal->offset_variable_S = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB;
  internal->Wb_introtime = (double*) user_get_array(user, false, internal->Wb_introtime, "Wb_introtime", NA_REAL, NA_REAL, 1, internal->dim_Wb_introtime);
  Free(internal->age_I1_trials);
  internal->age_I1_trials = (double*) Calloc(internal->dim_age_I1_trials, double);
  Free(internal->age_S);
  internal->age_S = (double*) Calloc(internal->dim_age_S, double);
  Free(internal->age_S_trials);
  internal->age_S_trials = (double*) Calloc(internal->dim_age_S_trials, double);
  Free(internal->inf_1);
  internal->inf_1 = (double*) Calloc(internal->dim_inf_1, double);
  Free(internal->inf_1_prob);
  internal->inf_1_prob = (double*) Calloc(internal->dim_inf_1_prob, double);
  Free(internal->initial_I1);
  internal->initial_I1 = (double*) Calloc(internal->dim_I1, double);
  Free(internal->initial_R1);
  internal->initial_R1 = (double*) Calloc(internal->dim_R1, double);
  Free(internal->initial_S);
  internal->initial_S = (double*) Calloc(internal->dim_S, double);
  Free(internal->n_I1);
  internal->n_I1 = (double*) Calloc(internal->dim_n_I1, double);
  Free(internal->n_R1);
  internal->n_R1 = (double*) Calloc(internal->dim_n_R1, double);
  Free(internal->n_S);
  internal->n_S = (double*) Calloc(internal->dim_n_S, double);
  Free(internal->Ntotal);
  internal->Ntotal = (double*) Calloc(internal->dim_Ntotal, double);
  Free(internal->Ntotal_sum);
  internal->Ntotal_sum = (double*) Calloc(internal->dim_Ntotal_sum, double);
  Free(internal->O_I1);
  internal->O_I1 = (double*) Calloc(internal->dim_O_I1, double);
  Free(internal->O_R1);
  internal->O_R1 = (double*) Calloc(internal->dim_O_R1, double);
  Free(internal->O_S);
  internal->O_S = (double*) Calloc(internal->dim_O_S, double);
  Free(internal->O_S_prob);
  internal->O_S_prob = (double*) Calloc(internal->dim_O_S_prob, double);
  Free(internal->recov1);
  internal->recov1 = (double*) Calloc(internal->dim_recov1, double);
  Free(internal->sum_S);
  internal->sum_S = (double*) Calloc(internal->dim_sum_S, double);
  Free(internal->Y1);
  internal->Y1 = (double*) Calloc(internal->dim_Y1, double);
  Free(internal->Y1T_sum);
  internal->Y1T_sum = (double*) Calloc(internal->dim_Y1T_sum, double);
  internal->amplitudes_phases = (double*) user_get_array(user, false, internal->amplitudes_phases, "amplitudes_phases", NA_REAL, NA_REAL, 2, internal->dim_amplitudes_phases_1, internal->dim_amplitudes_phases_2);
  for (int i = 1; i <= internal->dim_births_lambda; ++i) {
    internal->births_lambda[i - 1] = internal->DT * internal->Nb[i - 1] / (double) internal->YL;
  }
  internal->dim_age_I1 = internal->dim_age_I1_1 * internal->dim_age_I1_2 * internal->dim_age_I1_3;
  internal->dim_age_I1_12 = internal->dim_age_I1_1 * internal->dim_age_I1_2;
  internal->dim_age_R1 = internal->dim_age_R1_1 * internal->dim_age_R1_2 * internal->dim_age_R1_3;
  internal->dim_age_R1_12 = internal->dim_age_R1_1 * internal->dim_age_R1_2;
  internal->dim_vacc_noncov = internal->dim_vacc_noncov_1 * internal->dim_vacc_noncov_2;
  internal->dim_vcu_noncov = internal->dim_vcu_noncov_1 * internal->dim_vcu_noncov_2;
  internal->init_I1 = (double*) user_get_array(user, false, internal->init_I1, "init_I1", NA_REAL, NA_REAL, 3, internal->dim_init_I1_1, internal->dim_init_I1_2, internal->dim_init_I1_3);
  internal->init_R1 = (double*) user_get_array(user, false, internal->init_R1, "init_R1", NA_REAL, NA_REAL, 3, internal->dim_init_R1_1, internal->dim_init_R1_2, internal->dim_init_R1_3);
  internal->init_S = (double*) user_get_array(user, false, internal->init_S, "init_S", NA_REAL, NA_REAL, 3, internal->dim_init_S_1, internal->dim_init_S_2, internal->dim_init_S_3);
  for (int i = 1; i <= internal->dim_ln_pick; ++i) {
    internal->ln_pick[i - 1] = internal->ln_mean;
  }
  internal->nn = (int*) user_get_array(user, true, internal->nn, "nn", NA_REAL, NA_REAL, 2, internal->dim_nn_1, internal->dim_nn_2);
  internal->offset_variable_I1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB + internal->dim_S;
  internal->offset_variable_R1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB + internal->dim_S + internal->dim_I1;
  internal->vacc_child_age = (double*) user_get_array(user, false, internal->vacc_child_age, "vacc_child_age", NA_REAL, NA_REAL, 1, internal->dim_vacc_child_age);
  internal->vacc_cu_age = (double*) user_get_array(user, false, internal->vacc_cu_age, "vacc_cu_age", NA_REAL, NA_REAL, 1, internal->dim_vacc_cu_age);
  Free(internal->age_I1);
  internal->age_I1 = (double*) Calloc(internal->dim_age_I1, double);
  Free(internal->age_R1);
  internal->age_R1 = (double*) Calloc(internal->dim_age_R1, double);
  Free(internal->vacc_noncov);
  internal->vacc_noncov = (double*) Calloc(internal->dim_vacc_noncov, double);
  Free(internal->vcu_noncov);
  internal->vcu_noncov = (double*) Calloc(internal->dim_vcu_noncov, double);
  for (int i = 1; i <= internal->dim_births; ++i) {
    internal->births[i - 1] = internal->births_lambda[i - 1];
  }
  for (int i = 1; i <= internal->dim_I1_1; ++i) {
    for (int j = 1; j <= internal->dim_I1_2; ++j) {
      for (int k = 1; k <= internal->dim_I1_3; ++k) {
        internal->initial_I1[i - 1 + internal->dim_I1_1 * (j - 1) + internal->dim_I1_12 * (k - 1)] = internal->init_I1[internal->dim_init_I1_12 * (k - 1) + internal->dim_init_I1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_R1_1; ++i) {
    for (int j = 1; j <= internal->dim_R1_2; ++j) {
      for (int k = 1; k <= internal->dim_R1_3; ++k) {
        internal->initial_R1[i - 1 + internal->dim_R1_1 * (j - 1) + internal->dim_R1_12 * (k - 1)] = internal->init_R1[internal->dim_init_R1_12 * (k - 1) + internal->dim_init_R1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      for (int k = 1; k <= internal->dim_S_3; ++k) {
        internal->initial_S[i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = internal->init_S[internal->dim_init_S_12 * (k - 1) + internal->dim_init_S_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_Mwt; ++i) {
    internal->Mwt[i - 1] = exp(internal->ln_pick[i - 1]);
  }
  internal->offset_output_age_I1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1;
  internal->offset_output_age_R1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1;
  internal->offset_output_age_S = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1;
  internal->offset_output_inf_1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S;
  internal->offset_output_inf_1_prob = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1;
  internal->offset_output_Ntotal = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov;
  internal->offset_output_O_I1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S;
  internal->offset_output_O_R1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1;
  internal->offset_output_O_S = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal;
  internal->offset_output_O_S_prob = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1 + internal->dim_inf_1_prob;
  internal->offset_output_recov1 = 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1;
  for (int i = 1; i <= internal->dim_season_amp; ++i) {
    internal->season_amp[i - 1] = internal->amplitudes_phases[internal->dim_amplitudes_phases_1 * 1 + i - 1];
  }
  for (int i = 1; i <= internal->dim_season_phases; ++i) {
    internal->season_phases[i - 1] = internal->amplitudes_phases[internal->dim_amplitudes_phases_1 * 2 + i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_S; ++i) {
    internal->initial_Mwt_S[i - 1] = trunc(internal->Mwt[i - 1] * internal->N_eq[i - 1]);
  }
  for (int i = 1; i <= internal->dim_Wb_introrate; ++i) {
    internal->Wb_introrate[i - 1] = internal->Wb_introlevel * internal->Mwt[i - 1] * internal->N_eq[i - 1] * internal->DT / (double) internal->Wb_introduration;
  }
  return R_NilValue;
}
SEXP odin_model_determ_metadata(SEXP internal_p) {
  odin_model_determ_internal *internal = odin_model_determ_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 17));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 17));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, ScalarInteger(internal->dim_Lwt));
  SET_VECTOR_ELT(variable_length, 1, ScalarInteger(internal->dim_Mwt_S));
  SET_VECTOR_ELT(variable_length, 2, ScalarInteger(internal->dim_Mwt_E1));
  SET_VECTOR_ELT(variable_length, 3, ScalarInteger(internal->dim_Mwt_E2));
  SET_VECTOR_ELT(variable_length, 4, ScalarInteger(internal->dim_Mwt_I1));
  SET_VECTOR_ELT(variable_length, 5, ScalarInteger(internal->dim_Lwb));
  SET_VECTOR_ELT(variable_length, 6, ScalarInteger(internal->dim_Mwb_S));
  SET_VECTOR_ELT(variable_length, 7, ScalarInteger(internal->dim_Mwb_E1));
  SET_VECTOR_ELT(variable_length, 8, ScalarInteger(internal->dim_Mwb_E2));
  SET_VECTOR_ELT(variable_length, 9, ScalarInteger(internal->dim_Mwb_I1));
  SET_VECTOR_ELT(variable_length, 10, ScalarInteger(internal->dim_incubA));
  SET_VECTOR_ELT(variable_length, 11, ScalarInteger(internal->dim_incubB));
  SET_VECTOR_ELT(variable_length, 12, ScalarInteger(internal->dim_infectiousA));
  SET_VECTOR_ELT(variable_length, 13, ScalarInteger(internal->dim_infectiousB));
  SET_VECTOR_ELT(variable_length, 14, allocVector(INTSXP, 3));
  int * dim_S = INTEGER(VECTOR_ELT(variable_length, 14));
  dim_S[0] = internal->dim_S_1;
  dim_S[1] = internal->dim_S_2;
  dim_S[2] = internal->dim_S_3;
  SET_VECTOR_ELT(variable_length, 15, allocVector(INTSXP, 3));
  int * dim_I1 = INTEGER(VECTOR_ELT(variable_length, 15));
  dim_I1[0] = internal->dim_I1_1;
  dim_I1[1] = internal->dim_I1_2;
  dim_I1[2] = internal->dim_I1_3;
  SET_VECTOR_ELT(variable_length, 16, allocVector(INTSXP, 3));
  int * dim_R1 = INTEGER(VECTOR_ELT(variable_length, 16));
  dim_R1[0] = internal->dim_R1_1;
  dim_R1[1] = internal->dim_R1_2;
  dim_R1[2] = internal->dim_R1_3;
  SET_STRING_ELT(variable_names, 0, mkChar("Lwt"));
  SET_STRING_ELT(variable_names, 1, mkChar("Mwt_S"));
  SET_STRING_ELT(variable_names, 2, mkChar("Mwt_E1"));
  SET_STRING_ELT(variable_names, 3, mkChar("Mwt_E2"));
  SET_STRING_ELT(variable_names, 4, mkChar("Mwt_I1"));
  SET_STRING_ELT(variable_names, 5, mkChar("Lwb"));
  SET_STRING_ELT(variable_names, 6, mkChar("Mwb_S"));
  SET_STRING_ELT(variable_names, 7, mkChar("Mwb_E1"));
  SET_STRING_ELT(variable_names, 8, mkChar("Mwb_E2"));
  SET_STRING_ELT(variable_names, 9, mkChar("Mwb_I1"));
  SET_STRING_ELT(variable_names, 10, mkChar("incubA"));
  SET_STRING_ELT(variable_names, 11, mkChar("incubB"));
  SET_STRING_ELT(variable_names, 12, mkChar("infectiousA"));
  SET_STRING_ELT(variable_names, 13, mkChar("infectiousB"));
  SET_STRING_ELT(variable_names, 14, mkChar("S"));
  SET_STRING_ELT(variable_names, 15, mkChar("I1"));
  SET_STRING_ELT(variable_names, 16, mkChar("R1"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SEXP output_length = PROTECT(allocVector(VECSXP, 52));
  SEXP output_names = PROTECT(allocVector(STRSXP, 52));
  setAttrib(output_length, R_NamesSymbol, output_names);
  SET_VECTOR_ELT(output_length, 0, R_NilValue);
  SET_VECTOR_ELT(output_length, 1, R_NilValue);
  SET_VECTOR_ELT(output_length, 2, R_NilValue);
  SET_VECTOR_ELT(output_length, 3, R_NilValue);
  SET_VECTOR_ELT(output_length, 4, R_NilValue);
  SET_VECTOR_ELT(output_length, 5, R_NilValue);
  SET_VECTOR_ELT(output_length, 6, R_NilValue);
  SET_VECTOR_ELT(output_length, 7, R_NilValue);
  SET_VECTOR_ELT(output_length, 8, R_NilValue);
  SET_VECTOR_ELT(output_length, 9, ScalarInteger(internal->dim_agert));
  SET_VECTOR_ELT(output_length, 10, ScalarInteger(internal->dim_deathrt));
  SET_VECTOR_ELT(output_length, 11, ScalarInteger(internal->dim_births));
  SET_VECTOR_ELT(output_length, 12, ScalarInteger(internal->dim_Y1T));
  SET_VECTOR_ELT(output_length, 13, ScalarInteger(internal->dim_FOI1));
  SET_VECTOR_ELT(output_length, 14, ScalarInteger(internal->dim_FOI1p));
  SET_VECTOR_ELT(output_length, 15, ScalarInteger(internal->dim_FOI1nn));
  SET_VECTOR_ELT(output_length, 16, ScalarInteger(internal->dim_prop_Sp));
  SET_VECTOR_ELT(output_length, 17, ScalarInteger(internal->dim_FOI1Y));
  SET_VECTOR_ELT(output_length, 18, ScalarInteger(internal->dim_Kc));
  SET_VECTOR_ELT(output_length, 19, ScalarInteger(internal->dim_eip));
  SET_VECTOR_ELT(output_length, 20, ScalarInteger(internal->dim_Delta));
  SET_VECTOR_ELT(output_length, 21, ScalarInteger(internal->dim_NTp));
  SET_VECTOR_ELT(output_length, 22, ScalarInteger(internal->dim_Mwt_FOI1));
  SET_VECTOR_ELT(output_length, 23, ScalarInteger(internal->dim_rho1));
  SET_VECTOR_ELT(output_length, 24, ScalarInteger(internal->dim_infectious1));
  SET_VECTOR_ELT(output_length, 25, ScalarInteger(internal->dim_R0t_1));
  SET_VECTOR_ELT(output_length, 26, ScalarInteger(internal->dim_Mwt_tot));
  SET_VECTOR_ELT(output_length, 27, ScalarInteger(internal->dim_Lwt_birth));
  SET_VECTOR_ELT(output_length, 28, ScalarInteger(internal->dim_Lwt_mature));
  SET_VECTOR_ELT(output_length, 29, ScalarInteger(internal->dim_Mwt_inf1));
  SET_VECTOR_ELT(output_length, 30, ScalarInteger(internal->dim_Mwt_propinf));
  SET_VECTOR_ELT(output_length, 31, ScalarInteger(internal->dim_Mwb_tot));
  SET_VECTOR_ELT(output_length, 32, ScalarInteger(internal->dim_Lwb_birth));
  SET_VECTOR_ELT(output_length, 33, ScalarInteger(internal->dim_Lwb_mature));
  SET_VECTOR_ELT(output_length, 34, ScalarInteger(internal->dim_Mwb_inf1));
  SET_VECTOR_ELT(output_length, 35, ScalarInteger(internal->dim_Mwb_propinf));
  SET_VECTOR_ELT(output_length, 36, ScalarInteger(internal->dim_Wb_introrate));
  SET_VECTOR_ELT(output_length, 37, ScalarInteger(internal->dim_Mwb_intro));
  SET_VECTOR_ELT(output_length, 38, ScalarInteger(internal->dim_prop_wb));
  SET_VECTOR_ELT(output_length, 39, ScalarInteger(internal->dim_M_propinf));
  SET_VECTOR_ELT(output_length, 40, allocVector(INTSXP, 2));
  int * dim_vacc_noncov = INTEGER(VECTOR_ELT(output_length, 40));
  dim_vacc_noncov[0] = internal->dim_vacc_noncov_1;
  dim_vacc_noncov[1] = internal->dim_vacc_noncov_2;
  SET_VECTOR_ELT(output_length, 41, allocVector(INTSXP, 3));
  int * dim_Ntotal = INTEGER(VECTOR_ELT(output_length, 41));
  dim_Ntotal[0] = internal->dim_Ntotal_1;
  dim_Ntotal[1] = internal->dim_Ntotal_2;
  dim_Ntotal[2] = internal->dim_Ntotal_3;
  SET_VECTOR_ELT(output_length, 42, allocVector(INTSXP, 3));
  int * dim_O_S = INTEGER(VECTOR_ELT(output_length, 42));
  dim_O_S[0] = internal->dim_O_S_1;
  dim_O_S[1] = internal->dim_O_S_2;
  dim_O_S[2] = internal->dim_O_S_3;
  SET_VECTOR_ELT(output_length, 43, allocVector(INTSXP, 3));
  int * dim_inf_1 = INTEGER(VECTOR_ELT(output_length, 43));
  dim_inf_1[0] = internal->dim_inf_1_1;
  dim_inf_1[1] = internal->dim_inf_1_2;
  dim_inf_1[2] = internal->dim_inf_1_3;
  SET_VECTOR_ELT(output_length, 44, allocVector(INTSXP, 3));
  int * dim_age_S = INTEGER(VECTOR_ELT(output_length, 44));
  dim_age_S[0] = internal->dim_age_S_1;
  dim_age_S[1] = internal->dim_age_S_2;
  dim_age_S[2] = internal->dim_age_S_3;
  SET_VECTOR_ELT(output_length, 45, allocVector(INTSXP, 3));
  int * dim_O_I1 = INTEGER(VECTOR_ELT(output_length, 45));
  dim_O_I1[0] = internal->dim_O_I1_1;
  dim_O_I1[1] = internal->dim_O_I1_2;
  dim_O_I1[2] = internal->dim_O_I1_3;
  SET_VECTOR_ELT(output_length, 46, allocVector(INTSXP, 3));
  int * dim_recov1 = INTEGER(VECTOR_ELT(output_length, 46));
  dim_recov1[0] = internal->dim_recov1_1;
  dim_recov1[1] = internal->dim_recov1_2;
  dim_recov1[2] = internal->dim_recov1_3;
  SET_VECTOR_ELT(output_length, 47, allocVector(INTSXP, 3));
  int * dim_age_I1 = INTEGER(VECTOR_ELT(output_length, 47));
  dim_age_I1[0] = internal->dim_age_I1_1;
  dim_age_I1[1] = internal->dim_age_I1_2;
  dim_age_I1[2] = internal->dim_age_I1_3;
  SET_VECTOR_ELT(output_length, 48, allocVector(INTSXP, 3));
  int * dim_O_R1 = INTEGER(VECTOR_ELT(output_length, 48));
  dim_O_R1[0] = internal->dim_O_R1_1;
  dim_O_R1[1] = internal->dim_O_R1_2;
  dim_O_R1[2] = internal->dim_O_R1_3;
  SET_VECTOR_ELT(output_length, 49, allocVector(INTSXP, 3));
  int * dim_age_R1 = INTEGER(VECTOR_ELT(output_length, 49));
  dim_age_R1[0] = internal->dim_age_R1_1;
  dim_age_R1[1] = internal->dim_age_R1_2;
  dim_age_R1[2] = internal->dim_age_R1_3;
  SET_VECTOR_ELT(output_length, 50, allocVector(INTSXP, 3));
  int * dim_inf_1_prob = INTEGER(VECTOR_ELT(output_length, 50));
  dim_inf_1_prob[0] = internal->dim_inf_1_prob_1;
  dim_inf_1_prob[1] = internal->dim_inf_1_prob_2;
  dim_inf_1_prob[2] = internal->dim_inf_1_prob_3;
  SET_VECTOR_ELT(output_length, 51, allocVector(INTSXP, 3));
  int * dim_O_S_prob = INTEGER(VECTOR_ELT(output_length, 51));
  dim_O_S_prob[0] = internal->dim_O_S_prob_1;
  dim_O_S_prob[1] = internal->dim_O_S_prob_2;
  dim_O_S_prob[2] = internal->dim_O_S_prob_3;
  SET_STRING_ELT(output_names, 0, mkChar("FOI1av"));
  SET_STRING_ELT(output_names, 1, mkChar("Deltaav"));
  SET_STRING_ELT(output_names, 2, mkChar("Kcav"));
  SET_STRING_ELT(output_names, 3, mkChar("eipav"));
  SET_STRING_ELT(output_names, 4, mkChar("R0t_1av"));
  SET_STRING_ELT(output_names, 5, mkChar("Mwt_FOI1av"));
  SET_STRING_ELT(output_names, 6, mkChar("MwtCont"));
  SET_STRING_ELT(output_names, 7, mkChar("Mwb_FOI1av"));
  SET_STRING_ELT(output_names, 8, mkChar("TIME"));
  SET_STRING_ELT(output_names, 9, mkChar("agert"));
  SET_STRING_ELT(output_names, 10, mkChar("deathrt"));
  SET_STRING_ELT(output_names, 11, mkChar("births"));
  SET_STRING_ELT(output_names, 12, mkChar("Y1T"));
  SET_STRING_ELT(output_names, 13, mkChar("FOI1"));
  SET_STRING_ELT(output_names, 14, mkChar("FOI1p"));
  SET_STRING_ELT(output_names, 15, mkChar("FOI1nn"));
  SET_STRING_ELT(output_names, 16, mkChar("prop_Sp"));
  SET_STRING_ELT(output_names, 17, mkChar("FOI1Y"));
  SET_STRING_ELT(output_names, 18, mkChar("Kc"));
  SET_STRING_ELT(output_names, 19, mkChar("eip"));
  SET_STRING_ELT(output_names, 20, mkChar("Delta"));
  SET_STRING_ELT(output_names, 21, mkChar("NTp"));
  SET_STRING_ELT(output_names, 22, mkChar("Mwt_FOI1"));
  SET_STRING_ELT(output_names, 23, mkChar("rho1"));
  SET_STRING_ELT(output_names, 24, mkChar("infectious1"));
  SET_STRING_ELT(output_names, 25, mkChar("R0t_1"));
  SET_STRING_ELT(output_names, 26, mkChar("Mwt_tot"));
  SET_STRING_ELT(output_names, 27, mkChar("Lwt_birth"));
  SET_STRING_ELT(output_names, 28, mkChar("Lwt_mature"));
  SET_STRING_ELT(output_names, 29, mkChar("Mwt_inf1"));
  SET_STRING_ELT(output_names, 30, mkChar("Mwt_propinf"));
  SET_STRING_ELT(output_names, 31, mkChar("Mwb_tot"));
  SET_STRING_ELT(output_names, 32, mkChar("Lwb_birth"));
  SET_STRING_ELT(output_names, 33, mkChar("Lwb_mature"));
  SET_STRING_ELT(output_names, 34, mkChar("Mwb_inf1"));
  SET_STRING_ELT(output_names, 35, mkChar("Mwb_propinf"));
  SET_STRING_ELT(output_names, 36, mkChar("Wb_introrate"));
  SET_STRING_ELT(output_names, 37, mkChar("Mwb_intro"));
  SET_STRING_ELT(output_names, 38, mkChar("prop_wb"));
  SET_STRING_ELT(output_names, 39, mkChar("M_propinf"));
  SET_STRING_ELT(output_names, 40, mkChar("vacc_noncov"));
  SET_STRING_ELT(output_names, 41, mkChar("Ntotal"));
  SET_STRING_ELT(output_names, 42, mkChar("O_S"));
  SET_STRING_ELT(output_names, 43, mkChar("inf_1"));
  SET_STRING_ELT(output_names, 44, mkChar("age_S"));
  SET_STRING_ELT(output_names, 45, mkChar("O_I1"));
  SET_STRING_ELT(output_names, 46, mkChar("recov1"));
  SET_STRING_ELT(output_names, 47, mkChar("age_I1"));
  SET_STRING_ELT(output_names, 48, mkChar("O_R1"));
  SET_STRING_ELT(output_names, 49, mkChar("age_R1"));
  SET_STRING_ELT(output_names, 50, mkChar("inf_1_prob"));
  SET_STRING_ELT(output_names, 51, mkChar("O_S_prob"));
  SET_VECTOR_ELT(ret, 1, output_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1 + internal->dim_inf_1_prob + internal->dim_O_S_prob));
  UNPROTECT(2);
  return ret;
}
SEXP odin_model_determ_initial_conditions(SEXP internal_p, SEXP step_ptr) {
  int step = INTEGER(step_ptr)[0];
  odin_model_determ_internal *internal = odin_model_determ_get_internal(internal_p, 1);
  double TIME = step * internal->DT;
  double MwtCont = ((TIME >= internal->TimeMwtControlOn * internal->YL) && (TIME < internal->TimeMwtControlOff * internal->YL) ? (1 - internal->propMwtControl) : 1);
  double DeltaMean = internal->DeltaBase / (double) MwtCont;
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->Delta[i - 1] = DeltaMean / (double) (1 + internal->season_amp[i - 1] * internal->Delta_season * cos(2 * internal->pi * (TIME + internal->season_phases[i - 1]) / (double) internal->YL));
  }
  {
     int i = internal->NP;
     internal->Delta[i - 1] = DeltaMean;
  }
  for (int i = 1; i <= internal->dim_Lwt; ++i) {
    internal->initial_Lwt[i - 1] = trunc(internal->Mwt[i - 1] * internal->N_eq[i - 1] * internal->Delta[i - 1] / (double) internal->Epsilon);
  }
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_Lwb + internal->dim_Mwb_S + internal->dim_Mwb_E1 + internal->dim_Mwb_E2 + internal->dim_Mwb_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB + internal->dim_S + internal->dim_I1 + internal->dim_R1));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_Lwt, internal->dim_Lwt * sizeof(double));
  memcpy(state + internal->dim_Lwt, internal->initial_Mwt_S, internal->dim_Mwt_S * sizeof(double));
  memcpy(state + internal->offset_variable_Mwt_E1, internal->initial_Mwt_E1, internal->dim_Mwt_E1 * sizeof(double));
  memcpy(state + internal->offset_variable_Mwt_E2, internal->initial_Mwt_E2, internal->dim_Mwt_E2 * sizeof(double));
  memcpy(state + internal->offset_variable_Mwt_I1, internal->initial_Mwt_I1, internal->dim_Mwt_I1 * sizeof(double));
  memcpy(state + internal->offset_variable_Lwb, internal->initial_Lwb, internal->dim_Lwb * sizeof(double));
  memcpy(state + internal->offset_variable_Mwb_S, internal->initial_Mwb_S, internal->dim_Mwb_S * sizeof(double));
  memcpy(state + internal->offset_variable_Mwb_E1, internal->initial_Mwb_E1, internal->dim_Mwb_E1 * sizeof(double));
  memcpy(state + internal->offset_variable_Mwb_E2, internal->initial_Mwb_E2, internal->dim_Mwb_E2 * sizeof(double));
  memcpy(state + internal->offset_variable_Mwb_I1, internal->initial_Mwb_I1, internal->dim_Mwb_I1 * sizeof(double));
  memcpy(state + internal->offset_variable_incubA, internal->initial_incubA, internal->dim_incubA * sizeof(double));
  memcpy(state + internal->offset_variable_incubB, internal->initial_incubB, internal->dim_incubB * sizeof(double));
  memcpy(state + internal->offset_variable_infectiousA, internal->initial_infectiousA, internal->dim_infectiousA * sizeof(double));
  memcpy(state + internal->offset_variable_infectiousB, internal->initial_infectiousB, internal->dim_infectiousB * sizeof(double));
  memcpy(state + internal->offset_variable_S, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->offset_variable_I1, internal->initial_I1, internal->dim_I1 * sizeof(double));
  memcpy(state + internal->offset_variable_R1, internal->initial_R1, internal->dim_R1 * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void odin_model_determ_rhs(odin_model_determ_internal* internal, size_t step, double * state, double * state_next, double * output) {
  double * Lwt = state + 0;
  double * Mwt_S = state + internal->dim_Lwt;
  double * Mwt_E1 = state + internal->offset_variable_Mwt_E1;
  double * Mwt_E2 = state + internal->offset_variable_Mwt_E2;
  double * Mwt_I1 = state + internal->offset_variable_Mwt_I1;
  double * Lwb = state + internal->offset_variable_Lwb;
  double * Mwb_S = state + internal->offset_variable_Mwb_S;
  double * Mwb_E1 = state + internal->offset_variable_Mwb_E1;
  double * Mwb_E2 = state + internal->offset_variable_Mwb_E2;
  double * Mwb_I1 = state + internal->offset_variable_Mwb_I1;
  double * incubA = state + internal->offset_variable_incubA;
  double * incubB = state + internal->offset_variable_incubB;
  double * infectiousA = state + internal->offset_variable_infectiousA;
  double * infectiousB = state + internal->offset_variable_infectiousB;
  double * S = state + internal->offset_variable_S;
  double * I1 = state + internal->offset_variable_I1;
  double * R1 = state + internal->offset_variable_R1;
  double TIME = step * internal->DT;
  double agerts = (trunc(TIME / (double) internal->age_per) == TIME / (double) internal->age_per ? internal->age_per / (double) internal->YL : 0);
  double MwtCont = ((TIME >= internal->TimeMwtControlOn * internal->YL) && (TIME < internal->TimeMwtControlOff * internal->YL) ? (1 - internal->propMwtControl) : 1);
  for (int i = 1; i <= internal->dim_incubB; ++i) {
    state_next[internal->offset_variable_incubB + i - 1] = incubB[i - 1] + internal->DT * 2 * (incubA[i - 1] - incubB[i - 1]) / (double) internal->incub;
  }
  for (int i = 1; i <= internal->dim_infectiousA; ++i) {
    state_next[internal->offset_variable_infectiousA + i - 1] = infectiousA[i - 1] + internal->DT * 2 * (incubB[i - 1] / (double) internal->incub - infectiousA[i - 1] / (double) internal->inf_per);
  }
  for (int i = 1; i <= internal->dim_infectiousB; ++i) {
    state_next[internal->offset_variable_infectiousB + i - 1] = infectiousB[i - 1] + internal->DT * 2 * (infectiousA[i - 1] - infectiousB[i - 1]) / (double) internal->inf_per;
  }
  for (int i = 1; i <= internal->dim_agert; ++i) {
    internal->agert[i - 1] = agerts / (double) internal->agec[i - 1];
  }
  double DeltaMean = internal->DeltaBase / (double) MwtCont;
  for (int i = 1; i <= internal->dim_infectious1; ++i) {
    internal->infectious1[i - 1] = infectiousA[i - 1] + infectiousB[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwb_tot; ++i) {
    internal->Mwb_tot[i - 1] = Mwb_S[i - 1] + Mwb_E1[i - 1] + Mwb_E2[i - 1] + Mwb_I1[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_tot; ++i) {
    internal->Mwt_tot[i - 1] = Mwt_S[i - 1] + Mwt_E1[i - 1] + Mwt_E2[i - 1] + Mwt_I1[i - 1];
  }
  for (int i = 1; i <= internal->dim_age_I1_prob; ++i) {
    internal->age_I1_prob[i - 1] = fmax(fmin(internal->agert[i - 1] / (double) (internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_age_R1_prob; ++i) {
    internal->age_R1_prob[i - 1] = fmax(fmin(internal->agert[i - 1] / (double) (internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_age_S_prob; ++i) {
    internal->age_S_prob[i - 1] = fmax(fmin(internal->agert[i - 1] / (double) (internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Lwb_birth_lambda; ++i) {
    internal->Lwb_birth_lambda[i - 1] = internal->DT * (internal->Gamma * internal->Wb_fF * internal->Wb_mat * internal->Mwb_tot[i - 1]);
  }
  for (int i = 1; i <= internal->dim_Lwt_birth_lambda; ++i) {
    internal->Lwt_birth_lambda[i - 1] = internal->DT * (internal->Gamma * internal->Mwt_tot[i - 1] * (internal->Mwt_tot[i - 1] + (1 - internal->Wb_cyto) * internal->Mwb_tot[i - 1]) / (double) (internal->Mwt_tot[i - 1] + internal->Mwb_tot[i - 1]) + internal->Wb_fF * (1 - internal->Wb_mat) * internal->Mwb_tot[i - 1]);
  }
  for (int i = 1; i <= internal->dim_Mwt_FOI1; ++i) {
    internal->Mwt_FOI1[i - 1] = internal->DT * internal->Beta_hm_1 * internal->Kappa * internal->infectious1[i - 1];
  }
  for (int i = 1; i <= internal->dim_Ntotal_1; ++i) {
    for (int j = 1; j <= internal->dim_Ntotal_2; ++j) {
      for (int k = 1; k <= internal->dim_Ntotal_3; ++k) {
        internal->Ntotal[i - 1 + internal->dim_Ntotal_1 * (j - 1) + internal->dim_Ntotal_12 * (k - 1)] = S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] + I1[internal->dim_I1_12 * (k - 1) + internal->dim_I1_1 * (j - 1) + i - 1] + R1[internal->dim_R1_12 * (k - 1) + internal->dim_R1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_O_I1_prob; ++i) {
    internal->O_I1_prob[i - 1] = fmax(fmin(internal->nu + internal->agert[i - 1] + internal->deathrt[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_R1_prob; ++i) {
    internal->O_R1_prob[i - 1] = fmax(fmin(internal->agert[i - 1] + internal->deathrt[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_recov1_prob; ++i) {
    internal->recov1_prob[i - 1] = fmax(fmin(internal->nu / (double) (internal->nu + internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->Delta[i - 1] = DeltaMean / (double) (1 + internal->season_amp[i - 1] * internal->Delta_season * cos(2 * internal->pi * (TIME + internal->season_phases[i - 1]) / (double) internal->YL));
  }
  {
     int i = internal->NP;
     internal->Delta[i - 1] = DeltaMean;
  }
  for (int i = 1; i <= internal->dim_eip; ++i) {
    internal->eip[i - 1] = internal->eip_mean * (1 - internal->season_amp[i - 1] * internal->eip_season * cos(2 * internal->pi * (TIME + internal->season_phases[i - 1]) / (double) internal->YL));
  }
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->Kc[i - 1] = internal->Mwt[i - 1] * internal->Kc_mean * (1 + internal->season_amp[i - 1] * internal->Kc_season * cos(2 * internal->pi * (TIME + internal->season_phases[i - 1]) / (double) internal->YL));
  }
  {
     int i = internal->NP;
     internal->Kc[i - 1] = MwtCont * internal->Mwt_mean * internal->Kc_mean * (1 + internal->season_amp[i - 1] * internal->Kc_season * cos(2 * internal->pi * (TIME + internal->season_phases[i - 1]) / (double) internal->YL));
  }
  for (int i = 1; i <= internal->dim_Lwb_birth; ++i) {
    internal->Lwb_birth[i - 1] = internal->Lwb_birth_lambda[i - 1];
  }
  for (int i = 1; i <= internal->dim_Lwt_birth; ++i) {
    internal->Lwt_birth[i - 1] = internal->Lwt_birth_lambda[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwb_FOI1; ++i) {
    internal->Mwb_FOI1[i - 1] = internal->Wb_relsusc1 * internal->Mwt_FOI1[i - 1];
  }
  {
     int i = 1;
     for (int j = 1; j <= internal->NP; ++j) {
       internal->Ntotal_sum[i - 1 + internal->dim_Ntotal_sum_1 * (j - 1)] = internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 0 + i - 1] + internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 1 + i - 1];
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    for (int j = 1; j <= internal->NP; ++j) {
      internal->Ntotal_sum[i - 1 + internal->dim_Ntotal_sum_1 * (j - 1)] = internal->Ntotal_sum[internal->dim_Ntotal_sum_1 * (j - 1) + i - 1 - 1] + internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 0 + i - 1] + internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 1 + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_O_I1_1; ++i) {
    for (int j = 1; j <= internal->dim_O_I1_2; ++j) {
      for (int k = 1; k <= internal->dim_O_I1_3; ++k) {
        internal->O_I1[i - 1 + internal->dim_O_I1_1 * (j - 1) + internal->dim_O_I1_12 * (k - 1)] = I1[internal->dim_I1_12 * (k - 1) + internal->dim_I1_1 * (j - 1) + i - 1] * internal->O_I1_prob[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_O_R1_1; ++i) {
    for (int j = 1; j <= internal->dim_O_R1_2; ++j) {
      for (int k = 1; k <= internal->dim_O_R1_3; ++k) {
        internal->O_R1[i - 1 + internal->dim_O_R1_1 * (j - 1) + internal->dim_O_R1_12 * (k - 1)] = R1[internal->dim_R1_12 * (k - 1) + internal->dim_R1_1 * (j - 1) + i - 1] * internal->O_R1_prob[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_vacc_noncov_1; ++i) {
    int j = 1;
    internal->vacc_noncov[i - 1 + internal->dim_vacc_noncov_1 * (j - 1)] = (((TIME >= internal->YL * internal->vacc_child_starttime) && (TIME < internal->YL * internal->vacc_child_stoptime) && (internal->vacc_child_age[i - 1] == 1) ? (1 - internal->vacc_child_coverage) : 1));
  }
  for (int i = 1; i <= internal->dim_vacc_noncov_1; ++i) {
    int j = 2;
    internal->vacc_noncov[i - 1 + internal->dim_vacc_noncov_1 * (j - 1)] = 1;
  }
  for (int i = 1; i <= internal->dim_vcu_noncov_1; ++i) {
    int j = 1;
    internal->vcu_noncov[i - 1 + internal->dim_vcu_noncov_1 * (j - 1)] = (((TIME == internal->vacc_cu_rndtime) && (internal->vacc_cu_age[i - 1] == 1) ? (1 - internal->vacc_cu_coverage) : 1));
  }
  for (int i = 1; i <= internal->dim_vcu_noncov_1; ++i) {
    int j = 2;
    internal->vcu_noncov[i - 1 + internal->dim_vcu_noncov_1 * (j - 1)] = 1;
  }
  for (int i = 2; i <= internal->vnc_row; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        internal->age_R1[i - 1 + internal->dim_age_R1_1 * (j - 1) + internal->dim_age_R1_12 * (k - 1)] = internal->O_R1[internal->dim_O_R1_12 * (k - 1) + internal->dim_O_R1_1 * (j - 1) + i - 1 - 1] * internal->age_R1_prob[i - 1 - 1];
      }
    }
  }
  {
     int i = 1;
     for (int j = 1; j <= 2; ++j) {
       for (int k = 1; k <= internal->NP; ++k) {
         internal->age_R1[i - 1 + internal->dim_age_R1_1 * (j - 1) + internal->dim_age_R1_12 * (k - 1)] = 0;
       }
     }
  }
  for (int i = 1; i <= internal->dim_Delta_wb; ++i) {
    internal->Delta_wb[i - 1] = internal->Delta[i - 1] / (double) internal->Wb_fM;
  }
  for (int i = 1; i <= internal->dim_Mwb_E1_incub_prob; ++i) {
    internal->Mwb_E1_incub_prob[i - 1] = fmax(fmin(1 / (double) (internal->Delta[i - 1] * internal->eip[i - 1] + 1), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwb_E2_incub_prob; ++i) {
    internal->Mwb_E2_incub_prob[i - 1] = fmax(fmin(1 / (double) (internal->Delta[i - 1] * internal->eip[i - 1] / (double) 2 + 1), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwb_intro; ++i) {
    internal->Mwb_intro[i - 1] = ((TIME >= internal->Wb_introtime[i - 1] * internal->YL) && (TIME < internal->Wb_introtime[i - 1] * internal->YL + internal->Wb_introduration) ? internal->Wb_introrate[i - 1] : 0);
  }
  for (int i = 1; i <= internal->dim_Mwt_E1_incub_prob; ++i) {
    internal->Mwt_E1_incub_prob[i - 1] = fmax(fmin(1 / (double) (internal->Delta[i - 1] * internal->eip[i - 1] / (double) 2 + 1), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwt_E2_incub_prob; ++i) {
    internal->Mwt_E2_incub_prob[i - 1] = fmax(fmin(1 / (double) (internal->Delta[i - 1] * internal->eip[i - 1] / (double) 2 + 1), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwt_inf1_prob; ++i) {
    internal->Mwt_inf1_prob[i - 1] = fmax(fmin(internal->Mwt_FOI1[i - 1] / (double) (internal->DT * internal->Delta[i - 1] + internal->Mwt_FOI1[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_NTp; ++i) {
    internal->NTp[i - 1] = internal->Ntotal_sum[internal->dim_Ntotal_sum_1 * (i - 1) + internal->na - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwb_E2_prob; ++i) {
    internal->O_Mwb_E2_prob[i - 1] = fmax(fmin(internal->DT * (internal->Delta[i - 1] + 2 / (double) internal->eip[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E1_prob; ++i) {
    internal->O_Mwt_E1_prob[i - 1] = fmax(fmin(internal->DT * (internal->Delta[i - 1] + 2 / (double) internal->eip[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E2_prob; ++i) {
    internal->O_Mwt_E2_prob[i - 1] = fmax(fmin(internal->DT * (internal->Delta[i - 1] + 2 / (double) internal->eip[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_I1_prob; ++i) {
    internal->O_Mwt_I1_prob[i - 1] = fmax(fmin(internal->DT * internal->Delta[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_S_prob; ++i) {
    internal->O_Mwt_S_prob[i - 1] = fmax(fmin(internal->DT * internal->Delta[i - 1] + internal->Mwt_FOI1[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_recov1_1; ++i) {
    for (int j = 1; j <= internal->dim_recov1_2; ++j) {
      for (int k = 1; k <= internal->dim_recov1_3; ++k) {
        internal->recov1[i - 1 + internal->dim_recov1_1 * (j - 1) + internal->dim_recov1_12 * (k - 1)] = internal->O_I1[internal->dim_O_I1_12 * (k - 1) + internal->dim_O_I1_1 * (j - 1) + i - 1] * internal->recov1_prob[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_age_I1_trials_1; ++i) {
    for (int j = 1; j <= internal->dim_age_I1_trials_2; ++j) {
      for (int k = 1; k <= internal->dim_age_I1_trials_3; ++k) {
        internal->age_I1_trials[i - 1 + internal->dim_age_I1_trials_1 * (j - 1) + internal->dim_age_I1_trials_12 * (k - 1)] = internal->O_I1[internal->dim_O_I1_12 * (k - 1) + internal->dim_O_I1_1 * (j - 1) + i - 1] - internal->recov1[internal->dim_recov1_12 * (k - 1) + internal->dim_recov1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_FOI1p; ++i) {
    internal->FOI1p[i - 1] = internal->DT * internal->Beta_mh_1 * internal->Kappa * (Mwt_I1[i - 1] + Mwb_I1[i - 1] * internal->Wb_relinf1) / (double) internal->NTp[i - 1];
  }
  for (int i = 1; i <= internal->dim_L_deathrt; ++i) {
    internal->L_deathrt[i - 1] = internal->DT * internal->Sigma * ((1 + pow(((Lwt[i - 1] + Lwb[i - 1]) / (double) (internal->Kc[i - 1] * internal->NTp[i - 1])), internal->Omega)));
  }
  for (int i = 1; i <= internal->dim_Mwb_inf1_prob; ++i) {
    internal->Mwb_inf1_prob[i - 1] = fmax(fmin(internal->Mwb_FOI1[i - 1] / (double) (internal->DT * internal->Delta_wb[i - 1] + internal->Mwb_FOI1[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->na; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        internal->n_R1[i - 1 + internal->dim_n_R1_1 * (j - 1) + internal->dim_n_R1_12 * (k - 1)] = trunc(0.5 + internal->vacc_noncov[internal->dim_vacc_noncov_1 * (j - 1) + i - 1] * internal->age_R1[internal->dim_age_R1_12 * (k - 1) + internal->dim_age_R1_1 * (j - 1) + i - 1] + (1 - internal->vacc_noncov[internal->dim_vacc_noncov_1 * (3 - j - 1) + i - 1]) * internal->age_R1[internal->dim_age_R1_12 * (k - 1) + internal->dim_age_R1_1 * (3 - j - 1) + i - 1] + internal->recov1[internal->dim_recov1_12 * (k - 1) + internal->dim_recov1_1 * (j - 1) + i - 1] + R1[internal->dim_R1_12 * (k - 1) + internal->dim_R1_1 * (j - 1) + i - 1] - internal->O_R1[internal->dim_O_R1_12 * (k - 1) + internal->dim_O_R1_1 * (j - 1) + i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_O_Mwb_E1_prob; ++i) {
    internal->O_Mwb_E1_prob[i - 1] = fmax(fmin(internal->DT * (internal->Delta_wb[i - 1] + 1 / (double) internal->eip[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwb_E2; ++i) {
    internal->O_Mwb_E2[i - 1] = Mwb_E2[i - 1] * internal->O_Mwb_E2_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwb_I1_prob; ++i) {
    internal->O_Mwb_I1_prob[i - 1] = fmax(fmin(internal->DT * internal->Delta_wb[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwb_S_prob; ++i) {
    internal->O_Mwb_S_prob[i - 1] = fmax(fmin(internal->DT * internal->Delta_wb[i - 1] + internal->Mwb_FOI1[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E1; ++i) {
    internal->O_Mwt_E1[i - 1] = Mwt_E1[i - 1] * internal->O_Mwt_E1_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E2; ++i) {
    internal->O_Mwt_E2[i - 1] = Mwt_E2[i - 1] * internal->O_Mwt_E2_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwt_I1; ++i) {
    internal->O_Mwt_I1[i - 1] = Mwt_I1[i - 1] * internal->O_Mwt_I1_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwt_S; ++i) {
    internal->O_Mwt_S[i - 1] = Mwt_S[i - 1] * internal->O_Mwt_S_prob[i - 1];
  }
  for (int i = 2; i <= internal->vnc_row; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        internal->age_I1[i - 1 + internal->dim_age_I1_1 * (j - 1) + internal->dim_age_I1_12 * (k - 1)] = internal->age_I1_trials[internal->dim_age_I1_trials_12 * (k - 1) + internal->dim_age_I1_trials_1 * (j - 1) + i - 1 - 1] * internal->age_I1_prob[i - 1 - 1];
      }
    }
  }
  {
     int i = 1;
     for (int j = 1; j <= 2; ++j) {
       for (int k = 1; k <= internal->NP; ++k) {
         internal->age_I1[i - 1 + internal->dim_age_I1_1 * (j - 1) + internal->dim_age_I1_12 * (k - 1)] = 0;
       }
     }
  }
  double FOI1av = (odin_sum1(internal->FOI1p, 0, internal->dim_FOI1p) - internal->FOI1p[internal->NP - 1]) / (double) (internal->NP - 1);
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->FOI1nn[i - 1] = (internal->FOI1p[internal->nn[internal->dim_nn_1 * 0 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 1 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 2 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 3 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 4 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 5 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 6 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 7 + i - 1] - 1]) / (double) 8;
  }
  for (int i = 1; i <= internal->dim_L_dr; ++i) {
    internal->L_dr[i - 1] = (internal->L_deathrt[i - 1] >= 1 ? 0.999 : internal->L_deathrt[i - 1]);
  }
  for (int i = 1; i <= internal->dim_Mwb_E2_incub; ++i) {
    internal->Mwb_E2_incub[i - 1] = internal->O_Mwb_E2[i - 1] * internal->Mwb_E2_incub_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_E1_incub; ++i) {
    internal->Mwt_E1_incub[i - 1] = internal->O_Mwt_E1[i - 1] * internal->Mwt_E1_incub_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_E2_incub; ++i) {
    internal->Mwt_E2_incub[i - 1] = internal->O_Mwt_E2[i - 1] * internal->Mwt_E2_incub_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_inf1; ++i) {
    internal->Mwt_inf1[i - 1] = internal->O_Mwt_S[i - 1] * internal->Mwt_inf1_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwb_E1; ++i) {
    internal->O_Mwb_E1[i - 1] = Mwb_E1[i - 1] * internal->O_Mwb_E1_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwb_I1; ++i) {
    internal->O_Mwb_I1[i - 1] = Mwb_I1[i - 1] * internal->O_Mwb_I1_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwb_S; ++i) {
    internal->O_Mwb_S[i - 1] = Mwb_S[i - 1] * internal->O_Mwb_S_prob[i - 1];
  }
  for (int i = 1; i <= internal->na; ++i) {
    int j = 1;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_R1 + i - 1 + internal->dim_R1_1 * (j - 1) + internal->dim_R1_12 * (k - 1)] = internal->vcu_noncov[internal->dim_vcu_noncov_1 * (j - 1) + i - 1] * internal->n_R1[internal->dim_n_R1_12 * (k - 1) + internal->dim_n_R1_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->na; ++i) {
    int j = 2;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_R1 + i - 1 + internal->dim_R1_1 * (j - 1) + internal->dim_R1_12 * (k - 1)] = (1 - internal->vcu_noncov[internal->dim_vcu_noncov_1 * 0 + i - 1]) * internal->n_R1[internal->dim_n_R1_12 * (k - 1) + internal->dim_n_R1_1 * 0 + i - 1] + internal->n_R1[internal->dim_n_R1_12 * (k - 1) + internal->dim_n_R1_1 * 1 + i - 1];
    }
  }
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->FOI1[i - 1] = internal->propTransNN * internal->FOI1nn[i - 1] + internal->propTransGlobal * FOI1av + (1 - internal->propTransGlobal - internal->propTransNN) * internal->FOI1p[i - 1] + internal->DT * internal->BG_FOI / (double) internal->YL;
  }
  {
     int i = internal->NP;
     internal->FOI1[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Lwb_mature_prob; ++i) {
    internal->Lwb_mature_prob[i - 1] = fmax(fmin(internal->DT * internal->Epsilon / (double) (internal->DT * internal->Epsilon + internal->L_dr[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Lwt_mature_prob; ++i) {
    internal->Lwt_mature_prob[i - 1] = fmax(fmin(internal->DT * internal->Epsilon / (double) (internal->DT * internal->Epsilon + internal->L_dr[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwb_E1_incub; ++i) {
    internal->Mwb_E1_incub[i - 1] = internal->O_Mwb_E1[i - 1] * internal->Mwb_E1_incub_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwb_inf1; ++i) {
    internal->Mwb_inf1[i - 1] = internal->O_Mwb_S[i - 1] * internal->Mwb_inf1_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Lwb_prob; ++i) {
    internal->O_Lwb_prob[i - 1] = fmax(fmin(internal->DT * internal->Epsilon + internal->L_dr[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Lwt_prob; ++i) {
    internal->O_Lwt_prob[i - 1] = fmax(fmin(internal->DT * internal->Epsilon + internal->L_dr[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwb_I1; ++i) {
    state_next[internal->offset_variable_Mwb_I1 + i - 1] = internal->Mwb_E2_incub[i - 1] + Mwb_I1[i - 1] - internal->O_Mwb_I1[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_E1; ++i) {
    state_next[internal->offset_variable_Mwt_E1 + i - 1] = internal->Mwt_inf1[i - 1] + Mwt_E1[i - 1] - internal->O_Mwt_E1[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_E2; ++i) {
    state_next[internal->offset_variable_Mwt_E2 + i - 1] = internal->Mwt_E1_incub[i - 1] + Mwt_E2[i - 1] - internal->O_Mwt_E2[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_I1; ++i) {
    state_next[internal->offset_variable_Mwt_I1 + i - 1] = internal->Mwt_E2_incub[i - 1] + Mwt_I1[i - 1] - internal->O_Mwt_I1[i - 1];
  }
  for (int i = 1; i <= internal->dim_inf_1_prob_1; ++i) {
    for (int j = 1; j <= internal->dim_inf_1_prob_2; ++j) {
      for (int k = 1; k <= internal->dim_inf_1_prob_3; ++k) {
        internal->inf_1_prob[i - 1 + internal->dim_inf_1_prob_1 * (j - 1) + internal->dim_inf_1_prob_12 * (k - 1)] = fmax(fmin(internal->rho1[j - 1] * internal->FOI1[k - 1] / (double) (internal->rho1[j - 1] * internal->FOI1[k - 1] + internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
      }
    }
  }
  for (int i = 1; i <= internal->dim_O_Lwb; ++i) {
    internal->O_Lwb[i - 1] = Lwb[i - 1] * internal->O_Lwb_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_Lwt; ++i) {
    internal->O_Lwt[i - 1] = Lwt[i - 1] * internal->O_Lwt_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_S_prob_1; ++i) {
    for (int j = 1; j <= internal->dim_O_S_prob_2; ++j) {
      for (int k = 1; k <= internal->dim_O_S_prob_3; ++k) {
        internal->O_S_prob[i - 1 + internal->dim_O_S_prob_1 * (j - 1) + internal->dim_O_S_prob_12 * (k - 1)] = fmax(fmin(internal->rho1[j - 1] * internal->FOI1[k - 1] + internal->agert[i - 1] + internal->deathrt[i - 1], 1), 0);
      }
    }
  }
  for (int i = 1; i <= internal->dim_Mwb_E1; ++i) {
    state_next[internal->offset_variable_Mwb_E1 + i - 1] = internal->Mwb_inf1[i - 1] + Mwb_E1[i - 1] - internal->O_Mwb_E1[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwb_E2; ++i) {
    state_next[internal->offset_variable_Mwb_E2 + i - 1] = internal->Mwb_E1_incub[i - 1] + Mwb_E2[i - 1] - internal->O_Mwb_E2[i - 1];
  }
  for (int i = 1; i <= internal->dim_Lwb_mature; ++i) {
    internal->Lwb_mature[i - 1] = internal->O_Lwb[i - 1] * internal->Lwb_mature_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_Lwt_mature; ++i) {
    internal->Lwt_mature[i - 1] = internal->O_Lwt[i - 1] * internal->Lwt_mature_prob[i - 1];
  }
  for (int i = 1; i <= internal->dim_O_S_1; ++i) {
    for (int j = 1; j <= internal->dim_O_S_2; ++j) {
      for (int k = 1; k <= internal->dim_O_S_3; ++k) {
        internal->O_S[i - 1 + internal->dim_O_S_1 * (j - 1) + internal->dim_O_S_12 * (k - 1)] = S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] * internal->O_S_prob[internal->dim_O_S_prob_12 * (k - 1) + internal->dim_O_S_prob_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_Lwb; ++i) {
    state_next[internal->offset_variable_Lwb + i - 1] = internal->Lwb_birth[i - 1] + Lwb[i - 1] - internal->O_Lwb[i - 1];
  }
  for (int i = 1; i <= internal->dim_Lwt; ++i) {
    state_next[0 + i - 1] = internal->Lwt_birth[i - 1] + Lwt[i - 1] - internal->O_Lwt[i - 1];
  }
  for (int i = 1; i <= internal->dim_inf_1_1; ++i) {
    for (int j = 1; j <= internal->dim_inf_1_2; ++j) {
      for (int k = 1; k <= internal->dim_inf_1_3; ++k) {
        internal->inf_1[i - 1 + internal->dim_inf_1_1 * (j - 1) + internal->dim_inf_1_12 * (k - 1)] = internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1] * internal->inf_1_prob[internal->dim_inf_1_prob_12 * (k - 1) + internal->dim_inf_1_prob_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_Mwb_S; ++i) {
    state_next[internal->offset_variable_Mwb_S + i - 1] = internal->Lwb_mature[i - 1] + internal->Mwb_intro[i - 1] + Mwb_S[i - 1] - internal->O_Mwb_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_S; ++i) {
    state_next[internal->dim_Lwt + i - 1] = internal->Lwt_mature[i - 1] + Mwt_S[i - 1] - internal->O_Mwt_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_age_S_trials_1; ++i) {
    for (int j = 1; j <= internal->dim_age_S_trials_2; ++j) {
      for (int k = 1; k <= internal->dim_age_S_trials_3; ++k) {
        internal->age_S_trials[i - 1 + internal->dim_age_S_trials_1 * (j - 1) + internal->dim_age_S_trials_12 * (k - 1)] = internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1] - internal->inf_1[internal->dim_inf_1_12 * (k - 1) + internal->dim_inf_1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->na; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        internal->n_I1[i - 1 + internal->dim_n_I1_1 * (j - 1) + internal->dim_n_I1_12 * (k - 1)] = trunc(0.5 + internal->vacc_noncov[internal->dim_vacc_noncov_1 * (j - 1) + i - 1] * internal->age_I1[internal->dim_age_I1_12 * (k - 1) + internal->dim_age_I1_1 * (j - 1) + i - 1] + (1 - internal->vacc_noncov[internal->dim_vacc_noncov_1 * (3 - j - 1) + i - 1]) * internal->age_I1[internal->dim_age_I1_12 * (k - 1) + internal->dim_age_I1_1 * (3 - j - 1) + i - 1] + internal->inf_1[internal->dim_inf_1_12 * (k - 1) + internal->dim_inf_1_1 * (j - 1) + i - 1] + I1[internal->dim_I1_12 * (k - 1) + internal->dim_I1_1 * (j - 1) + i - 1] - internal->O_I1[internal->dim_O_I1_12 * (k - 1) + internal->dim_O_I1_1 * (j - 1) + i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_Y1_1; ++i) {
    for (int j = 1; j <= internal->dim_Y1_2; ++j) {
      for (int k = 1; k <= internal->dim_Y1_3; ++k) {
        internal->Y1[i - 1 + internal->dim_Y1_1 * (j - 1) + internal->dim_Y1_12 * (k - 1)] = internal->phi1[j - 1] * internal->inf_1[internal->dim_inf_1_12 * (k - 1) + internal->dim_inf_1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_age_S_1; ++i) {
    for (int j = 1; j <= internal->dim_age_S_2; ++j) {
      for (int k = 1; k <= internal->dim_age_S_3; ++k) {
        internal->age_S[i - 1 + internal->dim_age_S_1 * (j - 1) + internal->dim_age_S_12 * (k - 1)] = internal->age_S_trials[internal->dim_age_S_trials_12 * (k - 1) + internal->dim_age_S_trials_1 * (j - 1) + i - 1] * internal->age_S_prob[i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->na; ++i) {
    int j = 1;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_I1 + i - 1 + internal->dim_I1_1 * (j - 1) + internal->dim_I1_12 * (k - 1)] = internal->vcu_noncov[internal->dim_vcu_noncov_1 * (j - 1) + i - 1] * internal->n_I1[internal->dim_n_I1_12 * (k - 1) + internal->dim_n_I1_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->na; ++i) {
    int j = 2;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_I1 + i - 1 + internal->dim_I1_1 * (j - 1) + internal->dim_I1_12 * (k - 1)] = (1 - internal->vcu_noncov[internal->dim_vcu_noncov_1 * 0 + i - 1]) * internal->n_I1[internal->dim_n_I1_12 * (k - 1) + internal->dim_n_I1_1 * 0 + i - 1] + internal->n_I1[internal->dim_n_I1_12 * (k - 1) + internal->dim_n_I1_1 * 1 + i - 1];
    }
  }
  {
     int i = 1;
     for (int j = 1; j <= internal->NP; ++j) {
       internal->Y1T_sum[i - 1 + internal->dim_Y1T_sum_1 * (j - 1)] = internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 0 + i - 1] + internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 1 + i - 1];
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    for (int j = 1; j <= internal->NP; ++j) {
      internal->Y1T_sum[i - 1 + internal->dim_Y1T_sum_1 * (j - 1)] = internal->Y1T_sum[internal->dim_Y1T_sum_1 * (j - 1) + i - 1 - 1] + internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 0 + i - 1] + internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 1 + i - 1];
    }
  }
  {
     int i = 1;
     int j = 1;
     for (int k = 1; k <= internal->NP; ++k) {
       internal->n_S[i - 1 + internal->dim_n_S_1 * (j - 1) + internal->dim_n_S_12 * (k - 1)] = trunc(0.5 + internal->births[k - 1] + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    int j = 1;
    for (int k = 1; k <= internal->NP; ++k) {
      internal->n_S[i - 1 + internal->dim_n_S_1 * (j - 1) + internal->dim_n_S_12 * (k - 1)] = trunc(0.5 + internal->vacc_noncov[internal->dim_vacc_noncov_1 * (j - 1) + i - 1] * internal->age_S[internal->dim_age_S_12 * (k - 1) + internal->dim_age_S_1 * (j - 1) + i - 1 - 1] + (1 - internal->vacc_noncov[internal->dim_vacc_noncov_1 * (3 - j - 1) + i - 1]) * internal->age_S[internal->dim_age_S_12 * (k - 1) + internal->dim_age_S_1 * (3 - j - 1) + i - 1 - 1] + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
    }
  }
  {
     int i = 1;
     int j = 2;
     for (int k = 1; k <= internal->NP; ++k) {
       internal->n_S[i - 1 + internal->dim_n_S_1 * (j - 1) + internal->dim_n_S_12 * (k - 1)] = trunc(0.5 + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    int j = 2;
    for (int k = 1; k <= internal->NP; ++k) {
      internal->n_S[i - 1 + internal->dim_n_S_1 * (j - 1) + internal->dim_n_S_12 * (k - 1)] = trunc(0.5 + internal->vacc_noncov[internal->dim_vacc_noncov_1 * (j - 1) + i - 1] * internal->age_S[internal->dim_age_S_12 * (k - 1) + internal->dim_age_S_1 * (j - 1) + i - 1 - 1] + (1 - internal->vacc_noncov[internal->dim_vacc_noncov_1 * (3 - j - 1) + i - 1]) * internal->age_S[internal->dim_age_S_12 * (k - 1) + internal->dim_age_S_1 * (3 - j - 1) + i - 1 - 1] + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_Y1T; ++i) {
    internal->Y1T[i - 1] = internal->Y1T_sum[internal->dim_Y1T_sum_1 * (i - 1) + internal->na - 1] / (double) internal->NTp[i - 1];
  }
  for (int i = 1; i <= internal->dim_incubA; ++i) {
    state_next[internal->offset_variable_incubA + i - 1] = incubA[i - 1] + internal->Y1T[i - 1] - internal->DT * 2 * incubA[i - 1] / (double) internal->incub;
  }
  for (int i = 1; i <= internal->na; ++i) {
    int j = 1;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = internal->vcu_noncov[internal->dim_vcu_noncov_1 * (j - 1) + i - 1] * internal->n_S[internal->dim_n_S_12 * (k - 1) + internal->dim_n_S_1 * (j - 1) + i - 1];
    }
  }
  for (int i = 1; i <= internal->na; ++i) {
    int j = 2;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = (1 - internal->vcu_noncov[internal->dim_vcu_noncov_1 * 0 + i - 1]) * internal->n_S[internal->dim_n_S_12 * (k - 1) + internal->dim_n_S_1 * 0 + i - 1] + internal->n_S[internal->dim_n_S_12 * (k - 1) + internal->dim_n_S_1 * 1 + i - 1];
    }
  }
  memcpy(output + internal->offset_output_rho1, internal->rho1, internal->dim_rho1 * sizeof(double));
  output[8] = TIME;
  memcpy(output + internal->offset_output_deathrt, internal->deathrt, internal->dim_deathrt * sizeof(double));
  output[6] = MwtCont;
  for (int i = 1; i <= internal->dim_M_tot; ++i) {
    internal->M_tot[i - 1] = internal->Mwt_tot[i - 1] + internal->Mwb_tot[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwb_propinf; ++i) {
    internal->Mwb_propinf[i - 1] = (Mwb_E1[i - 1] + Mwb_E2[i - 1] + Mwb_I1[i - 1]) / (double) (internal->Mwb_tot[i - 1] + 1e-10);
  }
  for (int i = 1; i <= internal->dim_Mwt_propinf; ++i) {
    internal->Mwt_propinf[i - 1] = (Mwt_E1[i - 1] + Mwt_E2[i - 1] + Mwt_I1[i - 1]) / (double) (internal->Mwt_tot[i - 1] + 1e-10);
  }
  memcpy(output + 9, internal->agert, internal->dim_agert * sizeof(double));
  memcpy(output + internal->offset_output_infectious1, internal->infectious1, internal->dim_infectious1 * sizeof(double));
  memcpy(output + internal->offset_output_Mwb_tot, internal->Mwb_tot, internal->dim_Mwb_tot * sizeof(double));
  memcpy(output + internal->offset_output_Mwt_tot, internal->Mwt_tot, internal->dim_Mwt_tot * sizeof(double));
  {
     int i = 1;
     for (int j = 1; j <= internal->NP; ++j) {
       internal->sum_S[i - 1 + internal->dim_sum_S_1 * (j - 1)] = S[internal->dim_S_12 * (j - 1) + internal->dim_S_1 * 0 + i - 1];
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    for (int j = 1; j <= internal->NP; ++j) {
      internal->sum_S[i - 1 + internal->dim_sum_S_1 * (j - 1)] = S[internal->dim_S_12 * (j - 1) + internal->dim_S_1 * 0 + i - 1] + internal->sum_S[internal->dim_sum_S_1 * (j - 1) + i - 1 - 1];
    }
  }
  for (int i = 1; i <= internal->dim_M_propinf; ++i) {
    internal->M_propinf[i - 1] = ((internal->Mwt_tot[i - 1] + 1e-10) * internal->Mwt_propinf[i - 1] + (internal->Mwb_tot[i - 1] + 1e-10) * internal->Mwb_propinf[i - 1]) / (double) (internal->M_tot[i - 1] + 1e-10);
  }
  double Mwt_FOI1av = (odin_sum1(internal->Mwt_FOI1, 0, internal->dim_Mwt_FOI1) - internal->Mwt_FOI1[internal->NP - 1]) / (double) (internal->NP - 1);
  memcpy(output + internal->offset_output_births, internal->births, internal->dim_births * sizeof(double));
  memcpy(output + internal->offset_output_Mwb_propinf, internal->Mwb_propinf, internal->dim_Mwb_propinf * sizeof(double));
  memcpy(output + internal->offset_output_Mwt_FOI1, internal->Mwt_FOI1, internal->dim_Mwt_FOI1 * sizeof(double));
  memcpy(output + internal->offset_output_Mwt_propinf, internal->Mwt_propinf, internal->dim_Mwt_propinf * sizeof(double));
  memcpy(output + internal->offset_output_Ntotal, internal->Ntotal, internal->dim_Ntotal * sizeof(double));
  for (int i = 1; i <= internal->dim_prop_wb; ++i) {
    internal->prop_wb[i - 1] = internal->Mwb_tot[i - 1] / (double) (internal->M_tot[i - 1] + 1e-10);
  }
  double Deltaav = (odin_sum1(internal->Delta, 0, internal->dim_Delta) - internal->Delta[internal->NP - 1]) / (double) (internal->NP - 1);
  double eipav = (odin_sum1(internal->eip, 0, internal->dim_eip) - internal->eip[internal->NP - 1]) / (double) (internal->NP - 1);
  double Kcav = (odin_sum1(internal->Kc, 0, internal->dim_Kc) - internal->Kc[internal->NP - 1]) / (double) (internal->NP - 1);
  double Mwb_FOI1av = (odin_sum1(internal->Mwb_FOI1, 0, internal->dim_Mwb_FOI1) - internal->Mwb_FOI1[internal->NP - 1]) / (double) (internal->NP - 1);
  memcpy(output + internal->offset_output_Delta, internal->Delta, internal->dim_Delta * sizeof(double));
  memcpy(output + internal->offset_output_eip, internal->eip, internal->dim_eip * sizeof(double));
  memcpy(output + internal->offset_output_Kc, internal->Kc, internal->dim_Kc * sizeof(double));
  memcpy(output + internal->offset_output_Lwb_birth, internal->Lwb_birth, internal->dim_Lwb_birth * sizeof(double));
  memcpy(output + internal->offset_output_Lwt_birth, internal->Lwt_birth, internal->dim_Lwt_birth * sizeof(double));
  memcpy(output + internal->offset_output_M_propinf, internal->M_propinf, internal->dim_M_propinf * sizeof(double));
  output[5] = Mwt_FOI1av;
  memcpy(output + internal->offset_output_O_I1, internal->O_I1, internal->dim_O_I1 * sizeof(double));
  memcpy(output + internal->offset_output_O_R1, internal->O_R1, internal->dim_O_R1 * sizeof(double));
  memcpy(output + internal->offset_output_prop_wb, internal->prop_wb, internal->dim_prop_wb * sizeof(double));
  memcpy(output + internal->offset_output_vacc_noncov, internal->vacc_noncov, internal->dim_vacc_noncov * sizeof(double));
  memcpy(output + internal->offset_output_Wb_introrate, internal->Wb_introrate, internal->dim_Wb_introrate * sizeof(double));
  memcpy(output + internal->offset_output_age_R1, internal->age_R1, internal->dim_age_R1 * sizeof(double));
  output[1] = Deltaav;
  output[3] = eipav;
  output[2] = Kcav;
  output[7] = Mwb_FOI1av;
  memcpy(output + internal->offset_output_Mwb_intro, internal->Mwb_intro, internal->dim_Mwb_intro * sizeof(double));
  memcpy(output + internal->offset_output_NTp, internal->NTp, internal->dim_NTp * sizeof(double));
  memcpy(output + internal->offset_output_recov1, internal->recov1, internal->dim_recov1 * sizeof(double));
  for (int i = 1; i <= internal->dim_prop_Sp; ++i) {
    internal->prop_Sp[i - 1] = internal->sum_S[internal->dim_sum_S_1 * (i - 1) + internal->na - 1] / (double) internal->NTp[i - 1];
  }
  for (int i = 1; i <= internal->dim_R0t_1; ++i) {
    internal->R0t_1[i - 1] = internal->Kappa * internal->Kappa * (internal->Mwt_tot[i - 1] + internal->Wb_relsusc1 * internal->Wb_relinf1 * internal->Mwb_tot[i - 1]) * internal->Beta_hm_1 * internal->inf_per * internal->Beta_mh_1 / (double) (1 + internal->Delta[i - 1] * internal->eip[i - 1]) / (double) internal->Delta[i - 1] / (double) internal->NTp[i - 1];
  }
  for (int i = 1; i <= internal->dim_FOI1Y; ++i) {
    internal->FOI1Y[i - 1] = internal->YL * internal->FOI1p[i - 1] / (double) internal->DT;
  }
  memcpy(output + internal->offset_output_FOI1p, internal->FOI1p, internal->dim_FOI1p * sizeof(double));
  memcpy(output + internal->offset_output_prop_Sp, internal->prop_Sp, internal->dim_prop_Sp * sizeof(double));
  memcpy(output + internal->offset_output_R0t_1, internal->R0t_1, internal->dim_R0t_1 * sizeof(double));
  double R0t_1av = (odin_sum1(internal->R0t_1, 0, internal->dim_R0t_1) - internal->R0t_1[internal->NP - 1]) / (double) (internal->NP - 1);
  memcpy(output + internal->offset_output_age_I1, internal->age_I1, internal->dim_age_I1 * sizeof(double));
  output[0] = FOI1av;
  memcpy(output + internal->offset_output_FOI1nn, internal->FOI1nn, internal->dim_FOI1nn * sizeof(double));
  memcpy(output + internal->offset_output_FOI1Y, internal->FOI1Y, internal->dim_FOI1Y * sizeof(double));
  memcpy(output + internal->offset_output_Mwt_inf1, internal->Mwt_inf1, internal->dim_Mwt_inf1 * sizeof(double));
  output[4] = R0t_1av;
  memcpy(output + internal->offset_output_FOI1, internal->FOI1, internal->dim_FOI1 * sizeof(double));
  memcpy(output + internal->offset_output_Mwb_inf1, internal->Mwb_inf1, internal->dim_Mwb_inf1 * sizeof(double));
  memcpy(output + internal->offset_output_inf_1_prob, internal->inf_1_prob, internal->dim_inf_1_prob * sizeof(double));
  memcpy(output + internal->offset_output_O_S_prob, internal->O_S_prob, internal->dim_O_S_prob * sizeof(double));
  memcpy(output + internal->offset_output_Lwb_mature, internal->Lwb_mature, internal->dim_Lwb_mature * sizeof(double));
  memcpy(output + internal->offset_output_Lwt_mature, internal->Lwt_mature, internal->dim_Lwt_mature * sizeof(double));
  memcpy(output + internal->offset_output_O_S, internal->O_S, internal->dim_O_S * sizeof(double));
  memcpy(output + internal->offset_output_inf_1, internal->inf_1, internal->dim_inf_1 * sizeof(double));
  memcpy(output + internal->offset_output_age_S, internal->age_S, internal->dim_age_S * sizeof(double));
  memcpy(output + internal->offset_output_Y1T, internal->Y1T, internal->dim_Y1T * sizeof(double));
}
void odin_model_determ_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal) {
  odin_model_determ_rhs((odin_model_determ_internal*)internal, step, state, state_next, output);
}
SEXP odin_model_determ_rhs_r(SEXP internal_p, SEXP step, SEXP state) {
  SEXP state_next = PROTECT(allocVector(REALSXP, LENGTH(state)));
  odin_model_determ_internal *internal = odin_model_determ_get_internal(internal_p, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, 9 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_R0t_1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Lwt_mature + internal->dim_Mwt_inf1 + internal->dim_Mwt_propinf + internal->dim_Mwb_tot + internal->dim_Lwb_birth + internal->dim_Lwb_mature + internal->dim_Mwb_inf1 + internal->dim_Mwb_propinf + internal->dim_Wb_introrate + internal->dim_Mwb_intro + internal->dim_prop_wb + internal->dim_M_propinf + internal->dim_vacc_noncov + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1 + internal->dim_inf_1_prob + internal->dim_O_S_prob));
  setAttrib(state_next, install("output"), output_ptr);
  UNPROTECT(1);
  double *output = REAL(output_ptr);
  odin_model_determ_rhs(internal, INTEGER(step)[0], REAL(state), REAL(state_next), output);
  UNPROTECT(1);
  return state_next;
}
odin_model_stoch_internal* odin_model_stoch_get_internal(SEXP internal_p, int closed_error) {
  odin_model_stoch_internal *internal = NULL;
  if (TYPEOF(internal_p) != EXTPTRSXP) {
    Rf_error("Expected an external pointer");
  }
  internal = (odin_model_stoch_internal*) R_ExternalPtrAddr(internal_p);
  if (!internal && closed_error) {
    Rf_error("Pointer has been invalidated");
  }
  return internal;
}
void odin_model_stoch_finalise(SEXP internal_p) {
  odin_model_stoch_internal *internal = odin_model_stoch_get_internal(internal_p, 0);
  if (internal_p) {
    Free(internal->age_I1);
    Free(internal->age_I1_prob);
    Free(internal->age_I1_trials);
    Free(internal->age_R1);
    Free(internal->age_R1_prob);
    Free(internal->age_S);
    Free(internal->age_S_prob);
    Free(internal->age_S_trials);
    Free(internal->agec);
    Free(internal->agert);
    Free(internal->births);
    Free(internal->births_lambda);
    Free(internal->deathrt);
    Free(internal->Delta);
    Free(internal->eip);
    Free(internal->FOI1);
    Free(internal->FOI1nn);
    Free(internal->FOI1p);
    Free(internal->FOI1Y);
    Free(internal->inf_1);
    Free(internal->inf_1_prob);
    Free(internal->infectious1);
    Free(internal->init_I1);
    Free(internal->init_R1);
    Free(internal->init_S);
    Free(internal->initial_I1);
    Free(internal->initial_incubA);
    Free(internal->initial_incubB);
    Free(internal->initial_infectiousA);
    Free(internal->initial_infectiousB);
    Free(internal->initial_Lwt);
    Free(internal->initial_Mwt_E1);
    Free(internal->initial_Mwt_E2);
    Free(internal->initial_Mwt_I1);
    Free(internal->initial_Mwt_S);
    Free(internal->initial_R1);
    Free(internal->initial_S);
    Free(internal->Kc);
    Free(internal->L_deathrt);
    Free(internal->L_dr);
    Free(internal->Lwt_birth);
    Free(internal->Lwt_birth_lambda);
    Free(internal->Lwt_mature);
    Free(internal->Lwt_mature_prob);
    Free(internal->Mwt);
    Free(internal->Mwt_E1_incub);
    Free(internal->Mwt_E1_incub_prob);
    Free(internal->Mwt_E2_incub);
    Free(internal->Mwt_E2_incub_prob);
    Free(internal->Mwt_FOI1);
    Free(internal->Mwt_inf1);
    Free(internal->Mwt_inf1_prob);
    Free(internal->Mwt_tot);
    Free(internal->N_eq);
    Free(internal->Nb);
    Free(internal->nn);
    Free(internal->Ntotal);
    Free(internal->Ntotal_sum);
    Free(internal->NTp);
    Free(internal->O_I1);
    Free(internal->O_I1_prob);
    Free(internal->O_Lwt);
    Free(internal->O_Lwt_prob);
    Free(internal->O_Mwt_E1);
    Free(internal->O_Mwt_E1_prob);
    Free(internal->O_Mwt_E2);
    Free(internal->O_Mwt_E2_prob);
    Free(internal->O_Mwt_I1);
    Free(internal->O_Mwt_I1_prob);
    Free(internal->O_Mwt_S);
    Free(internal->O_Mwt_S_prob);
    Free(internal->O_R1);
    Free(internal->O_R1_prob);
    Free(internal->O_S);
    Free(internal->O_S_prob);
    Free(internal->phi1);
    Free(internal->prop_Sp);
    Free(internal->recov1);
    Free(internal->recov1_prob);
    Free(internal->rho1);
    Free(internal->season_amp);
    Free(internal->season_phase);
    Free(internal->sum_S);
    Free(internal->Y1);
    Free(internal->Y1T);
    Free(internal->Y1T_sum);
    Free(internal);
    R_ClearExternalPtr(internal_p);
  }
}
SEXP odin_model_stoch_create(SEXP user) {
  odin_model_stoch_internal *internal = (odin_model_stoch_internal*) Calloc(1, odin_model_stoch_internal);
  internal->age_I1 = NULL;
  internal->age_I1_prob = NULL;
  internal->age_I1_trials = NULL;
  internal->age_R1 = NULL;
  internal->age_R1_prob = NULL;
  internal->age_S = NULL;
  internal->age_S_prob = NULL;
  internal->age_S_trials = NULL;
  internal->agec = NULL;
  internal->agert = NULL;
  internal->births = NULL;
  internal->births_lambda = NULL;
  internal->deathrt = NULL;
  internal->Delta = NULL;
  internal->eip = NULL;
  internal->FOI1 = NULL;
  internal->FOI1nn = NULL;
  internal->FOI1p = NULL;
  internal->FOI1Y = NULL;
  internal->inf_1 = NULL;
  internal->inf_1_prob = NULL;
  internal->infectious1 = NULL;
  internal->init_I1 = NULL;
  internal->init_R1 = NULL;
  internal->init_S = NULL;
  internal->initial_I1 = NULL;
  internal->initial_incubA = NULL;
  internal->initial_incubB = NULL;
  internal->initial_infectiousA = NULL;
  internal->initial_infectiousB = NULL;
  internal->initial_Lwt = NULL;
  internal->initial_Mwt_E1 = NULL;
  internal->initial_Mwt_E2 = NULL;
  internal->initial_Mwt_I1 = NULL;
  internal->initial_Mwt_S = NULL;
  internal->initial_R1 = NULL;
  internal->initial_S = NULL;
  internal->Kc = NULL;
  internal->L_deathrt = NULL;
  internal->L_dr = NULL;
  internal->Lwt_birth = NULL;
  internal->Lwt_birth_lambda = NULL;
  internal->Lwt_mature = NULL;
  internal->Lwt_mature_prob = NULL;
  internal->Mwt = NULL;
  internal->Mwt_E1_incub = NULL;
  internal->Mwt_E1_incub_prob = NULL;
  internal->Mwt_E2_incub = NULL;
  internal->Mwt_E2_incub_prob = NULL;
  internal->Mwt_FOI1 = NULL;
  internal->Mwt_inf1 = NULL;
  internal->Mwt_inf1_prob = NULL;
  internal->Mwt_tot = NULL;
  internal->N_eq = NULL;
  internal->Nb = NULL;
  internal->nn = NULL;
  internal->Ntotal = NULL;
  internal->Ntotal_sum = NULL;
  internal->NTp = NULL;
  internal->O_I1 = NULL;
  internal->O_I1_prob = NULL;
  internal->O_Lwt = NULL;
  internal->O_Lwt_prob = NULL;
  internal->O_Mwt_E1 = NULL;
  internal->O_Mwt_E1_prob = NULL;
  internal->O_Mwt_E2 = NULL;
  internal->O_Mwt_E2_prob = NULL;
  internal->O_Mwt_I1 = NULL;
  internal->O_Mwt_I1_prob = NULL;
  internal->O_Mwt_S = NULL;
  internal->O_Mwt_S_prob = NULL;
  internal->O_R1 = NULL;
  internal->O_R1_prob = NULL;
  internal->O_S = NULL;
  internal->O_S_prob = NULL;
  internal->phi1 = NULL;
  internal->prop_Sp = NULL;
  internal->recov1 = NULL;
  internal->recov1_prob = NULL;
  internal->rho1 = NULL;
  internal->season_amp = NULL;
  internal->season_phase = NULL;
  internal->sum_S = NULL;
  internal->Y1 = NULL;
  internal->Y1T = NULL;
  internal->Y1T_sum = NULL;
  internal->dim_phi1 = 2;
  internal->dim_rho1 = 2;
  internal->age_per = NA_REAL;
  internal->agec = NULL;
  internal->Beta_hm_1 = NA_REAL;
  internal->Beta_mh_1 = NA_REAL;
  internal->BG_FOI = NA_REAL;
  internal->deathrt = NULL;
  internal->Delta_season = NA_REAL;
  internal->DeltaBase = NA_REAL;
  internal->DT = NA_REAL;
  internal->eip_mean = NA_REAL;
  internal->eip_season = NA_REAL;
  internal->Epsilon = NA_REAL;
  internal->incub = NA_REAL;
  internal->inf_per = NA_REAL;
  internal->init_I1 = NULL;
  internal->init_R1 = NULL;
  internal->init_S = NULL;
  internal->Kappa = NA_REAL;
  internal->Kc_season = NA_REAL;
  internal->Mwt = NULL;
  internal->Mwt_mean = NA_REAL;
  internal->N_eq = NULL;
  internal->na = NA_INTEGER;
  internal->Nb = NULL;
  internal->nn = NULL;
  internal->NP = NA_INTEGER;
  internal->nu = NA_REAL;
  internal->Omega = NA_REAL;
  internal->phi1 = NULL;
  internal->pi = NA_REAL;
  internal->propMwtControl = NA_REAL;
  internal->propTransGlobal = NA_REAL;
  internal->propTransNN = NA_REAL;
  internal->rho1 = NULL;
  internal->Rm = NA_REAL;
  internal->season_amp = NULL;
  internal->season_phase = NULL;
  internal->Sigma = NA_REAL;
  internal->TimeMwtControlOff = NA_REAL;
  internal->TimeMwtControlOn = NA_REAL;
  internal->Wb_cyto = NA_REAL;
  internal->Wb_fF = NA_REAL;
  internal->Wb_mat = NA_REAL;
  internal->Wb_relinf1 = NA_REAL;
  internal->YL = NA_REAL;
  SEXP ptr = PROTECT(R_MakeExternalPtr(internal, R_NilValue, R_NilValue));
  R_RegisterCFinalizer(ptr, odin_model_stoch_finalise);
  UNPROTECT(1);
  return ptr;
}
static odin_model_stoch_internal *odin_model_stoch_internal_ds;
void odin_model_stoch_initmod_desolve(void(* odeparms) (int *, double *)) {
  static DL_FUNC get_desolve_gparms = NULL;
  if (get_desolve_gparms == NULL) {
    get_desolve_gparms =
      R_GetCCallable("deSolve", "get_deSolve_gparms");
  }
  odin_model_stoch_internal_ds = odin_model_stoch_get_internal(get_desolve_gparms(), 1);
}
SEXP odin_model_stoch_contents(SEXP internal_p) {
  odin_model_stoch_internal *internal = odin_model_stoch_get_internal(internal_p, 1);
  SEXP contents = PROTECT(allocVector(VECSXP, 335));
  SEXP age_I1 = PROTECT(allocVector(REALSXP, internal->dim_age_I1));
  memcpy(REAL(age_I1), internal->age_I1, internal->dim_age_I1 * sizeof(double));
  odin_set_dim(age_I1, 3, internal->dim_age_I1_1, internal->dim_age_I1_2, internal->dim_age_I1_3);
  SET_VECTOR_ELT(contents, 0, age_I1);
  SEXP age_I1_prob = PROTECT(allocVector(REALSXP, internal->dim_age_I1_prob));
  memcpy(REAL(age_I1_prob), internal->age_I1_prob, internal->dim_age_I1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 1, age_I1_prob);
  SEXP age_I1_trials = PROTECT(allocVector(REALSXP, internal->dim_age_I1_trials));
  memcpy(REAL(age_I1_trials), internal->age_I1_trials, internal->dim_age_I1_trials * sizeof(double));
  odin_set_dim(age_I1_trials, 3, internal->dim_age_I1_trials_1, internal->dim_age_I1_trials_2, internal->dim_age_I1_trials_3);
  SET_VECTOR_ELT(contents, 2, age_I1_trials);
  SET_VECTOR_ELT(contents, 3, ScalarReal(internal->age_per));
  SEXP age_R1 = PROTECT(allocVector(REALSXP, internal->dim_age_R1));
  memcpy(REAL(age_R1), internal->age_R1, internal->dim_age_R1 * sizeof(double));
  odin_set_dim(age_R1, 3, internal->dim_age_R1_1, internal->dim_age_R1_2, internal->dim_age_R1_3);
  SET_VECTOR_ELT(contents, 4, age_R1);
  SEXP age_R1_prob = PROTECT(allocVector(REALSXP, internal->dim_age_R1_prob));
  memcpy(REAL(age_R1_prob), internal->age_R1_prob, internal->dim_age_R1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 5, age_R1_prob);
  SEXP age_S = PROTECT(allocVector(REALSXP, internal->dim_age_S));
  memcpy(REAL(age_S), internal->age_S, internal->dim_age_S * sizeof(double));
  odin_set_dim(age_S, 3, internal->dim_age_S_1, internal->dim_age_S_2, internal->dim_age_S_3);
  SET_VECTOR_ELT(contents, 6, age_S);
  SEXP age_S_prob = PROTECT(allocVector(REALSXP, internal->dim_age_S_prob));
  memcpy(REAL(age_S_prob), internal->age_S_prob, internal->dim_age_S_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 7, age_S_prob);
  SEXP age_S_trials = PROTECT(allocVector(REALSXP, internal->dim_age_S_trials));
  memcpy(REAL(age_S_trials), internal->age_S_trials, internal->dim_age_S_trials * sizeof(double));
  odin_set_dim(age_S_trials, 3, internal->dim_age_S_trials_1, internal->dim_age_S_trials_2, internal->dim_age_S_trials_3);
  SET_VECTOR_ELT(contents, 8, age_S_trials);
  SEXP agec = PROTECT(allocVector(REALSXP, internal->dim_agec));
  memcpy(REAL(agec), internal->agec, internal->dim_agec * sizeof(double));
  SET_VECTOR_ELT(contents, 9, agec);
  SEXP agert = PROTECT(allocVector(REALSXP, internal->dim_agert));
  memcpy(REAL(agert), internal->agert, internal->dim_agert * sizeof(double));
  SET_VECTOR_ELT(contents, 10, agert);
  SET_VECTOR_ELT(contents, 11, ScalarReal(internal->Beta_hm_1));
  SET_VECTOR_ELT(contents, 12, ScalarReal(internal->Beta_mh_1));
  SET_VECTOR_ELT(contents, 13, ScalarReal(internal->BG_FOI));
  SEXP births = PROTECT(allocVector(REALSXP, internal->dim_births));
  memcpy(REAL(births), internal->births, internal->dim_births * sizeof(double));
  SET_VECTOR_ELT(contents, 14, births);
  SEXP births_lambda = PROTECT(allocVector(REALSXP, internal->dim_births_lambda));
  memcpy(REAL(births_lambda), internal->births_lambda, internal->dim_births_lambda * sizeof(double));
  SET_VECTOR_ELT(contents, 15, births_lambda);
  SEXP deathrt = PROTECT(allocVector(REALSXP, internal->dim_deathrt));
  memcpy(REAL(deathrt), internal->deathrt, internal->dim_deathrt * sizeof(double));
  SET_VECTOR_ELT(contents, 16, deathrt);
  SEXP Delta = PROTECT(allocVector(REALSXP, internal->dim_Delta));
  memcpy(REAL(Delta), internal->Delta, internal->dim_Delta * sizeof(double));
  SET_VECTOR_ELT(contents, 17, Delta);
  SET_VECTOR_ELT(contents, 18, ScalarReal(internal->Delta_season));
  SET_VECTOR_ELT(contents, 19, ScalarReal(internal->DeltaBase));
  SET_VECTOR_ELT(contents, 20, ScalarInteger(internal->dim_age_I1));
  SET_VECTOR_ELT(contents, 21, ScalarInteger(internal->dim_age_I1_1));
  SET_VECTOR_ELT(contents, 22, ScalarInteger(internal->dim_age_I1_12));
  SET_VECTOR_ELT(contents, 23, ScalarInteger(internal->dim_age_I1_2));
  SET_VECTOR_ELT(contents, 24, ScalarInteger(internal->dim_age_I1_3));
  SET_VECTOR_ELT(contents, 25, ScalarInteger(internal->dim_age_I1_prob));
  SET_VECTOR_ELT(contents, 26, ScalarInteger(internal->dim_age_I1_trials));
  SET_VECTOR_ELT(contents, 27, ScalarInteger(internal->dim_age_I1_trials_1));
  SET_VECTOR_ELT(contents, 28, ScalarInteger(internal->dim_age_I1_trials_12));
  SET_VECTOR_ELT(contents, 29, ScalarInteger(internal->dim_age_I1_trials_2));
  SET_VECTOR_ELT(contents, 30, ScalarInteger(internal->dim_age_I1_trials_3));
  SET_VECTOR_ELT(contents, 31, ScalarInteger(internal->dim_age_R1));
  SET_VECTOR_ELT(contents, 32, ScalarInteger(internal->dim_age_R1_1));
  SET_VECTOR_ELT(contents, 33, ScalarInteger(internal->dim_age_R1_12));
  SET_VECTOR_ELT(contents, 34, ScalarInteger(internal->dim_age_R1_2));
  SET_VECTOR_ELT(contents, 35, ScalarInteger(internal->dim_age_R1_3));
  SET_VECTOR_ELT(contents, 36, ScalarInteger(internal->dim_age_R1_prob));
  SET_VECTOR_ELT(contents, 37, ScalarInteger(internal->dim_age_S));
  SET_VECTOR_ELT(contents, 38, ScalarInteger(internal->dim_age_S_1));
  SET_VECTOR_ELT(contents, 39, ScalarInteger(internal->dim_age_S_12));
  SET_VECTOR_ELT(contents, 40, ScalarInteger(internal->dim_age_S_2));
  SET_VECTOR_ELT(contents, 41, ScalarInteger(internal->dim_age_S_3));
  SET_VECTOR_ELT(contents, 42, ScalarInteger(internal->dim_age_S_prob));
  SET_VECTOR_ELT(contents, 43, ScalarInteger(internal->dim_age_S_trials));
  SET_VECTOR_ELT(contents, 44, ScalarInteger(internal->dim_age_S_trials_1));
  SET_VECTOR_ELT(contents, 45, ScalarInteger(internal->dim_age_S_trials_12));
  SET_VECTOR_ELT(contents, 46, ScalarInteger(internal->dim_age_S_trials_2));
  SET_VECTOR_ELT(contents, 47, ScalarInteger(internal->dim_age_S_trials_3));
  SET_VECTOR_ELT(contents, 48, ScalarInteger(internal->dim_agec));
  SET_VECTOR_ELT(contents, 49, ScalarInteger(internal->dim_agert));
  SET_VECTOR_ELT(contents, 50, ScalarInteger(internal->dim_births));
  SET_VECTOR_ELT(contents, 51, ScalarInteger(internal->dim_births_lambda));
  SET_VECTOR_ELT(contents, 52, ScalarInteger(internal->dim_deathrt));
  SET_VECTOR_ELT(contents, 53, ScalarInteger(internal->dim_Delta));
  SET_VECTOR_ELT(contents, 54, ScalarInteger(internal->dim_eip));
  SET_VECTOR_ELT(contents, 55, ScalarInteger(internal->dim_FOI1));
  SET_VECTOR_ELT(contents, 56, ScalarInteger(internal->dim_FOI1nn));
  SET_VECTOR_ELT(contents, 57, ScalarInteger(internal->dim_FOI1p));
  SET_VECTOR_ELT(contents, 58, ScalarInteger(internal->dim_FOI1Y));
  SET_VECTOR_ELT(contents, 59, ScalarInteger(internal->dim_I1));
  SET_VECTOR_ELT(contents, 60, ScalarInteger(internal->dim_I1_1));
  SET_VECTOR_ELT(contents, 61, ScalarInteger(internal->dim_I1_12));
  SET_VECTOR_ELT(contents, 62, ScalarInteger(internal->dim_I1_2));
  SET_VECTOR_ELT(contents, 63, ScalarInteger(internal->dim_I1_3));
  SET_VECTOR_ELT(contents, 64, ScalarInteger(internal->dim_incubA));
  SET_VECTOR_ELT(contents, 65, ScalarInteger(internal->dim_incubB));
  SET_VECTOR_ELT(contents, 66, ScalarInteger(internal->dim_inf_1));
  SET_VECTOR_ELT(contents, 67, ScalarInteger(internal->dim_inf_1_1));
  SET_VECTOR_ELT(contents, 68, ScalarInteger(internal->dim_inf_1_12));
  SET_VECTOR_ELT(contents, 69, ScalarInteger(internal->dim_inf_1_2));
  SET_VECTOR_ELT(contents, 70, ScalarInteger(internal->dim_inf_1_3));
  SET_VECTOR_ELT(contents, 71, ScalarInteger(internal->dim_inf_1_prob));
  SET_VECTOR_ELT(contents, 72, ScalarInteger(internal->dim_inf_1_prob_1));
  SET_VECTOR_ELT(contents, 73, ScalarInteger(internal->dim_inf_1_prob_12));
  SET_VECTOR_ELT(contents, 74, ScalarInteger(internal->dim_inf_1_prob_2));
  SET_VECTOR_ELT(contents, 75, ScalarInteger(internal->dim_inf_1_prob_3));
  SET_VECTOR_ELT(contents, 76, ScalarInteger(internal->dim_infectious1));
  SET_VECTOR_ELT(contents, 77, ScalarInteger(internal->dim_infectiousA));
  SET_VECTOR_ELT(contents, 78, ScalarInteger(internal->dim_infectiousB));
  SET_VECTOR_ELT(contents, 79, ScalarInteger(internal->dim_init_I1));
  SET_VECTOR_ELT(contents, 80, ScalarInteger(internal->dim_init_I1_1));
  SET_VECTOR_ELT(contents, 81, ScalarInteger(internal->dim_init_I1_12));
  SET_VECTOR_ELT(contents, 82, ScalarInteger(internal->dim_init_I1_2));
  SET_VECTOR_ELT(contents, 83, ScalarInteger(internal->dim_init_I1_3));
  SET_VECTOR_ELT(contents, 84, ScalarInteger(internal->dim_init_R1));
  SET_VECTOR_ELT(contents, 85, ScalarInteger(internal->dim_init_R1_1));
  SET_VECTOR_ELT(contents, 86, ScalarInteger(internal->dim_init_R1_12));
  SET_VECTOR_ELT(contents, 87, ScalarInteger(internal->dim_init_R1_2));
  SET_VECTOR_ELT(contents, 88, ScalarInteger(internal->dim_init_R1_3));
  SET_VECTOR_ELT(contents, 89, ScalarInteger(internal->dim_init_S));
  SET_VECTOR_ELT(contents, 90, ScalarInteger(internal->dim_init_S_1));
  SET_VECTOR_ELT(contents, 91, ScalarInteger(internal->dim_init_S_12));
  SET_VECTOR_ELT(contents, 92, ScalarInteger(internal->dim_init_S_2));
  SET_VECTOR_ELT(contents, 93, ScalarInteger(internal->dim_init_S_3));
  SET_VECTOR_ELT(contents, 94, ScalarInteger(internal->dim_Kc));
  SET_VECTOR_ELT(contents, 95, ScalarInteger(internal->dim_L_deathrt));
  SET_VECTOR_ELT(contents, 96, ScalarInteger(internal->dim_L_dr));
  SET_VECTOR_ELT(contents, 97, ScalarInteger(internal->dim_Lwt));
  SET_VECTOR_ELT(contents, 98, ScalarInteger(internal->dim_Lwt_birth));
  SET_VECTOR_ELT(contents, 99, ScalarInteger(internal->dim_Lwt_birth_lambda));
  SET_VECTOR_ELT(contents, 100, ScalarInteger(internal->dim_Lwt_mature));
  SET_VECTOR_ELT(contents, 101, ScalarInteger(internal->dim_Lwt_mature_prob));
  SET_VECTOR_ELT(contents, 102, ScalarInteger(internal->dim_Mwt));
  SET_VECTOR_ELT(contents, 103, ScalarInteger(internal->dim_Mwt_E1));
  SET_VECTOR_ELT(contents, 104, ScalarInteger(internal->dim_Mwt_E1_incub));
  SET_VECTOR_ELT(contents, 105, ScalarInteger(internal->dim_Mwt_E1_incub_prob));
  SET_VECTOR_ELT(contents, 106, ScalarInteger(internal->dim_Mwt_E2));
  SET_VECTOR_ELT(contents, 107, ScalarInteger(internal->dim_Mwt_E2_incub));
  SET_VECTOR_ELT(contents, 108, ScalarInteger(internal->dim_Mwt_E2_incub_prob));
  SET_VECTOR_ELT(contents, 109, ScalarInteger(internal->dim_Mwt_FOI1));
  SET_VECTOR_ELT(contents, 110, ScalarInteger(internal->dim_Mwt_I1));
  SET_VECTOR_ELT(contents, 111, ScalarInteger(internal->dim_Mwt_inf1));
  SET_VECTOR_ELT(contents, 112, ScalarInteger(internal->dim_Mwt_inf1_prob));
  SET_VECTOR_ELT(contents, 113, ScalarInteger(internal->dim_Mwt_S));
  SET_VECTOR_ELT(contents, 114, ScalarInteger(internal->dim_Mwt_tot));
  SET_VECTOR_ELT(contents, 115, ScalarInteger(internal->dim_N_eq));
  SET_VECTOR_ELT(contents, 116, ScalarInteger(internal->dim_Nb));
  SET_VECTOR_ELT(contents, 117, ScalarInteger(internal->dim_nn));
  SET_VECTOR_ELT(contents, 118, ScalarInteger(internal->dim_nn_1));
  SET_VECTOR_ELT(contents, 119, ScalarInteger(internal->dim_nn_2));
  SET_VECTOR_ELT(contents, 120, ScalarInteger(internal->dim_Ntotal));
  SET_VECTOR_ELT(contents, 121, ScalarInteger(internal->dim_Ntotal_1));
  SET_VECTOR_ELT(contents, 122, ScalarInteger(internal->dim_Ntotal_12));
  SET_VECTOR_ELT(contents, 123, ScalarInteger(internal->dim_Ntotal_2));
  SET_VECTOR_ELT(contents, 124, ScalarInteger(internal->dim_Ntotal_3));
  SET_VECTOR_ELT(contents, 125, ScalarInteger(internal->dim_Ntotal_sum));
  SET_VECTOR_ELT(contents, 126, ScalarInteger(internal->dim_Ntotal_sum_1));
  SET_VECTOR_ELT(contents, 127, ScalarInteger(internal->dim_Ntotal_sum_2));
  SET_VECTOR_ELT(contents, 128, ScalarInteger(internal->dim_NTp));
  SET_VECTOR_ELT(contents, 129, ScalarInteger(internal->dim_O_I1));
  SET_VECTOR_ELT(contents, 130, ScalarInteger(internal->dim_O_I1_1));
  SET_VECTOR_ELT(contents, 131, ScalarInteger(internal->dim_O_I1_12));
  SET_VECTOR_ELT(contents, 132, ScalarInteger(internal->dim_O_I1_2));
  SET_VECTOR_ELT(contents, 133, ScalarInteger(internal->dim_O_I1_3));
  SET_VECTOR_ELT(contents, 134, ScalarInteger(internal->dim_O_I1_prob));
  SET_VECTOR_ELT(contents, 135, ScalarInteger(internal->dim_O_Lwt));
  SET_VECTOR_ELT(contents, 136, ScalarInteger(internal->dim_O_Lwt_prob));
  SET_VECTOR_ELT(contents, 137, ScalarInteger(internal->dim_O_Mwt_E1));
  SET_VECTOR_ELT(contents, 138, ScalarInteger(internal->dim_O_Mwt_E1_prob));
  SET_VECTOR_ELT(contents, 139, ScalarInteger(internal->dim_O_Mwt_E2));
  SET_VECTOR_ELT(contents, 140, ScalarInteger(internal->dim_O_Mwt_E2_prob));
  SET_VECTOR_ELT(contents, 141, ScalarInteger(internal->dim_O_Mwt_I1));
  SET_VECTOR_ELT(contents, 142, ScalarInteger(internal->dim_O_Mwt_I1_prob));
  SET_VECTOR_ELT(contents, 143, ScalarInteger(internal->dim_O_Mwt_S));
  SET_VECTOR_ELT(contents, 144, ScalarInteger(internal->dim_O_Mwt_S_prob));
  SET_VECTOR_ELT(contents, 145, ScalarInteger(internal->dim_O_R1));
  SET_VECTOR_ELT(contents, 146, ScalarInteger(internal->dim_O_R1_1));
  SET_VECTOR_ELT(contents, 147, ScalarInteger(internal->dim_O_R1_12));
  SET_VECTOR_ELT(contents, 148, ScalarInteger(internal->dim_O_R1_2));
  SET_VECTOR_ELT(contents, 149, ScalarInteger(internal->dim_O_R1_3));
  SET_VECTOR_ELT(contents, 150, ScalarInteger(internal->dim_O_R1_prob));
  SET_VECTOR_ELT(contents, 151, ScalarInteger(internal->dim_O_S));
  SET_VECTOR_ELT(contents, 152, ScalarInteger(internal->dim_O_S_1));
  SET_VECTOR_ELT(contents, 153, ScalarInteger(internal->dim_O_S_12));
  SET_VECTOR_ELT(contents, 154, ScalarInteger(internal->dim_O_S_2));
  SET_VECTOR_ELT(contents, 155, ScalarInteger(internal->dim_O_S_3));
  SET_VECTOR_ELT(contents, 156, ScalarInteger(internal->dim_O_S_prob));
  SET_VECTOR_ELT(contents, 157, ScalarInteger(internal->dim_O_S_prob_1));
  SET_VECTOR_ELT(contents, 158, ScalarInteger(internal->dim_O_S_prob_12));
  SET_VECTOR_ELT(contents, 159, ScalarInteger(internal->dim_O_S_prob_2));
  SET_VECTOR_ELT(contents, 160, ScalarInteger(internal->dim_O_S_prob_3));
  SET_VECTOR_ELT(contents, 161, ScalarInteger(internal->dim_phi1));
  SET_VECTOR_ELT(contents, 162, ScalarInteger(internal->dim_prop_Sp));
  SET_VECTOR_ELT(contents, 163, ScalarInteger(internal->dim_R1));
  SET_VECTOR_ELT(contents, 164, ScalarInteger(internal->dim_R1_1));
  SET_VECTOR_ELT(contents, 165, ScalarInteger(internal->dim_R1_12));
  SET_VECTOR_ELT(contents, 166, ScalarInteger(internal->dim_R1_2));
  SET_VECTOR_ELT(contents, 167, ScalarInteger(internal->dim_R1_3));
  SET_VECTOR_ELT(contents, 168, ScalarInteger(internal->dim_recov1));
  SET_VECTOR_ELT(contents, 169, ScalarInteger(internal->dim_recov1_1));
  SET_VECTOR_ELT(contents, 170, ScalarInteger(internal->dim_recov1_12));
  SET_VECTOR_ELT(contents, 171, ScalarInteger(internal->dim_recov1_2));
  SET_VECTOR_ELT(contents, 172, ScalarInteger(internal->dim_recov1_3));
  SET_VECTOR_ELT(contents, 173, ScalarInteger(internal->dim_recov1_prob));
  SET_VECTOR_ELT(contents, 174, ScalarInteger(internal->dim_rho1));
  SET_VECTOR_ELT(contents, 175, ScalarInteger(internal->dim_S));
  SET_VECTOR_ELT(contents, 176, ScalarInteger(internal->dim_S_1));
  SET_VECTOR_ELT(contents, 177, ScalarInteger(internal->dim_S_12));
  SET_VECTOR_ELT(contents, 178, ScalarInteger(internal->dim_S_2));
  SET_VECTOR_ELT(contents, 179, ScalarInteger(internal->dim_S_3));
  SET_VECTOR_ELT(contents, 180, ScalarInteger(internal->dim_season_amp));
  SET_VECTOR_ELT(contents, 181, ScalarInteger(internal->dim_season_phase));
  SET_VECTOR_ELT(contents, 182, ScalarInteger(internal->dim_sum_S));
  SET_VECTOR_ELT(contents, 183, ScalarInteger(internal->dim_sum_S_1));
  SET_VECTOR_ELT(contents, 184, ScalarInteger(internal->dim_sum_S_2));
  SET_VECTOR_ELT(contents, 185, ScalarInteger(internal->dim_Y1));
  SET_VECTOR_ELT(contents, 186, ScalarInteger(internal->dim_Y1_1));
  SET_VECTOR_ELT(contents, 187, ScalarInteger(internal->dim_Y1_12));
  SET_VECTOR_ELT(contents, 188, ScalarInteger(internal->dim_Y1_2));
  SET_VECTOR_ELT(contents, 189, ScalarInteger(internal->dim_Y1_3));
  SET_VECTOR_ELT(contents, 190, ScalarInteger(internal->dim_Y1T));
  SET_VECTOR_ELT(contents, 191, ScalarInteger(internal->dim_Y1T_sum));
  SET_VECTOR_ELT(contents, 192, ScalarInteger(internal->dim_Y1T_sum_1));
  SET_VECTOR_ELT(contents, 193, ScalarInteger(internal->dim_Y1T_sum_2));
  SET_VECTOR_ELT(contents, 194, ScalarReal(internal->DT));
  SEXP eip = PROTECT(allocVector(REALSXP, internal->dim_eip));
  memcpy(REAL(eip), internal->eip, internal->dim_eip * sizeof(double));
  SET_VECTOR_ELT(contents, 195, eip);
  SET_VECTOR_ELT(contents, 196, ScalarReal(internal->eip_mean));
  SET_VECTOR_ELT(contents, 197, ScalarReal(internal->eip_season));
  SET_VECTOR_ELT(contents, 198, ScalarReal(internal->Epsilon));
  SEXP FOI1 = PROTECT(allocVector(REALSXP, internal->dim_FOI1));
  memcpy(REAL(FOI1), internal->FOI1, internal->dim_FOI1 * sizeof(double));
  SET_VECTOR_ELT(contents, 199, FOI1);
  SEXP FOI1nn = PROTECT(allocVector(REALSXP, internal->dim_FOI1nn));
  memcpy(REAL(FOI1nn), internal->FOI1nn, internal->dim_FOI1nn * sizeof(double));
  SET_VECTOR_ELT(contents, 200, FOI1nn);
  SEXP FOI1p = PROTECT(allocVector(REALSXP, internal->dim_FOI1p));
  memcpy(REAL(FOI1p), internal->FOI1p, internal->dim_FOI1p * sizeof(double));
  SET_VECTOR_ELT(contents, 201, FOI1p);
  SEXP FOI1Y = PROTECT(allocVector(REALSXP, internal->dim_FOI1Y));
  memcpy(REAL(FOI1Y), internal->FOI1Y, internal->dim_FOI1Y * sizeof(double));
  SET_VECTOR_ELT(contents, 202, FOI1Y);
  SET_VECTOR_ELT(contents, 203, ScalarReal(internal->incub));
  SEXP inf_1 = PROTECT(allocVector(REALSXP, internal->dim_inf_1));
  memcpy(REAL(inf_1), internal->inf_1, internal->dim_inf_1 * sizeof(double));
  odin_set_dim(inf_1, 3, internal->dim_inf_1_1, internal->dim_inf_1_2, internal->dim_inf_1_3);
  SET_VECTOR_ELT(contents, 204, inf_1);
  SEXP inf_1_prob = PROTECT(allocVector(REALSXP, internal->dim_inf_1_prob));
  memcpy(REAL(inf_1_prob), internal->inf_1_prob, internal->dim_inf_1_prob * sizeof(double));
  odin_set_dim(inf_1_prob, 3, internal->dim_inf_1_prob_1, internal->dim_inf_1_prob_2, internal->dim_inf_1_prob_3);
  SET_VECTOR_ELT(contents, 205, inf_1_prob);
  SET_VECTOR_ELT(contents, 206, ScalarReal(internal->inf_per));
  SEXP infectious1 = PROTECT(allocVector(REALSXP, internal->dim_infectious1));
  memcpy(REAL(infectious1), internal->infectious1, internal->dim_infectious1 * sizeof(double));
  SET_VECTOR_ELT(contents, 207, infectious1);
  SEXP init_I1 = PROTECT(allocVector(REALSXP, internal->dim_init_I1));
  memcpy(REAL(init_I1), internal->init_I1, internal->dim_init_I1 * sizeof(double));
  odin_set_dim(init_I1, 3, internal->dim_init_I1_1, internal->dim_init_I1_2, internal->dim_init_I1_3);
  SET_VECTOR_ELT(contents, 208, init_I1);
  SEXP init_R1 = PROTECT(allocVector(REALSXP, internal->dim_init_R1));
  memcpy(REAL(init_R1), internal->init_R1, internal->dim_init_R1 * sizeof(double));
  odin_set_dim(init_R1, 3, internal->dim_init_R1_1, internal->dim_init_R1_2, internal->dim_init_R1_3);
  SET_VECTOR_ELT(contents, 209, init_R1);
  SEXP init_S = PROTECT(allocVector(REALSXP, internal->dim_init_S));
  memcpy(REAL(init_S), internal->init_S, internal->dim_init_S * sizeof(double));
  odin_set_dim(init_S, 3, internal->dim_init_S_1, internal->dim_init_S_2, internal->dim_init_S_3);
  SET_VECTOR_ELT(contents, 210, init_S);
  SEXP initial_I1 = PROTECT(allocVector(REALSXP, internal->dim_I1));
  memcpy(REAL(initial_I1), internal->initial_I1, internal->dim_I1 * sizeof(double));
  odin_set_dim(initial_I1, 3, internal->dim_I1_1, internal->dim_I1_2, internal->dim_I1_3);
  SET_VECTOR_ELT(contents, 211, initial_I1);
  SEXP initial_incubA = PROTECT(allocVector(REALSXP, internal->dim_incubA));
  memcpy(REAL(initial_incubA), internal->initial_incubA, internal->dim_incubA * sizeof(double));
  SET_VECTOR_ELT(contents, 212, initial_incubA);
  SEXP initial_incubB = PROTECT(allocVector(REALSXP, internal->dim_incubB));
  memcpy(REAL(initial_incubB), internal->initial_incubB, internal->dim_incubB * sizeof(double));
  SET_VECTOR_ELT(contents, 213, initial_incubB);
  SEXP initial_infectiousA = PROTECT(allocVector(REALSXP, internal->dim_infectiousA));
  memcpy(REAL(initial_infectiousA), internal->initial_infectiousA, internal->dim_infectiousA * sizeof(double));
  SET_VECTOR_ELT(contents, 214, initial_infectiousA);
  SEXP initial_infectiousB = PROTECT(allocVector(REALSXP, internal->dim_infectiousB));
  memcpy(REAL(initial_infectiousB), internal->initial_infectiousB, internal->dim_infectiousB * sizeof(double));
  SET_VECTOR_ELT(contents, 215, initial_infectiousB);
  SEXP initial_Lwt = PROTECT(allocVector(REALSXP, internal->dim_Lwt));
  memcpy(REAL(initial_Lwt), internal->initial_Lwt, internal->dim_Lwt * sizeof(double));
  SET_VECTOR_ELT(contents, 216, initial_Lwt);
  SEXP initial_Mwt_E1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E1));
  memcpy(REAL(initial_Mwt_E1), internal->initial_Mwt_E1, internal->dim_Mwt_E1 * sizeof(double));
  SET_VECTOR_ELT(contents, 217, initial_Mwt_E1);
  SEXP initial_Mwt_E2 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E2));
  memcpy(REAL(initial_Mwt_E2), internal->initial_Mwt_E2, internal->dim_Mwt_E2 * sizeof(double));
  SET_VECTOR_ELT(contents, 218, initial_Mwt_E2);
  SEXP initial_Mwt_I1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_I1));
  memcpy(REAL(initial_Mwt_I1), internal->initial_Mwt_I1, internal->dim_Mwt_I1 * sizeof(double));
  SET_VECTOR_ELT(contents, 219, initial_Mwt_I1);
  SEXP initial_Mwt_S = PROTECT(allocVector(REALSXP, internal->dim_Mwt_S));
  memcpy(REAL(initial_Mwt_S), internal->initial_Mwt_S, internal->dim_Mwt_S * sizeof(double));
  SET_VECTOR_ELT(contents, 220, initial_Mwt_S);
  SEXP initial_R1 = PROTECT(allocVector(REALSXP, internal->dim_R1));
  memcpy(REAL(initial_R1), internal->initial_R1, internal->dim_R1 * sizeof(double));
  odin_set_dim(initial_R1, 3, internal->dim_R1_1, internal->dim_R1_2, internal->dim_R1_3);
  SET_VECTOR_ELT(contents, 221, initial_R1);
  SEXP initial_S = PROTECT(allocVector(REALSXP, internal->dim_S));
  memcpy(REAL(initial_S), internal->initial_S, internal->dim_S * sizeof(double));
  odin_set_dim(initial_S, 3, internal->dim_S_1, internal->dim_S_2, internal->dim_S_3);
  SET_VECTOR_ELT(contents, 222, initial_S);
  SET_VECTOR_ELT(contents, 223, ScalarReal(internal->Kappa));
  SEXP Kc = PROTECT(allocVector(REALSXP, internal->dim_Kc));
  memcpy(REAL(Kc), internal->Kc, internal->dim_Kc * sizeof(double));
  SET_VECTOR_ELT(contents, 224, Kc);
  SET_VECTOR_ELT(contents, 225, ScalarReal(internal->Kc_season));
  SEXP L_deathrt = PROTECT(allocVector(REALSXP, internal->dim_L_deathrt));
  memcpy(REAL(L_deathrt), internal->L_deathrt, internal->dim_L_deathrt * sizeof(double));
  SET_VECTOR_ELT(contents, 226, L_deathrt);
  SEXP L_dr = PROTECT(allocVector(REALSXP, internal->dim_L_dr));
  memcpy(REAL(L_dr), internal->L_dr, internal->dim_L_dr * sizeof(double));
  SET_VECTOR_ELT(contents, 227, L_dr);
  SEXP Lwt_birth = PROTECT(allocVector(REALSXP, internal->dim_Lwt_birth));
  memcpy(REAL(Lwt_birth), internal->Lwt_birth, internal->dim_Lwt_birth * sizeof(double));
  SET_VECTOR_ELT(contents, 228, Lwt_birth);
  SEXP Lwt_birth_lambda = PROTECT(allocVector(REALSXP, internal->dim_Lwt_birth_lambda));
  memcpy(REAL(Lwt_birth_lambda), internal->Lwt_birth_lambda, internal->dim_Lwt_birth_lambda * sizeof(double));
  SET_VECTOR_ELT(contents, 229, Lwt_birth_lambda);
  SEXP Lwt_mature = PROTECT(allocVector(REALSXP, internal->dim_Lwt_mature));
  memcpy(REAL(Lwt_mature), internal->Lwt_mature, internal->dim_Lwt_mature * sizeof(double));
  SET_VECTOR_ELT(contents, 230, Lwt_mature);
  SEXP Lwt_mature_prob = PROTECT(allocVector(REALSXP, internal->dim_Lwt_mature_prob));
  memcpy(REAL(Lwt_mature_prob), internal->Lwt_mature_prob, internal->dim_Lwt_mature_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 231, Lwt_mature_prob);
  SEXP Mwt = PROTECT(allocVector(REALSXP, internal->dim_Mwt));
  memcpy(REAL(Mwt), internal->Mwt, internal->dim_Mwt * sizeof(double));
  SET_VECTOR_ELT(contents, 232, Mwt);
  SEXP Mwt_E1_incub = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E1_incub));
  memcpy(REAL(Mwt_E1_incub), internal->Mwt_E1_incub, internal->dim_Mwt_E1_incub * sizeof(double));
  SET_VECTOR_ELT(contents, 233, Mwt_E1_incub);
  SEXP Mwt_E1_incub_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E1_incub_prob));
  memcpy(REAL(Mwt_E1_incub_prob), internal->Mwt_E1_incub_prob, internal->dim_Mwt_E1_incub_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 234, Mwt_E1_incub_prob);
  SEXP Mwt_E2_incub = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E2_incub));
  memcpy(REAL(Mwt_E2_incub), internal->Mwt_E2_incub, internal->dim_Mwt_E2_incub * sizeof(double));
  SET_VECTOR_ELT(contents, 235, Mwt_E2_incub);
  SEXP Mwt_E2_incub_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwt_E2_incub_prob));
  memcpy(REAL(Mwt_E2_incub_prob), internal->Mwt_E2_incub_prob, internal->dim_Mwt_E2_incub_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 236, Mwt_E2_incub_prob);
  SEXP Mwt_FOI1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_FOI1));
  memcpy(REAL(Mwt_FOI1), internal->Mwt_FOI1, internal->dim_Mwt_FOI1 * sizeof(double));
  SET_VECTOR_ELT(contents, 237, Mwt_FOI1);
  SEXP Mwt_inf1 = PROTECT(allocVector(REALSXP, internal->dim_Mwt_inf1));
  memcpy(REAL(Mwt_inf1), internal->Mwt_inf1, internal->dim_Mwt_inf1 * sizeof(double));
  SET_VECTOR_ELT(contents, 238, Mwt_inf1);
  SEXP Mwt_inf1_prob = PROTECT(allocVector(REALSXP, internal->dim_Mwt_inf1_prob));
  memcpy(REAL(Mwt_inf1_prob), internal->Mwt_inf1_prob, internal->dim_Mwt_inf1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 239, Mwt_inf1_prob);
  SET_VECTOR_ELT(contents, 240, ScalarReal(internal->Mwt_mean));
  SEXP Mwt_tot = PROTECT(allocVector(REALSXP, internal->dim_Mwt_tot));
  memcpy(REAL(Mwt_tot), internal->Mwt_tot, internal->dim_Mwt_tot * sizeof(double));
  SET_VECTOR_ELT(contents, 241, Mwt_tot);
  SEXP N_eq = PROTECT(allocVector(REALSXP, internal->dim_N_eq));
  memcpy(REAL(N_eq), internal->N_eq, internal->dim_N_eq * sizeof(double));
  SET_VECTOR_ELT(contents, 242, N_eq);
  SET_VECTOR_ELT(contents, 243, ScalarInteger(internal->na));
  SEXP Nb = PROTECT(allocVector(REALSXP, internal->dim_Nb));
  memcpy(REAL(Nb), internal->Nb, internal->dim_Nb * sizeof(double));
  SET_VECTOR_ELT(contents, 244, Nb);
  SEXP nn = PROTECT(allocVector(INTSXP, internal->dim_nn));
  memcpy(INTEGER(nn), internal->nn, internal->dim_nn * sizeof(int));
  odin_set_dim(nn, 2, internal->dim_nn_1, internal->dim_nn_2);
  SET_VECTOR_ELT(contents, 245, nn);
  SET_VECTOR_ELT(contents, 246, ScalarInteger(internal->NP));
  SEXP Ntotal = PROTECT(allocVector(REALSXP, internal->dim_Ntotal));
  memcpy(REAL(Ntotal), internal->Ntotal, internal->dim_Ntotal * sizeof(double));
  odin_set_dim(Ntotal, 3, internal->dim_Ntotal_1, internal->dim_Ntotal_2, internal->dim_Ntotal_3);
  SET_VECTOR_ELT(contents, 247, Ntotal);
  SEXP Ntotal_sum = PROTECT(allocVector(REALSXP, internal->dim_Ntotal_sum));
  memcpy(REAL(Ntotal_sum), internal->Ntotal_sum, internal->dim_Ntotal_sum * sizeof(double));
  odin_set_dim(Ntotal_sum, 2, internal->dim_Ntotal_sum_1, internal->dim_Ntotal_sum_2);
  SET_VECTOR_ELT(contents, 248, Ntotal_sum);
  SEXP NTp = PROTECT(allocVector(REALSXP, internal->dim_NTp));
  memcpy(REAL(NTp), internal->NTp, internal->dim_NTp * sizeof(double));
  SET_VECTOR_ELT(contents, 249, NTp);
  SET_VECTOR_ELT(contents, 250, ScalarReal(internal->nu));
  SEXP O_I1 = PROTECT(allocVector(REALSXP, internal->dim_O_I1));
  memcpy(REAL(O_I1), internal->O_I1, internal->dim_O_I1 * sizeof(double));
  odin_set_dim(O_I1, 3, internal->dim_O_I1_1, internal->dim_O_I1_2, internal->dim_O_I1_3);
  SET_VECTOR_ELT(contents, 251, O_I1);
  SEXP O_I1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_I1_prob));
  memcpy(REAL(O_I1_prob), internal->O_I1_prob, internal->dim_O_I1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 252, O_I1_prob);
  SEXP O_Lwt = PROTECT(allocVector(REALSXP, internal->dim_O_Lwt));
  memcpy(REAL(O_Lwt), internal->O_Lwt, internal->dim_O_Lwt * sizeof(double));
  SET_VECTOR_ELT(contents, 253, O_Lwt);
  SEXP O_Lwt_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Lwt_prob));
  memcpy(REAL(O_Lwt_prob), internal->O_Lwt_prob, internal->dim_O_Lwt_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 254, O_Lwt_prob);
  SEXP O_Mwt_E1 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E1));
  memcpy(REAL(O_Mwt_E1), internal->O_Mwt_E1, internal->dim_O_Mwt_E1 * sizeof(double));
  SET_VECTOR_ELT(contents, 255, O_Mwt_E1);
  SEXP O_Mwt_E1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E1_prob));
  memcpy(REAL(O_Mwt_E1_prob), internal->O_Mwt_E1_prob, internal->dim_O_Mwt_E1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 256, O_Mwt_E1_prob);
  SEXP O_Mwt_E2 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E2));
  memcpy(REAL(O_Mwt_E2), internal->O_Mwt_E2, internal->dim_O_Mwt_E2 * sizeof(double));
  SET_VECTOR_ELT(contents, 257, O_Mwt_E2);
  SEXP O_Mwt_E2_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_E2_prob));
  memcpy(REAL(O_Mwt_E2_prob), internal->O_Mwt_E2_prob, internal->dim_O_Mwt_E2_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 258, O_Mwt_E2_prob);
  SEXP O_Mwt_I1 = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_I1));
  memcpy(REAL(O_Mwt_I1), internal->O_Mwt_I1, internal->dim_O_Mwt_I1 * sizeof(double));
  SET_VECTOR_ELT(contents, 259, O_Mwt_I1);
  SEXP O_Mwt_I1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_I1_prob));
  memcpy(REAL(O_Mwt_I1_prob), internal->O_Mwt_I1_prob, internal->dim_O_Mwt_I1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 260, O_Mwt_I1_prob);
  SEXP O_Mwt_S = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_S));
  memcpy(REAL(O_Mwt_S), internal->O_Mwt_S, internal->dim_O_Mwt_S * sizeof(double));
  SET_VECTOR_ELT(contents, 261, O_Mwt_S);
  SEXP O_Mwt_S_prob = PROTECT(allocVector(REALSXP, internal->dim_O_Mwt_S_prob));
  memcpy(REAL(O_Mwt_S_prob), internal->O_Mwt_S_prob, internal->dim_O_Mwt_S_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 262, O_Mwt_S_prob);
  SEXP O_R1 = PROTECT(allocVector(REALSXP, internal->dim_O_R1));
  memcpy(REAL(O_R1), internal->O_R1, internal->dim_O_R1 * sizeof(double));
  odin_set_dim(O_R1, 3, internal->dim_O_R1_1, internal->dim_O_R1_2, internal->dim_O_R1_3);
  SET_VECTOR_ELT(contents, 263, O_R1);
  SEXP O_R1_prob = PROTECT(allocVector(REALSXP, internal->dim_O_R1_prob));
  memcpy(REAL(O_R1_prob), internal->O_R1_prob, internal->dim_O_R1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 264, O_R1_prob);
  SEXP O_S = PROTECT(allocVector(REALSXP, internal->dim_O_S));
  memcpy(REAL(O_S), internal->O_S, internal->dim_O_S * sizeof(double));
  odin_set_dim(O_S, 3, internal->dim_O_S_1, internal->dim_O_S_2, internal->dim_O_S_3);
  SET_VECTOR_ELT(contents, 265, O_S);
  SEXP O_S_prob = PROTECT(allocVector(REALSXP, internal->dim_O_S_prob));
  memcpy(REAL(O_S_prob), internal->O_S_prob, internal->dim_O_S_prob * sizeof(double));
  odin_set_dim(O_S_prob, 3, internal->dim_O_S_prob_1, internal->dim_O_S_prob_2, internal->dim_O_S_prob_3);
  SET_VECTOR_ELT(contents, 266, O_S_prob);
  SET_VECTOR_ELT(contents, 267, ScalarInteger(internal->offset_output_age_I1));
  SET_VECTOR_ELT(contents, 268, ScalarInteger(internal->offset_output_age_R1));
  SET_VECTOR_ELT(contents, 269, ScalarInteger(internal->offset_output_age_S));
  SET_VECTOR_ELT(contents, 270, ScalarInteger(internal->offset_output_births));
  SET_VECTOR_ELT(contents, 271, ScalarInteger(internal->offset_output_deathrt));
  SET_VECTOR_ELT(contents, 272, ScalarInteger(internal->offset_output_Delta));
  SET_VECTOR_ELT(contents, 273, ScalarInteger(internal->offset_output_eip));
  SET_VECTOR_ELT(contents, 274, ScalarInteger(internal->offset_output_FOI1));
  SET_VECTOR_ELT(contents, 275, ScalarInteger(internal->offset_output_FOI1nn));
  SET_VECTOR_ELT(contents, 276, ScalarInteger(internal->offset_output_FOI1p));
  SET_VECTOR_ELT(contents, 277, ScalarInteger(internal->offset_output_FOI1Y));
  SET_VECTOR_ELT(contents, 278, ScalarInteger(internal->offset_output_inf_1));
  SET_VECTOR_ELT(contents, 279, ScalarInteger(internal->offset_output_inf_1_prob));
  SET_VECTOR_ELT(contents, 280, ScalarInteger(internal->offset_output_infectious1));
  SET_VECTOR_ELT(contents, 281, ScalarInteger(internal->offset_output_Kc));
  SET_VECTOR_ELT(contents, 282, ScalarInteger(internal->offset_output_Lwt_birth));
  SET_VECTOR_ELT(contents, 283, ScalarInteger(internal->offset_output_Lwt_mature));
  SET_VECTOR_ELT(contents, 284, ScalarInteger(internal->offset_output_Mwt_FOI1));
  SET_VECTOR_ELT(contents, 285, ScalarInteger(internal->offset_output_Mwt_inf1));
  SET_VECTOR_ELT(contents, 286, ScalarInteger(internal->offset_output_Mwt_tot));
  SET_VECTOR_ELT(contents, 287, ScalarInteger(internal->offset_output_Ntotal));
  SET_VECTOR_ELT(contents, 288, ScalarInteger(internal->offset_output_NTp));
  SET_VECTOR_ELT(contents, 289, ScalarInteger(internal->offset_output_O_I1));
  SET_VECTOR_ELT(contents, 290, ScalarInteger(internal->offset_output_O_Mwt_E1));
  SET_VECTOR_ELT(contents, 291, ScalarInteger(internal->offset_output_O_Mwt_S));
  SET_VECTOR_ELT(contents, 292, ScalarInteger(internal->offset_output_O_R1));
  SET_VECTOR_ELT(contents, 293, ScalarInteger(internal->offset_output_O_S));
  SET_VECTOR_ELT(contents, 294, ScalarInteger(internal->offset_output_O_S_prob));
  SET_VECTOR_ELT(contents, 295, ScalarInteger(internal->offset_output_prop_Sp));
  SET_VECTOR_ELT(contents, 296, ScalarInteger(internal->offset_output_recov1));
  SET_VECTOR_ELT(contents, 297, ScalarInteger(internal->offset_output_rho1));
  SET_VECTOR_ELT(contents, 298, ScalarInteger(internal->offset_output_Y1T));
  SET_VECTOR_ELT(contents, 299, ScalarInteger(internal->offset_variable_I1));
  SET_VECTOR_ELT(contents, 300, ScalarInteger(internal->offset_variable_incubA));
  SET_VECTOR_ELT(contents, 301, ScalarInteger(internal->offset_variable_incubB));
  SET_VECTOR_ELT(contents, 302, ScalarInteger(internal->offset_variable_infectiousA));
  SET_VECTOR_ELT(contents, 303, ScalarInteger(internal->offset_variable_infectiousB));
  SET_VECTOR_ELT(contents, 304, ScalarInteger(internal->offset_variable_Mwt_E1));
  SET_VECTOR_ELT(contents, 305, ScalarInteger(internal->offset_variable_Mwt_E2));
  SET_VECTOR_ELT(contents, 306, ScalarInteger(internal->offset_variable_Mwt_I1));
  SET_VECTOR_ELT(contents, 307, ScalarInteger(internal->offset_variable_R1));
  SET_VECTOR_ELT(contents, 308, ScalarInteger(internal->offset_variable_S));
  SET_VECTOR_ELT(contents, 309, ScalarReal(internal->Omega));
  SEXP phi1 = PROTECT(allocVector(REALSXP, internal->dim_phi1));
  memcpy(REAL(phi1), internal->phi1, internal->dim_phi1 * sizeof(double));
  SET_VECTOR_ELT(contents, 310, phi1);
  SET_VECTOR_ELT(contents, 311, ScalarReal(internal->pi));
  SEXP prop_Sp = PROTECT(allocVector(REALSXP, internal->dim_prop_Sp));
  memcpy(REAL(prop_Sp), internal->prop_Sp, internal->dim_prop_Sp * sizeof(double));
  SET_VECTOR_ELT(contents, 312, prop_Sp);
  SET_VECTOR_ELT(contents, 313, ScalarReal(internal->propMwtControl));
  SET_VECTOR_ELT(contents, 314, ScalarReal(internal->propTransGlobal));
  SET_VECTOR_ELT(contents, 315, ScalarReal(internal->propTransNN));
  SEXP recov1 = PROTECT(allocVector(REALSXP, internal->dim_recov1));
  memcpy(REAL(recov1), internal->recov1, internal->dim_recov1 * sizeof(double));
  odin_set_dim(recov1, 3, internal->dim_recov1_1, internal->dim_recov1_2, internal->dim_recov1_3);
  SET_VECTOR_ELT(contents, 316, recov1);
  SEXP recov1_prob = PROTECT(allocVector(REALSXP, internal->dim_recov1_prob));
  memcpy(REAL(recov1_prob), internal->recov1_prob, internal->dim_recov1_prob * sizeof(double));
  SET_VECTOR_ELT(contents, 317, recov1_prob);
  SEXP rho1 = PROTECT(allocVector(REALSXP, internal->dim_rho1));
  memcpy(REAL(rho1), internal->rho1, internal->dim_rho1 * sizeof(double));
  SET_VECTOR_ELT(contents, 318, rho1);
  SET_VECTOR_ELT(contents, 319, ScalarReal(internal->Rm));
  SEXP season_amp = PROTECT(allocVector(REALSXP, internal->dim_season_amp));
  memcpy(REAL(season_amp), internal->season_amp, internal->dim_season_amp * sizeof(double));
  SET_VECTOR_ELT(contents, 320, season_amp);
  SEXP season_phase = PROTECT(allocVector(REALSXP, internal->dim_season_phase));
  memcpy(REAL(season_phase), internal->season_phase, internal->dim_season_phase * sizeof(double));
  SET_VECTOR_ELT(contents, 321, season_phase);
  SET_VECTOR_ELT(contents, 322, ScalarReal(internal->Sigma));
  SEXP sum_S = PROTECT(allocVector(REALSXP, internal->dim_sum_S));
  memcpy(REAL(sum_S), internal->sum_S, internal->dim_sum_S * sizeof(double));
  odin_set_dim(sum_S, 2, internal->dim_sum_S_1, internal->dim_sum_S_2);
  SET_VECTOR_ELT(contents, 323, sum_S);
  SET_VECTOR_ELT(contents, 324, ScalarReal(internal->TimeMwtControlOff));
  SET_VECTOR_ELT(contents, 325, ScalarReal(internal->TimeMwtControlOn));
  SET_VECTOR_ELT(contents, 326, ScalarInteger(internal->vnc_row));
  SET_VECTOR_ELT(contents, 327, ScalarReal(internal->Wb_cyto));
  SET_VECTOR_ELT(contents, 328, ScalarReal(internal->Wb_fF));
  SET_VECTOR_ELT(contents, 329, ScalarReal(internal->Wb_mat));
  SET_VECTOR_ELT(contents, 330, ScalarReal(internal->Wb_relinf1));
  SEXP Y1 = PROTECT(allocVector(REALSXP, internal->dim_Y1));
  memcpy(REAL(Y1), internal->Y1, internal->dim_Y1 * sizeof(double));
  odin_set_dim(Y1, 3, internal->dim_Y1_1, internal->dim_Y1_2, internal->dim_Y1_3);
  SET_VECTOR_ELT(contents, 331, Y1);
  SEXP Y1T = PROTECT(allocVector(REALSXP, internal->dim_Y1T));
  memcpy(REAL(Y1T), internal->Y1T, internal->dim_Y1T * sizeof(double));
  SET_VECTOR_ELT(contents, 332, Y1T);
  SEXP Y1T_sum = PROTECT(allocVector(REALSXP, internal->dim_Y1T_sum));
  memcpy(REAL(Y1T_sum), internal->Y1T_sum, internal->dim_Y1T_sum * sizeof(double));
  odin_set_dim(Y1T_sum, 2, internal->dim_Y1T_sum_1, internal->dim_Y1T_sum_2);
  SET_VECTOR_ELT(contents, 333, Y1T_sum);
  SET_VECTOR_ELT(contents, 334, ScalarReal(internal->YL));
  SEXP nms = PROTECT(allocVector(STRSXP, 335));
  SET_STRING_ELT(nms, 0, mkChar("age_I1"));
  SET_STRING_ELT(nms, 1, mkChar("age_I1_prob"));
  SET_STRING_ELT(nms, 2, mkChar("age_I1_trials"));
  SET_STRING_ELT(nms, 3, mkChar("age_per"));
  SET_STRING_ELT(nms, 4, mkChar("age_R1"));
  SET_STRING_ELT(nms, 5, mkChar("age_R1_prob"));
  SET_STRING_ELT(nms, 6, mkChar("age_S"));
  SET_STRING_ELT(nms, 7, mkChar("age_S_prob"));
  SET_STRING_ELT(nms, 8, mkChar("age_S_trials"));
  SET_STRING_ELT(nms, 9, mkChar("agec"));
  SET_STRING_ELT(nms, 10, mkChar("agert"));
  SET_STRING_ELT(nms, 11, mkChar("Beta_hm_1"));
  SET_STRING_ELT(nms, 12, mkChar("Beta_mh_1"));
  SET_STRING_ELT(nms, 13, mkChar("BG_FOI"));
  SET_STRING_ELT(nms, 14, mkChar("births"));
  SET_STRING_ELT(nms, 15, mkChar("births_lambda"));
  SET_STRING_ELT(nms, 16, mkChar("deathrt"));
  SET_STRING_ELT(nms, 17, mkChar("Delta"));
  SET_STRING_ELT(nms, 18, mkChar("Delta_season"));
  SET_STRING_ELT(nms, 19, mkChar("DeltaBase"));
  SET_STRING_ELT(nms, 20, mkChar("dim_age_I1"));
  SET_STRING_ELT(nms, 21, mkChar("dim_age_I1_1"));
  SET_STRING_ELT(nms, 22, mkChar("dim_age_I1_12"));
  SET_STRING_ELT(nms, 23, mkChar("dim_age_I1_2"));
  SET_STRING_ELT(nms, 24, mkChar("dim_age_I1_3"));
  SET_STRING_ELT(nms, 25, mkChar("dim_age_I1_prob"));
  SET_STRING_ELT(nms, 26, mkChar("dim_age_I1_trials"));
  SET_STRING_ELT(nms, 27, mkChar("dim_age_I1_trials_1"));
  SET_STRING_ELT(nms, 28, mkChar("dim_age_I1_trials_12"));
  SET_STRING_ELT(nms, 29, mkChar("dim_age_I1_trials_2"));
  SET_STRING_ELT(nms, 30, mkChar("dim_age_I1_trials_3"));
  SET_STRING_ELT(nms, 31, mkChar("dim_age_R1"));
  SET_STRING_ELT(nms, 32, mkChar("dim_age_R1_1"));
  SET_STRING_ELT(nms, 33, mkChar("dim_age_R1_12"));
  SET_STRING_ELT(nms, 34, mkChar("dim_age_R1_2"));
  SET_STRING_ELT(nms, 35, mkChar("dim_age_R1_3"));
  SET_STRING_ELT(nms, 36, mkChar("dim_age_R1_prob"));
  SET_STRING_ELT(nms, 37, mkChar("dim_age_S"));
  SET_STRING_ELT(nms, 38, mkChar("dim_age_S_1"));
  SET_STRING_ELT(nms, 39, mkChar("dim_age_S_12"));
  SET_STRING_ELT(nms, 40, mkChar("dim_age_S_2"));
  SET_STRING_ELT(nms, 41, mkChar("dim_age_S_3"));
  SET_STRING_ELT(nms, 42, mkChar("dim_age_S_prob"));
  SET_STRING_ELT(nms, 43, mkChar("dim_age_S_trials"));
  SET_STRING_ELT(nms, 44, mkChar("dim_age_S_trials_1"));
  SET_STRING_ELT(nms, 45, mkChar("dim_age_S_trials_12"));
  SET_STRING_ELT(nms, 46, mkChar("dim_age_S_trials_2"));
  SET_STRING_ELT(nms, 47, mkChar("dim_age_S_trials_3"));
  SET_STRING_ELT(nms, 48, mkChar("dim_agec"));
  SET_STRING_ELT(nms, 49, mkChar("dim_agert"));
  SET_STRING_ELT(nms, 50, mkChar("dim_births"));
  SET_STRING_ELT(nms, 51, mkChar("dim_births_lambda"));
  SET_STRING_ELT(nms, 52, mkChar("dim_deathrt"));
  SET_STRING_ELT(nms, 53, mkChar("dim_Delta"));
  SET_STRING_ELT(nms, 54, mkChar("dim_eip"));
  SET_STRING_ELT(nms, 55, mkChar("dim_FOI1"));
  SET_STRING_ELT(nms, 56, mkChar("dim_FOI1nn"));
  SET_STRING_ELT(nms, 57, mkChar("dim_FOI1p"));
  SET_STRING_ELT(nms, 58, mkChar("dim_FOI1Y"));
  SET_STRING_ELT(nms, 59, mkChar("dim_I1"));
  SET_STRING_ELT(nms, 60, mkChar("dim_I1_1"));
  SET_STRING_ELT(nms, 61, mkChar("dim_I1_12"));
  SET_STRING_ELT(nms, 62, mkChar("dim_I1_2"));
  SET_STRING_ELT(nms, 63, mkChar("dim_I1_3"));
  SET_STRING_ELT(nms, 64, mkChar("dim_incubA"));
  SET_STRING_ELT(nms, 65, mkChar("dim_incubB"));
  SET_STRING_ELT(nms, 66, mkChar("dim_inf_1"));
  SET_STRING_ELT(nms, 67, mkChar("dim_inf_1_1"));
  SET_STRING_ELT(nms, 68, mkChar("dim_inf_1_12"));
  SET_STRING_ELT(nms, 69, mkChar("dim_inf_1_2"));
  SET_STRING_ELT(nms, 70, mkChar("dim_inf_1_3"));
  SET_STRING_ELT(nms, 71, mkChar("dim_inf_1_prob"));
  SET_STRING_ELT(nms, 72, mkChar("dim_inf_1_prob_1"));
  SET_STRING_ELT(nms, 73, mkChar("dim_inf_1_prob_12"));
  SET_STRING_ELT(nms, 74, mkChar("dim_inf_1_prob_2"));
  SET_STRING_ELT(nms, 75, mkChar("dim_inf_1_prob_3"));
  SET_STRING_ELT(nms, 76, mkChar("dim_infectious1"));
  SET_STRING_ELT(nms, 77, mkChar("dim_infectiousA"));
  SET_STRING_ELT(nms, 78, mkChar("dim_infectiousB"));
  SET_STRING_ELT(nms, 79, mkChar("dim_init_I1"));
  SET_STRING_ELT(nms, 80, mkChar("dim_init_I1_1"));
  SET_STRING_ELT(nms, 81, mkChar("dim_init_I1_12"));
  SET_STRING_ELT(nms, 82, mkChar("dim_init_I1_2"));
  SET_STRING_ELT(nms, 83, mkChar("dim_init_I1_3"));
  SET_STRING_ELT(nms, 84, mkChar("dim_init_R1"));
  SET_STRING_ELT(nms, 85, mkChar("dim_init_R1_1"));
  SET_STRING_ELT(nms, 86, mkChar("dim_init_R1_12"));
  SET_STRING_ELT(nms, 87, mkChar("dim_init_R1_2"));
  SET_STRING_ELT(nms, 88, mkChar("dim_init_R1_3"));
  SET_STRING_ELT(nms, 89, mkChar("dim_init_S"));
  SET_STRING_ELT(nms, 90, mkChar("dim_init_S_1"));
  SET_STRING_ELT(nms, 91, mkChar("dim_init_S_12"));
  SET_STRING_ELT(nms, 92, mkChar("dim_init_S_2"));
  SET_STRING_ELT(nms, 93, mkChar("dim_init_S_3"));
  SET_STRING_ELT(nms, 94, mkChar("dim_Kc"));
  SET_STRING_ELT(nms, 95, mkChar("dim_L_deathrt"));
  SET_STRING_ELT(nms, 96, mkChar("dim_L_dr"));
  SET_STRING_ELT(nms, 97, mkChar("dim_Lwt"));
  SET_STRING_ELT(nms, 98, mkChar("dim_Lwt_birth"));
  SET_STRING_ELT(nms, 99, mkChar("dim_Lwt_birth_lambda"));
  SET_STRING_ELT(nms, 100, mkChar("dim_Lwt_mature"));
  SET_STRING_ELT(nms, 101, mkChar("dim_Lwt_mature_prob"));
  SET_STRING_ELT(nms, 102, mkChar("dim_Mwt"));
  SET_STRING_ELT(nms, 103, mkChar("dim_Mwt_E1"));
  SET_STRING_ELT(nms, 104, mkChar("dim_Mwt_E1_incub"));
  SET_STRING_ELT(nms, 105, mkChar("dim_Mwt_E1_incub_prob"));
  SET_STRING_ELT(nms, 106, mkChar("dim_Mwt_E2"));
  SET_STRING_ELT(nms, 107, mkChar("dim_Mwt_E2_incub"));
  SET_STRING_ELT(nms, 108, mkChar("dim_Mwt_E2_incub_prob"));
  SET_STRING_ELT(nms, 109, mkChar("dim_Mwt_FOI1"));
  SET_STRING_ELT(nms, 110, mkChar("dim_Mwt_I1"));
  SET_STRING_ELT(nms, 111, mkChar("dim_Mwt_inf1"));
  SET_STRING_ELT(nms, 112, mkChar("dim_Mwt_inf1_prob"));
  SET_STRING_ELT(nms, 113, mkChar("dim_Mwt_S"));
  SET_STRING_ELT(nms, 114, mkChar("dim_Mwt_tot"));
  SET_STRING_ELT(nms, 115, mkChar("dim_N_eq"));
  SET_STRING_ELT(nms, 116, mkChar("dim_Nb"));
  SET_STRING_ELT(nms, 117, mkChar("dim_nn"));
  SET_STRING_ELT(nms, 118, mkChar("dim_nn_1"));
  SET_STRING_ELT(nms, 119, mkChar("dim_nn_2"));
  SET_STRING_ELT(nms, 120, mkChar("dim_Ntotal"));
  SET_STRING_ELT(nms, 121, mkChar("dim_Ntotal_1"));
  SET_STRING_ELT(nms, 122, mkChar("dim_Ntotal_12"));
  SET_STRING_ELT(nms, 123, mkChar("dim_Ntotal_2"));
  SET_STRING_ELT(nms, 124, mkChar("dim_Ntotal_3"));
  SET_STRING_ELT(nms, 125, mkChar("dim_Ntotal_sum"));
  SET_STRING_ELT(nms, 126, mkChar("dim_Ntotal_sum_1"));
  SET_STRING_ELT(nms, 127, mkChar("dim_Ntotal_sum_2"));
  SET_STRING_ELT(nms, 128, mkChar("dim_NTp"));
  SET_STRING_ELT(nms, 129, mkChar("dim_O_I1"));
  SET_STRING_ELT(nms, 130, mkChar("dim_O_I1_1"));
  SET_STRING_ELT(nms, 131, mkChar("dim_O_I1_12"));
  SET_STRING_ELT(nms, 132, mkChar("dim_O_I1_2"));
  SET_STRING_ELT(nms, 133, mkChar("dim_O_I1_3"));
  SET_STRING_ELT(nms, 134, mkChar("dim_O_I1_prob"));
  SET_STRING_ELT(nms, 135, mkChar("dim_O_Lwt"));
  SET_STRING_ELT(nms, 136, mkChar("dim_O_Lwt_prob"));
  SET_STRING_ELT(nms, 137, mkChar("dim_O_Mwt_E1"));
  SET_STRING_ELT(nms, 138, mkChar("dim_O_Mwt_E1_prob"));
  SET_STRING_ELT(nms, 139, mkChar("dim_O_Mwt_E2"));
  SET_STRING_ELT(nms, 140, mkChar("dim_O_Mwt_E2_prob"));
  SET_STRING_ELT(nms, 141, mkChar("dim_O_Mwt_I1"));
  SET_STRING_ELT(nms, 142, mkChar("dim_O_Mwt_I1_prob"));
  SET_STRING_ELT(nms, 143, mkChar("dim_O_Mwt_S"));
  SET_STRING_ELT(nms, 144, mkChar("dim_O_Mwt_S_prob"));
  SET_STRING_ELT(nms, 145, mkChar("dim_O_R1"));
  SET_STRING_ELT(nms, 146, mkChar("dim_O_R1_1"));
  SET_STRING_ELT(nms, 147, mkChar("dim_O_R1_12"));
  SET_STRING_ELT(nms, 148, mkChar("dim_O_R1_2"));
  SET_STRING_ELT(nms, 149, mkChar("dim_O_R1_3"));
  SET_STRING_ELT(nms, 150, mkChar("dim_O_R1_prob"));
  SET_STRING_ELT(nms, 151, mkChar("dim_O_S"));
  SET_STRING_ELT(nms, 152, mkChar("dim_O_S_1"));
  SET_STRING_ELT(nms, 153, mkChar("dim_O_S_12"));
  SET_STRING_ELT(nms, 154, mkChar("dim_O_S_2"));
  SET_STRING_ELT(nms, 155, mkChar("dim_O_S_3"));
  SET_STRING_ELT(nms, 156, mkChar("dim_O_S_prob"));
  SET_STRING_ELT(nms, 157, mkChar("dim_O_S_prob_1"));
  SET_STRING_ELT(nms, 158, mkChar("dim_O_S_prob_12"));
  SET_STRING_ELT(nms, 159, mkChar("dim_O_S_prob_2"));
  SET_STRING_ELT(nms, 160, mkChar("dim_O_S_prob_3"));
  SET_STRING_ELT(nms, 161, mkChar("dim_phi1"));
  SET_STRING_ELT(nms, 162, mkChar("dim_prop_Sp"));
  SET_STRING_ELT(nms, 163, mkChar("dim_R1"));
  SET_STRING_ELT(nms, 164, mkChar("dim_R1_1"));
  SET_STRING_ELT(nms, 165, mkChar("dim_R1_12"));
  SET_STRING_ELT(nms, 166, mkChar("dim_R1_2"));
  SET_STRING_ELT(nms, 167, mkChar("dim_R1_3"));
  SET_STRING_ELT(nms, 168, mkChar("dim_recov1"));
  SET_STRING_ELT(nms, 169, mkChar("dim_recov1_1"));
  SET_STRING_ELT(nms, 170, mkChar("dim_recov1_12"));
  SET_STRING_ELT(nms, 171, mkChar("dim_recov1_2"));
  SET_STRING_ELT(nms, 172, mkChar("dim_recov1_3"));
  SET_STRING_ELT(nms, 173, mkChar("dim_recov1_prob"));
  SET_STRING_ELT(nms, 174, mkChar("dim_rho1"));
  SET_STRING_ELT(nms, 175, mkChar("dim_S"));
  SET_STRING_ELT(nms, 176, mkChar("dim_S_1"));
  SET_STRING_ELT(nms, 177, mkChar("dim_S_12"));
  SET_STRING_ELT(nms, 178, mkChar("dim_S_2"));
  SET_STRING_ELT(nms, 179, mkChar("dim_S_3"));
  SET_STRING_ELT(nms, 180, mkChar("dim_season_amp"));
  SET_STRING_ELT(nms, 181, mkChar("dim_season_phase"));
  SET_STRING_ELT(nms, 182, mkChar("dim_sum_S"));
  SET_STRING_ELT(nms, 183, mkChar("dim_sum_S_1"));
  SET_STRING_ELT(nms, 184, mkChar("dim_sum_S_2"));
  SET_STRING_ELT(nms, 185, mkChar("dim_Y1"));
  SET_STRING_ELT(nms, 186, mkChar("dim_Y1_1"));
  SET_STRING_ELT(nms, 187, mkChar("dim_Y1_12"));
  SET_STRING_ELT(nms, 188, mkChar("dim_Y1_2"));
  SET_STRING_ELT(nms, 189, mkChar("dim_Y1_3"));
  SET_STRING_ELT(nms, 190, mkChar("dim_Y1T"));
  SET_STRING_ELT(nms, 191, mkChar("dim_Y1T_sum"));
  SET_STRING_ELT(nms, 192, mkChar("dim_Y1T_sum_1"));
  SET_STRING_ELT(nms, 193, mkChar("dim_Y1T_sum_2"));
  SET_STRING_ELT(nms, 194, mkChar("DT"));
  SET_STRING_ELT(nms, 195, mkChar("eip"));
  SET_STRING_ELT(nms, 196, mkChar("eip_mean"));
  SET_STRING_ELT(nms, 197, mkChar("eip_season"));
  SET_STRING_ELT(nms, 198, mkChar("Epsilon"));
  SET_STRING_ELT(nms, 199, mkChar("FOI1"));
  SET_STRING_ELT(nms, 200, mkChar("FOI1nn"));
  SET_STRING_ELT(nms, 201, mkChar("FOI1p"));
  SET_STRING_ELT(nms, 202, mkChar("FOI1Y"));
  SET_STRING_ELT(nms, 203, mkChar("incub"));
  SET_STRING_ELT(nms, 204, mkChar("inf_1"));
  SET_STRING_ELT(nms, 205, mkChar("inf_1_prob"));
  SET_STRING_ELT(nms, 206, mkChar("inf_per"));
  SET_STRING_ELT(nms, 207, mkChar("infectious1"));
  SET_STRING_ELT(nms, 208, mkChar("init_I1"));
  SET_STRING_ELT(nms, 209, mkChar("init_R1"));
  SET_STRING_ELT(nms, 210, mkChar("init_S"));
  SET_STRING_ELT(nms, 211, mkChar("initial_I1"));
  SET_STRING_ELT(nms, 212, mkChar("initial_incubA"));
  SET_STRING_ELT(nms, 213, mkChar("initial_incubB"));
  SET_STRING_ELT(nms, 214, mkChar("initial_infectiousA"));
  SET_STRING_ELT(nms, 215, mkChar("initial_infectiousB"));
  SET_STRING_ELT(nms, 216, mkChar("initial_Lwt"));
  SET_STRING_ELT(nms, 217, mkChar("initial_Mwt_E1"));
  SET_STRING_ELT(nms, 218, mkChar("initial_Mwt_E2"));
  SET_STRING_ELT(nms, 219, mkChar("initial_Mwt_I1"));
  SET_STRING_ELT(nms, 220, mkChar("initial_Mwt_S"));
  SET_STRING_ELT(nms, 221, mkChar("initial_R1"));
  SET_STRING_ELT(nms, 222, mkChar("initial_S"));
  SET_STRING_ELT(nms, 223, mkChar("Kappa"));
  SET_STRING_ELT(nms, 224, mkChar("Kc"));
  SET_STRING_ELT(nms, 225, mkChar("Kc_season"));
  SET_STRING_ELT(nms, 226, mkChar("L_deathrt"));
  SET_STRING_ELT(nms, 227, mkChar("L_dr"));
  SET_STRING_ELT(nms, 228, mkChar("Lwt_birth"));
  SET_STRING_ELT(nms, 229, mkChar("Lwt_birth_lambda"));
  SET_STRING_ELT(nms, 230, mkChar("Lwt_mature"));
  SET_STRING_ELT(nms, 231, mkChar("Lwt_mature_prob"));
  SET_STRING_ELT(nms, 232, mkChar("Mwt"));
  SET_STRING_ELT(nms, 233, mkChar("Mwt_E1_incub"));
  SET_STRING_ELT(nms, 234, mkChar("Mwt_E1_incub_prob"));
  SET_STRING_ELT(nms, 235, mkChar("Mwt_E2_incub"));
  SET_STRING_ELT(nms, 236, mkChar("Mwt_E2_incub_prob"));
  SET_STRING_ELT(nms, 237, mkChar("Mwt_FOI1"));
  SET_STRING_ELT(nms, 238, mkChar("Mwt_inf1"));
  SET_STRING_ELT(nms, 239, mkChar("Mwt_inf1_prob"));
  SET_STRING_ELT(nms, 240, mkChar("Mwt_mean"));
  SET_STRING_ELT(nms, 241, mkChar("Mwt_tot"));
  SET_STRING_ELT(nms, 242, mkChar("N_eq"));
  SET_STRING_ELT(nms, 243, mkChar("na"));
  SET_STRING_ELT(nms, 244, mkChar("Nb"));
  SET_STRING_ELT(nms, 245, mkChar("nn"));
  SET_STRING_ELT(nms, 246, mkChar("NP"));
  SET_STRING_ELT(nms, 247, mkChar("Ntotal"));
  SET_STRING_ELT(nms, 248, mkChar("Ntotal_sum"));
  SET_STRING_ELT(nms, 249, mkChar("NTp"));
  SET_STRING_ELT(nms, 250, mkChar("nu"));
  SET_STRING_ELT(nms, 251, mkChar("O_I1"));
  SET_STRING_ELT(nms, 252, mkChar("O_I1_prob"));
  SET_STRING_ELT(nms, 253, mkChar("O_Lwt"));
  SET_STRING_ELT(nms, 254, mkChar("O_Lwt_prob"));
  SET_STRING_ELT(nms, 255, mkChar("O_Mwt_E1"));
  SET_STRING_ELT(nms, 256, mkChar("O_Mwt_E1_prob"));
  SET_STRING_ELT(nms, 257, mkChar("O_Mwt_E2"));
  SET_STRING_ELT(nms, 258, mkChar("O_Mwt_E2_prob"));
  SET_STRING_ELT(nms, 259, mkChar("O_Mwt_I1"));
  SET_STRING_ELT(nms, 260, mkChar("O_Mwt_I1_prob"));
  SET_STRING_ELT(nms, 261, mkChar("O_Mwt_S"));
  SET_STRING_ELT(nms, 262, mkChar("O_Mwt_S_prob"));
  SET_STRING_ELT(nms, 263, mkChar("O_R1"));
  SET_STRING_ELT(nms, 264, mkChar("O_R1_prob"));
  SET_STRING_ELT(nms, 265, mkChar("O_S"));
  SET_STRING_ELT(nms, 266, mkChar("O_S_prob"));
  SET_STRING_ELT(nms, 267, mkChar("offset_output_age_I1"));
  SET_STRING_ELT(nms, 268, mkChar("offset_output_age_R1"));
  SET_STRING_ELT(nms, 269, mkChar("offset_output_age_S"));
  SET_STRING_ELT(nms, 270, mkChar("offset_output_births"));
  SET_STRING_ELT(nms, 271, mkChar("offset_output_deathrt"));
  SET_STRING_ELT(nms, 272, mkChar("offset_output_Delta"));
  SET_STRING_ELT(nms, 273, mkChar("offset_output_eip"));
  SET_STRING_ELT(nms, 274, mkChar("offset_output_FOI1"));
  SET_STRING_ELT(nms, 275, mkChar("offset_output_FOI1nn"));
  SET_STRING_ELT(nms, 276, mkChar("offset_output_FOI1p"));
  SET_STRING_ELT(nms, 277, mkChar("offset_output_FOI1Y"));
  SET_STRING_ELT(nms, 278, mkChar("offset_output_inf_1"));
  SET_STRING_ELT(nms, 279, mkChar("offset_output_inf_1_prob"));
  SET_STRING_ELT(nms, 280, mkChar("offset_output_infectious1"));
  SET_STRING_ELT(nms, 281, mkChar("offset_output_Kc"));
  SET_STRING_ELT(nms, 282, mkChar("offset_output_Lwt_birth"));
  SET_STRING_ELT(nms, 283, mkChar("offset_output_Lwt_mature"));
  SET_STRING_ELT(nms, 284, mkChar("offset_output_Mwt_FOI1"));
  SET_STRING_ELT(nms, 285, mkChar("offset_output_Mwt_inf1"));
  SET_STRING_ELT(nms, 286, mkChar("offset_output_Mwt_tot"));
  SET_STRING_ELT(nms, 287, mkChar("offset_output_Ntotal"));
  SET_STRING_ELT(nms, 288, mkChar("offset_output_NTp"));
  SET_STRING_ELT(nms, 289, mkChar("offset_output_O_I1"));
  SET_STRING_ELT(nms, 290, mkChar("offset_output_O_Mwt_E1"));
  SET_STRING_ELT(nms, 291, mkChar("offset_output_O_Mwt_S"));
  SET_STRING_ELT(nms, 292, mkChar("offset_output_O_R1"));
  SET_STRING_ELT(nms, 293, mkChar("offset_output_O_S"));
  SET_STRING_ELT(nms, 294, mkChar("offset_output_O_S_prob"));
  SET_STRING_ELT(nms, 295, mkChar("offset_output_prop_Sp"));
  SET_STRING_ELT(nms, 296, mkChar("offset_output_recov1"));
  SET_STRING_ELT(nms, 297, mkChar("offset_output_rho1"));
  SET_STRING_ELT(nms, 298, mkChar("offset_output_Y1T"));
  SET_STRING_ELT(nms, 299, mkChar("offset_variable_I1"));
  SET_STRING_ELT(nms, 300, mkChar("offset_variable_incubA"));
  SET_STRING_ELT(nms, 301, mkChar("offset_variable_incubB"));
  SET_STRING_ELT(nms, 302, mkChar("offset_variable_infectiousA"));
  SET_STRING_ELT(nms, 303, mkChar("offset_variable_infectiousB"));
  SET_STRING_ELT(nms, 304, mkChar("offset_variable_Mwt_E1"));
  SET_STRING_ELT(nms, 305, mkChar("offset_variable_Mwt_E2"));
  SET_STRING_ELT(nms, 306, mkChar("offset_variable_Mwt_I1"));
  SET_STRING_ELT(nms, 307, mkChar("offset_variable_R1"));
  SET_STRING_ELT(nms, 308, mkChar("offset_variable_S"));
  SET_STRING_ELT(nms, 309, mkChar("Omega"));
  SET_STRING_ELT(nms, 310, mkChar("phi1"));
  SET_STRING_ELT(nms, 311, mkChar("pi"));
  SET_STRING_ELT(nms, 312, mkChar("prop_Sp"));
  SET_STRING_ELT(nms, 313, mkChar("propMwtControl"));
  SET_STRING_ELT(nms, 314, mkChar("propTransGlobal"));
  SET_STRING_ELT(nms, 315, mkChar("propTransNN"));
  SET_STRING_ELT(nms, 316, mkChar("recov1"));
  SET_STRING_ELT(nms, 317, mkChar("recov1_prob"));
  SET_STRING_ELT(nms, 318, mkChar("rho1"));
  SET_STRING_ELT(nms, 319, mkChar("Rm"));
  SET_STRING_ELT(nms, 320, mkChar("season_amp"));
  SET_STRING_ELT(nms, 321, mkChar("season_phase"));
  SET_STRING_ELT(nms, 322, mkChar("Sigma"));
  SET_STRING_ELT(nms, 323, mkChar("sum_S"));
  SET_STRING_ELT(nms, 324, mkChar("TimeMwtControlOff"));
  SET_STRING_ELT(nms, 325, mkChar("TimeMwtControlOn"));
  SET_STRING_ELT(nms, 326, mkChar("vnc_row"));
  SET_STRING_ELT(nms, 327, mkChar("Wb_cyto"));
  SET_STRING_ELT(nms, 328, mkChar("Wb_fF"));
  SET_STRING_ELT(nms, 329, mkChar("Wb_mat"));
  SET_STRING_ELT(nms, 330, mkChar("Wb_relinf1"));
  SET_STRING_ELT(nms, 331, mkChar("Y1"));
  SET_STRING_ELT(nms, 332, mkChar("Y1T"));
  SET_STRING_ELT(nms, 333, mkChar("Y1T_sum"));
  SET_STRING_ELT(nms, 334, mkChar("YL"));
  setAttrib(contents, R_NamesSymbol, nms);
  UNPROTECT(88);
  return contents;
}
SEXP odin_model_stoch_set_user(SEXP internal_p, SEXP user) {
  odin_model_stoch_internal *internal = odin_model_stoch_get_internal(internal_p, 1);
  internal->age_per = user_get_scalar_double(user, "age_per", internal->age_per, NA_REAL, NA_REAL);
  internal->Beta_hm_1 = user_get_scalar_double(user, "Beta_hm_1", internal->Beta_hm_1, NA_REAL, NA_REAL);
  internal->Beta_mh_1 = user_get_scalar_double(user, "Beta_mh_1", internal->Beta_mh_1, NA_REAL, NA_REAL);
  internal->BG_FOI = user_get_scalar_double(user, "BG_FOI", internal->BG_FOI, NA_REAL, NA_REAL);
  internal->Delta_season = user_get_scalar_double(user, "Delta_season", internal->Delta_season, NA_REAL, NA_REAL);
  internal->DeltaBase = user_get_scalar_double(user, "DeltaBase", internal->DeltaBase, NA_REAL, NA_REAL);
  internal->DT = user_get_scalar_double(user, "DT", internal->DT, NA_REAL, NA_REAL);
  internal->eip_mean = user_get_scalar_double(user, "eip_mean", internal->eip_mean, NA_REAL, NA_REAL);
  internal->eip_season = user_get_scalar_double(user, "eip_season", internal->eip_season, NA_REAL, NA_REAL);
  internal->Epsilon = user_get_scalar_double(user, "Epsilon", internal->Epsilon, NA_REAL, NA_REAL);
  internal->incub = user_get_scalar_double(user, "incub", internal->incub, NA_REAL, NA_REAL);
  internal->inf_per = user_get_scalar_double(user, "inf_per", internal->inf_per, NA_REAL, NA_REAL);
  internal->Kappa = user_get_scalar_double(user, "Kappa", internal->Kappa, NA_REAL, NA_REAL);
  internal->Kc_season = user_get_scalar_double(user, "Kc_season", internal->Kc_season, NA_REAL, NA_REAL);
  internal->Mwt_mean = user_get_scalar_double(user, "Mwt_mean", internal->Mwt_mean, NA_REAL, NA_REAL);
  internal->na = user_get_scalar_int(user, "na", internal->na, NA_REAL, NA_REAL);
  internal->NP = user_get_scalar_int(user, "NP", internal->NP, NA_REAL, NA_REAL);
  internal->nu = user_get_scalar_double(user, "nu", internal->nu, NA_REAL, NA_REAL);
  internal->Omega = user_get_scalar_double(user, "Omega", internal->Omega, NA_REAL, NA_REAL);
  internal->pi = user_get_scalar_double(user, "pi", internal->pi, NA_REAL, NA_REAL);
  internal->propMwtControl = user_get_scalar_double(user, "propMwtControl", internal->propMwtControl, NA_REAL, NA_REAL);
  internal->propTransGlobal = user_get_scalar_double(user, "propTransGlobal", internal->propTransGlobal, NA_REAL, NA_REAL);
  internal->propTransNN = user_get_scalar_double(user, "propTransNN", internal->propTransNN, NA_REAL, NA_REAL);
  internal->Rm = user_get_scalar_double(user, "Rm", internal->Rm, NA_REAL, NA_REAL);
  internal->Sigma = user_get_scalar_double(user, "Sigma", internal->Sigma, NA_REAL, NA_REAL);
  internal->TimeMwtControlOff = user_get_scalar_double(user, "TimeMwtControlOff", internal->TimeMwtControlOff, NA_REAL, NA_REAL);
  internal->TimeMwtControlOn = user_get_scalar_double(user, "TimeMwtControlOn", internal->TimeMwtControlOn, NA_REAL, NA_REAL);
  internal->Wb_cyto = user_get_scalar_double(user, "Wb_cyto", internal->Wb_cyto, NA_REAL, NA_REAL);
  internal->Wb_fF = user_get_scalar_double(user, "Wb_fF", internal->Wb_fF, NA_REAL, NA_REAL);
  internal->Wb_mat = user_get_scalar_double(user, "Wb_mat", internal->Wb_mat, NA_REAL, NA_REAL);
  internal->Wb_relinf1 = user_get_scalar_double(user, "Wb_relinf1", internal->Wb_relinf1, NA_REAL, NA_REAL);
  internal->YL = user_get_scalar_double(user, "YL", internal->YL, NA_REAL, NA_REAL);
  internal->dim_age_I1_prob = internal->na;
  internal->dim_age_I1_trials_1 = internal->na;
  internal->dim_age_I1_trials_2 = 2;
  internal->dim_age_I1_trials_3 = internal->NP;
  internal->dim_age_R1_prob = internal->na;
  internal->dim_age_S_1 = internal->na;
  internal->dim_age_S_2 = 2;
  internal->dim_age_S_3 = internal->NP;
  internal->dim_age_S_prob = internal->na;
  internal->dim_age_S_trials_1 = internal->na;
  internal->dim_age_S_trials_2 = 2;
  internal->dim_age_S_trials_3 = internal->NP;
  internal->dim_agec = internal->na;
  internal->dim_agert = internal->na;
  internal->dim_births = internal->NP;
  internal->dim_births_lambda = internal->NP;
  internal->dim_deathrt = internal->na;
  internal->dim_Delta = internal->NP;
  internal->dim_eip = internal->NP;
  internal->dim_FOI1 = internal->NP;
  internal->dim_FOI1nn = internal->NP;
  internal->dim_FOI1p = internal->NP;
  internal->dim_FOI1Y = internal->NP;
  internal->dim_I1_1 = internal->na;
  internal->dim_I1_2 = 2;
  internal->dim_I1_3 = internal->NP;
  internal->dim_incubA = internal->NP;
  internal->dim_incubB = internal->NP;
  internal->dim_inf_1_1 = internal->na;
  internal->dim_inf_1_2 = 2;
  internal->dim_inf_1_3 = internal->NP;
  internal->dim_inf_1_prob_1 = internal->na;
  internal->dim_inf_1_prob_2 = 2;
  internal->dim_inf_1_prob_3 = internal->NP;
  internal->dim_infectious1 = internal->NP;
  internal->dim_infectiousA = internal->NP;
  internal->dim_infectiousB = internal->NP;
  internal->dim_init_I1_1 = internal->na;
  internal->dim_init_I1_2 = 2;
  internal->dim_init_I1_3 = internal->NP;
  internal->dim_init_R1_1 = internal->na;
  internal->dim_init_R1_2 = 2;
  internal->dim_init_R1_3 = internal->NP;
  internal->dim_init_S_1 = internal->na;
  internal->dim_init_S_2 = 2;
  internal->dim_init_S_3 = internal->NP;
  internal->dim_Kc = internal->NP;
  internal->dim_L_deathrt = internal->NP;
  internal->dim_L_dr = internal->NP;
  internal->dim_Lwt = internal->NP;
  internal->dim_Lwt_birth = internal->NP;
  internal->dim_Lwt_birth_lambda = internal->NP;
  internal->dim_Lwt_mature = internal->NP;
  internal->dim_Lwt_mature_prob = internal->NP;
  internal->dim_Mwt = internal->NP;
  internal->dim_Mwt_E1 = internal->NP;
  internal->dim_Mwt_E1_incub = internal->NP;
  internal->dim_Mwt_E1_incub_prob = internal->NP;
  internal->dim_Mwt_E2 = internal->NP;
  internal->dim_Mwt_E2_incub = internal->NP;
  internal->dim_Mwt_E2_incub_prob = internal->NP;
  internal->dim_Mwt_FOI1 = internal->NP;
  internal->dim_Mwt_I1 = internal->NP;
  internal->dim_Mwt_inf1 = internal->NP;
  internal->dim_Mwt_inf1_prob = internal->NP;
  internal->dim_Mwt_S = internal->NP;
  internal->dim_Mwt_tot = internal->NP;
  internal->dim_N_eq = internal->NP;
  internal->dim_Nb = internal->NP;
  internal->dim_nn_1 = internal->NP;
  internal->dim_nn_2 = 8;
  internal->dim_Ntotal_1 = internal->na;
  internal->dim_Ntotal_2 = 2;
  internal->dim_Ntotal_3 = internal->NP;
  internal->dim_Ntotal_sum_1 = internal->na;
  internal->dim_Ntotal_sum_2 = internal->NP;
  internal->dim_NTp = internal->NP;
  internal->dim_O_I1_1 = internal->na;
  internal->dim_O_I1_2 = 2;
  internal->dim_O_I1_3 = internal->NP;
  internal->dim_O_I1_prob = internal->na;
  internal->dim_O_Lwt = internal->NP;
  internal->dim_O_Lwt_prob = internal->NP;
  internal->dim_O_Mwt_E1 = internal->NP;
  internal->dim_O_Mwt_E1_prob = internal->NP;
  internal->dim_O_Mwt_E2 = internal->NP;
  internal->dim_O_Mwt_E2_prob = internal->NP;
  internal->dim_O_Mwt_I1 = internal->NP;
  internal->dim_O_Mwt_I1_prob = internal->NP;
  internal->dim_O_Mwt_S = internal->NP;
  internal->dim_O_Mwt_S_prob = internal->NP;
  internal->dim_O_R1_1 = internal->na;
  internal->dim_O_R1_2 = 2;
  internal->dim_O_R1_3 = internal->NP;
  internal->dim_O_R1_prob = internal->na;
  internal->dim_O_S_1 = internal->na;
  internal->dim_O_S_2 = 2;
  internal->dim_O_S_3 = internal->NP;
  internal->dim_O_S_prob_1 = internal->na;
  internal->dim_O_S_prob_2 = 2;
  internal->dim_O_S_prob_3 = internal->NP;
  internal->dim_prop_Sp = internal->NP;
  internal->dim_R1_1 = internal->na;
  internal->dim_R1_2 = 2;
  internal->dim_R1_3 = internal->NP;
  internal->dim_recov1_1 = internal->na;
  internal->dim_recov1_2 = 2;
  internal->dim_recov1_3 = internal->NP;
  internal->dim_recov1_prob = internal->na;
  internal->dim_S_1 = internal->na;
  internal->dim_S_2 = 2;
  internal->dim_S_3 = internal->NP;
  internal->dim_season_amp = internal->NP;
  internal->dim_season_phase = internal->NP;
  internal->dim_sum_S_1 = internal->na;
  internal->dim_sum_S_2 = internal->NP;
  internal->dim_Y1_1 = internal->na;
  internal->dim_Y1_2 = 2;
  internal->dim_Y1_3 = internal->NP;
  internal->dim_Y1T = internal->NP;
  internal->dim_Y1T_sum_1 = internal->na;
  internal->dim_Y1T_sum_2 = internal->NP;
  internal->phi1 = (double*) user_get_array(user, false, internal->phi1, "phi1", NA_REAL, NA_REAL, 1, internal->dim_phi1);
  internal->rho1 = (double*) user_get_array(user, false, internal->rho1, "rho1", NA_REAL, NA_REAL, 1, internal->dim_rho1);
  internal->vnc_row = internal->na + 1;
  internal->agec = (double*) user_get_array(user, false, internal->agec, "agec", NA_REAL, NA_REAL, 1, internal->dim_agec);
  Free(internal->age_I1_prob);
  internal->age_I1_prob = (double*) Calloc(internal->dim_age_I1_prob, double);
  Free(internal->age_R1_prob);
  internal->age_R1_prob = (double*) Calloc(internal->dim_age_R1_prob, double);
  Free(internal->age_S_prob);
  internal->age_S_prob = (double*) Calloc(internal->dim_age_S_prob, double);
  Free(internal->agert);
  internal->agert = (double*) Calloc(internal->dim_agert, double);
  Free(internal->births);
  internal->births = (double*) Calloc(internal->dim_births, double);
  Free(internal->births_lambda);
  internal->births_lambda = (double*) Calloc(internal->dim_births_lambda, double);
  Free(internal->Delta);
  internal->Delta = (double*) Calloc(internal->dim_Delta, double);
  Free(internal->eip);
  internal->eip = (double*) Calloc(internal->dim_eip, double);
  Free(internal->FOI1);
  internal->FOI1 = (double*) Calloc(internal->dim_FOI1, double);
  Free(internal->FOI1nn);
  internal->FOI1nn = (double*) Calloc(internal->dim_FOI1nn, double);
  Free(internal->FOI1p);
  internal->FOI1p = (double*) Calloc(internal->dim_FOI1p, double);
  Free(internal->FOI1Y);
  internal->FOI1Y = (double*) Calloc(internal->dim_FOI1Y, double);
  Free(internal->infectious1);
  internal->infectious1 = (double*) Calloc(internal->dim_infectious1, double);
  Free(internal->initial_incubA);
  internal->initial_incubA = (double*) Calloc(internal->dim_incubA, double);
  Free(internal->initial_incubB);
  internal->initial_incubB = (double*) Calloc(internal->dim_incubB, double);
  Free(internal->initial_infectiousA);
  internal->initial_infectiousA = (double*) Calloc(internal->dim_infectiousA, double);
  Free(internal->initial_infectiousB);
  internal->initial_infectiousB = (double*) Calloc(internal->dim_infectiousB, double);
  Free(internal->initial_Lwt);
  internal->initial_Lwt = (double*) Calloc(internal->dim_Lwt, double);
  Free(internal->initial_Mwt_E1);
  internal->initial_Mwt_E1 = (double*) Calloc(internal->dim_Mwt_E1, double);
  Free(internal->initial_Mwt_E2);
  internal->initial_Mwt_E2 = (double*) Calloc(internal->dim_Mwt_E2, double);
  Free(internal->initial_Mwt_I1);
  internal->initial_Mwt_I1 = (double*) Calloc(internal->dim_Mwt_I1, double);
  Free(internal->initial_Mwt_S);
  internal->initial_Mwt_S = (double*) Calloc(internal->dim_Mwt_S, double);
  Free(internal->Kc);
  internal->Kc = (double*) Calloc(internal->dim_Kc, double);
  Free(internal->L_deathrt);
  internal->L_deathrt = (double*) Calloc(internal->dim_L_deathrt, double);
  Free(internal->L_dr);
  internal->L_dr = (double*) Calloc(internal->dim_L_dr, double);
  Free(internal->Lwt_birth);
  internal->Lwt_birth = (double*) Calloc(internal->dim_Lwt_birth, double);
  Free(internal->Lwt_birth_lambda);
  internal->Lwt_birth_lambda = (double*) Calloc(internal->dim_Lwt_birth_lambda, double);
  Free(internal->Lwt_mature);
  internal->Lwt_mature = (double*) Calloc(internal->dim_Lwt_mature, double);
  Free(internal->Lwt_mature_prob);
  internal->Lwt_mature_prob = (double*) Calloc(internal->dim_Lwt_mature_prob, double);
  Free(internal->Mwt_E1_incub);
  internal->Mwt_E1_incub = (double*) Calloc(internal->dim_Mwt_E1_incub, double);
  Free(internal->Mwt_E1_incub_prob);
  internal->Mwt_E1_incub_prob = (double*) Calloc(internal->dim_Mwt_E1_incub_prob, double);
  Free(internal->Mwt_E2_incub);
  internal->Mwt_E2_incub = (double*) Calloc(internal->dim_Mwt_E2_incub, double);
  Free(internal->Mwt_E2_incub_prob);
  internal->Mwt_E2_incub_prob = (double*) Calloc(internal->dim_Mwt_E2_incub_prob, double);
  Free(internal->Mwt_FOI1);
  internal->Mwt_FOI1 = (double*) Calloc(internal->dim_Mwt_FOI1, double);
  Free(internal->Mwt_inf1);
  internal->Mwt_inf1 = (double*) Calloc(internal->dim_Mwt_inf1, double);
  Free(internal->Mwt_inf1_prob);
  internal->Mwt_inf1_prob = (double*) Calloc(internal->dim_Mwt_inf1_prob, double);
  Free(internal->Mwt_tot);
  internal->Mwt_tot = (double*) Calloc(internal->dim_Mwt_tot, double);
  Free(internal->NTp);
  internal->NTp = (double*) Calloc(internal->dim_NTp, double);
  Free(internal->O_I1_prob);
  internal->O_I1_prob = (double*) Calloc(internal->dim_O_I1_prob, double);
  Free(internal->O_Lwt);
  internal->O_Lwt = (double*) Calloc(internal->dim_O_Lwt, double);
  Free(internal->O_Lwt_prob);
  internal->O_Lwt_prob = (double*) Calloc(internal->dim_O_Lwt_prob, double);
  Free(internal->O_Mwt_E1);
  internal->O_Mwt_E1 = (double*) Calloc(internal->dim_O_Mwt_E1, double);
  Free(internal->O_Mwt_E1_prob);
  internal->O_Mwt_E1_prob = (double*) Calloc(internal->dim_O_Mwt_E1_prob, double);
  Free(internal->O_Mwt_E2);
  internal->O_Mwt_E2 = (double*) Calloc(internal->dim_O_Mwt_E2, double);
  Free(internal->O_Mwt_E2_prob);
  internal->O_Mwt_E2_prob = (double*) Calloc(internal->dim_O_Mwt_E2_prob, double);
  Free(internal->O_Mwt_I1);
  internal->O_Mwt_I1 = (double*) Calloc(internal->dim_O_Mwt_I1, double);
  Free(internal->O_Mwt_I1_prob);
  internal->O_Mwt_I1_prob = (double*) Calloc(internal->dim_O_Mwt_I1_prob, double);
  Free(internal->O_Mwt_S);
  internal->O_Mwt_S = (double*) Calloc(internal->dim_O_Mwt_S, double);
  Free(internal->O_Mwt_S_prob);
  internal->O_Mwt_S_prob = (double*) Calloc(internal->dim_O_Mwt_S_prob, double);
  Free(internal->O_R1_prob);
  internal->O_R1_prob = (double*) Calloc(internal->dim_O_R1_prob, double);
  Free(internal->prop_Sp);
  internal->prop_Sp = (double*) Calloc(internal->dim_prop_Sp, double);
  Free(internal->recov1_prob);
  internal->recov1_prob = (double*) Calloc(internal->dim_recov1_prob, double);
  Free(internal->Y1T);
  internal->Y1T = (double*) Calloc(internal->dim_Y1T, double);
  internal->deathrt = (double*) user_get_array(user, false, internal->deathrt, "deathrt", NA_REAL, NA_REAL, 1, internal->dim_deathrt);
  internal->dim_age_I1_1 = internal->vnc_row;
  internal->dim_age_I1_2 = 2;
  internal->dim_age_I1_3 = internal->NP;
  internal->dim_age_I1_trials = internal->dim_age_I1_trials_1 * internal->dim_age_I1_trials_2 * internal->dim_age_I1_trials_3;
  internal->dim_age_I1_trials_12 = internal->dim_age_I1_trials_1 * internal->dim_age_I1_trials_2;
  internal->dim_age_R1_1 = internal->vnc_row;
  internal->dim_age_R1_2 = 2;
  internal->dim_age_R1_3 = internal->NP;
  internal->dim_age_S = internal->dim_age_S_1 * internal->dim_age_S_2 * internal->dim_age_S_3;
  internal->dim_age_S_12 = internal->dim_age_S_1 * internal->dim_age_S_2;
  internal->dim_age_S_trials = internal->dim_age_S_trials_1 * internal->dim_age_S_trials_2 * internal->dim_age_S_trials_3;
  internal->dim_age_S_trials_12 = internal->dim_age_S_trials_1 * internal->dim_age_S_trials_2;
  internal->dim_I1 = internal->dim_I1_1 * internal->dim_I1_2 * internal->dim_I1_3;
  internal->dim_I1_12 = internal->dim_I1_1 * internal->dim_I1_2;
  internal->dim_inf_1 = internal->dim_inf_1_1 * internal->dim_inf_1_2 * internal->dim_inf_1_3;
  internal->dim_inf_1_12 = internal->dim_inf_1_1 * internal->dim_inf_1_2;
  internal->dim_inf_1_prob = internal->dim_inf_1_prob_1 * internal->dim_inf_1_prob_2 * internal->dim_inf_1_prob_3;
  internal->dim_inf_1_prob_12 = internal->dim_inf_1_prob_1 * internal->dim_inf_1_prob_2;
  internal->dim_init_I1 = internal->dim_init_I1_1 * internal->dim_init_I1_2 * internal->dim_init_I1_3;
  internal->dim_init_I1_12 = internal->dim_init_I1_1 * internal->dim_init_I1_2;
  internal->dim_init_R1 = internal->dim_init_R1_1 * internal->dim_init_R1_2 * internal->dim_init_R1_3;
  internal->dim_init_R1_12 = internal->dim_init_R1_1 * internal->dim_init_R1_2;
  internal->dim_init_S = internal->dim_init_S_1 * internal->dim_init_S_2 * internal->dim_init_S_3;
  internal->dim_init_S_12 = internal->dim_init_S_1 * internal->dim_init_S_2;
  internal->dim_nn = internal->dim_nn_1 * internal->dim_nn_2;
  internal->dim_Ntotal = internal->dim_Ntotal_1 * internal->dim_Ntotal_2 * internal->dim_Ntotal_3;
  internal->dim_Ntotal_12 = internal->dim_Ntotal_1 * internal->dim_Ntotal_2;
  internal->dim_Ntotal_sum = internal->dim_Ntotal_sum_1 * internal->dim_Ntotal_sum_2;
  internal->dim_O_I1 = internal->dim_O_I1_1 * internal->dim_O_I1_2 * internal->dim_O_I1_3;
  internal->dim_O_I1_12 = internal->dim_O_I1_1 * internal->dim_O_I1_2;
  internal->dim_O_R1 = internal->dim_O_R1_1 * internal->dim_O_R1_2 * internal->dim_O_R1_3;
  internal->dim_O_R1_12 = internal->dim_O_R1_1 * internal->dim_O_R1_2;
  internal->dim_O_S = internal->dim_O_S_1 * internal->dim_O_S_2 * internal->dim_O_S_3;
  internal->dim_O_S_12 = internal->dim_O_S_1 * internal->dim_O_S_2;
  internal->dim_O_S_prob = internal->dim_O_S_prob_1 * internal->dim_O_S_prob_2 * internal->dim_O_S_prob_3;
  internal->dim_O_S_prob_12 = internal->dim_O_S_prob_1 * internal->dim_O_S_prob_2;
  internal->dim_R1 = internal->dim_R1_1 * internal->dim_R1_2 * internal->dim_R1_3;
  internal->dim_R1_12 = internal->dim_R1_1 * internal->dim_R1_2;
  internal->dim_recov1 = internal->dim_recov1_1 * internal->dim_recov1_2 * internal->dim_recov1_3;
  internal->dim_recov1_12 = internal->dim_recov1_1 * internal->dim_recov1_2;
  internal->dim_S = internal->dim_S_1 * internal->dim_S_2 * internal->dim_S_3;
  internal->dim_S_12 = internal->dim_S_1 * internal->dim_S_2;
  internal->dim_sum_S = internal->dim_sum_S_1 * internal->dim_sum_S_2;
  internal->dim_Y1 = internal->dim_Y1_1 * internal->dim_Y1_2 * internal->dim_Y1_3;
  internal->dim_Y1_12 = internal->dim_Y1_1 * internal->dim_Y1_2;
  internal->dim_Y1T_sum = internal->dim_Y1T_sum_1 * internal->dim_Y1T_sum_2;
  for (int i = 1; i <= internal->dim_incubA; ++i) {
    internal->initial_incubA[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_incubB; ++i) {
    internal->initial_incubB[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_infectiousA; ++i) {
    internal->initial_infectiousA[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_infectiousB; ++i) {
    internal->initial_infectiousB[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwt_E1; ++i) {
    internal->initial_Mwt_E1[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwt_E2; ++i) {
    internal->initial_Mwt_E2[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Mwt_I1; ++i) {
    internal->initial_Mwt_I1[i - 1] = 0;
  }
  internal->Mwt = (double*) user_get_array(user, false, internal->Mwt, "Mwt", NA_REAL, NA_REAL, 1, internal->dim_Mwt);
  internal->N_eq = (double*) user_get_array(user, false, internal->N_eq, "N_eq", NA_REAL, NA_REAL, 1, internal->dim_N_eq);
  internal->Nb = (double*) user_get_array(user, false, internal->Nb, "Nb", NA_REAL, NA_REAL, 1, internal->dim_Nb);
  internal->offset_output_births = 7 + internal->dim_agert + internal->dim_deathrt;
  internal->offset_output_deathrt = 7 + internal->dim_agert;
  internal->offset_output_Delta = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip;
  internal->offset_output_eip = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc;
  internal->offset_output_FOI1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T;
  internal->offset_output_FOI1nn = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p;
  internal->offset_output_FOI1p = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1;
  internal->offset_output_FOI1Y = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp;
  internal->offset_output_infectious1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1;
  internal->offset_output_Kc = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y;
  internal->offset_output_Lwt_birth = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot;
  internal->offset_output_Lwt_mature = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S;
  internal->offset_output_Mwt_FOI1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp;
  internal->offset_output_Mwt_inf1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth;
  internal->offset_output_Mwt_tot = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1;
  internal->offset_output_Ntotal = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature;
  internal->offset_output_NTp = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta;
  internal->offset_output_O_Mwt_E1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1;
  internal->offset_output_O_Mwt_S = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1;
  internal->offset_output_prop_Sp = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn;
  internal->offset_output_rho1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1;
  internal->offset_output_Y1T = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births;
  internal->offset_variable_incubA = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1;
  internal->offset_variable_incubB = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_incubA;
  internal->offset_variable_infectiousA = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_incubA + internal->dim_incubB;
  internal->offset_variable_infectiousB = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA;
  internal->offset_variable_Mwt_E1 = internal->dim_Lwt + internal->dim_Mwt_S;
  internal->offset_variable_Mwt_E2 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1;
  internal->offset_variable_Mwt_I1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2;
  internal->offset_variable_S = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB;
  internal->season_amp = (double*) user_get_array(user, false, internal->season_amp, "season_amp", NA_REAL, NA_REAL, 1, internal->dim_season_amp);
  internal->season_phase = (double*) user_get_array(user, false, internal->season_phase, "season_phase", NA_REAL, NA_REAL, 1, internal->dim_season_phase);
  Free(internal->age_I1_trials);
  internal->age_I1_trials = (double*) Calloc(internal->dim_age_I1_trials, double);
  Free(internal->age_S);
  internal->age_S = (double*) Calloc(internal->dim_age_S, double);
  Free(internal->age_S_trials);
  internal->age_S_trials = (double*) Calloc(internal->dim_age_S_trials, double);
  Free(internal->inf_1);
  internal->inf_1 = (double*) Calloc(internal->dim_inf_1, double);
  Free(internal->inf_1_prob);
  internal->inf_1_prob = (double*) Calloc(internal->dim_inf_1_prob, double);
  Free(internal->initial_I1);
  internal->initial_I1 = (double*) Calloc(internal->dim_I1, double);
  Free(internal->initial_R1);
  internal->initial_R1 = (double*) Calloc(internal->dim_R1, double);
  Free(internal->initial_S);
  internal->initial_S = (double*) Calloc(internal->dim_S, double);
  Free(internal->Ntotal);
  internal->Ntotal = (double*) Calloc(internal->dim_Ntotal, double);
  Free(internal->Ntotal_sum);
  internal->Ntotal_sum = (double*) Calloc(internal->dim_Ntotal_sum, double);
  Free(internal->O_I1);
  internal->O_I1 = (double*) Calloc(internal->dim_O_I1, double);
  Free(internal->O_R1);
  internal->O_R1 = (double*) Calloc(internal->dim_O_R1, double);
  Free(internal->O_S);
  internal->O_S = (double*) Calloc(internal->dim_O_S, double);
  Free(internal->O_S_prob);
  internal->O_S_prob = (double*) Calloc(internal->dim_O_S_prob, double);
  Free(internal->recov1);
  internal->recov1 = (double*) Calloc(internal->dim_recov1, double);
  Free(internal->sum_S);
  internal->sum_S = (double*) Calloc(internal->dim_sum_S, double);
  Free(internal->Y1);
  internal->Y1 = (double*) Calloc(internal->dim_Y1, double);
  Free(internal->Y1T_sum);
  internal->Y1T_sum = (double*) Calloc(internal->dim_Y1T_sum, double);
  for (int i = 1; i <= internal->dim_births_lambda; ++i) {
    internal->births_lambda[i - 1] = internal->DT * internal->Nb[i - 1] / (double) internal->YL;
  }
  internal->dim_age_I1 = internal->dim_age_I1_1 * internal->dim_age_I1_2 * internal->dim_age_I1_3;
  internal->dim_age_I1_12 = internal->dim_age_I1_1 * internal->dim_age_I1_2;
  internal->dim_age_R1 = internal->dim_age_R1_1 * internal->dim_age_R1_2 * internal->dim_age_R1_3;
  internal->dim_age_R1_12 = internal->dim_age_R1_1 * internal->dim_age_R1_2;
  internal->init_I1 = (double*) user_get_array(user, false, internal->init_I1, "init_I1", NA_REAL, NA_REAL, 3, internal->dim_init_I1_1, internal->dim_init_I1_2, internal->dim_init_I1_3);
  internal->init_R1 = (double*) user_get_array(user, false, internal->init_R1, "init_R1", NA_REAL, NA_REAL, 3, internal->dim_init_R1_1, internal->dim_init_R1_2, internal->dim_init_R1_3);
  internal->init_S = (double*) user_get_array(user, false, internal->init_S, "init_S", NA_REAL, NA_REAL, 3, internal->dim_init_S_1, internal->dim_init_S_2, internal->dim_init_S_3);
  for (int i = 1; i <= internal->dim_Mwt_S; ++i) {
    internal->initial_Mwt_S[i - 1] = trunc(internal->Mwt[i - 1] * internal->N_eq[i - 1]);
  }
  internal->nn = (int*) user_get_array(user, true, internal->nn, "nn", NA_REAL, NA_REAL, 2, internal->dim_nn_1, internal->dim_nn_2);
  internal->offset_output_age_I1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1;
  internal->offset_output_age_S = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1;
  internal->offset_output_inf_1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S;
  internal->offset_output_O_I1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S;
  internal->offset_output_O_S = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal;
  internal->offset_output_recov1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1;
  internal->offset_variable_I1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB + internal->dim_S;
  internal->offset_variable_R1 = internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB + internal->dim_S + internal->dim_I1;
  Free(internal->age_I1);
  internal->age_I1 = (double*) Calloc(internal->dim_age_I1, double);
  Free(internal->age_R1);
  internal->age_R1 = (double*) Calloc(internal->dim_age_R1, double);
  for (int i = 1; i <= internal->dim_I1_1; ++i) {
    for (int j = 1; j <= internal->dim_I1_2; ++j) {
      for (int k = 1; k <= internal->dim_I1_3; ++k) {
        internal->initial_I1[i - 1 + internal->dim_I1_1 * (j - 1) + internal->dim_I1_12 * (k - 1)] = internal->init_I1[internal->dim_init_I1_12 * (k - 1) + internal->dim_init_I1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_R1_1; ++i) {
    for (int j = 1; j <= internal->dim_R1_2; ++j) {
      for (int k = 1; k <= internal->dim_R1_3; ++k) {
        internal->initial_R1[i - 1 + internal->dim_R1_1 * (j - 1) + internal->dim_R1_12 * (k - 1)] = internal->init_R1[internal->dim_init_R1_12 * (k - 1) + internal->dim_init_R1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_S_1; ++i) {
    for (int j = 1; j <= internal->dim_S_2; ++j) {
      for (int k = 1; k <= internal->dim_S_3; ++k) {
        internal->initial_S[i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = internal->init_S[internal->dim_init_S_12 * (k - 1) + internal->dim_init_S_1 * (j - 1) + i - 1];
      }
    }
  }
  internal->offset_output_age_R1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1;
  internal->offset_output_inf_1_prob = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1;
  internal->offset_output_O_R1 = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1;
  internal->offset_output_O_S_prob = 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1 + internal->dim_inf_1_prob;
  return R_NilValue;
}
SEXP odin_model_stoch_metadata(SEXP internal_p) {
  odin_model_stoch_internal *internal = odin_model_stoch_get_internal(internal_p, 1);
  SEXP ret = PROTECT(allocVector(VECSXP, 4));
  SEXP nms = PROTECT(allocVector(STRSXP, 4));
  SET_STRING_ELT(nms, 0, mkChar("variable_order"));
  SET_STRING_ELT(nms, 1, mkChar("output_order"));
  SET_STRING_ELT(nms, 2, mkChar("n_out"));
  SET_STRING_ELT(nms, 3, mkChar("interpolate_t"));
  setAttrib(ret, R_NamesSymbol, nms);
  SEXP variable_length = PROTECT(allocVector(VECSXP, 12));
  SEXP variable_names = PROTECT(allocVector(STRSXP, 12));
  setAttrib(variable_length, R_NamesSymbol, variable_names);
  SET_VECTOR_ELT(variable_length, 0, ScalarInteger(internal->dim_Lwt));
  SET_VECTOR_ELT(variable_length, 1, ScalarInteger(internal->dim_Mwt_S));
  SET_VECTOR_ELT(variable_length, 2, ScalarInteger(internal->dim_Mwt_E1));
  SET_VECTOR_ELT(variable_length, 3, ScalarInteger(internal->dim_Mwt_E2));
  SET_VECTOR_ELT(variable_length, 4, ScalarInteger(internal->dim_Mwt_I1));
  SET_VECTOR_ELT(variable_length, 5, ScalarInteger(internal->dim_incubA));
  SET_VECTOR_ELT(variable_length, 6, ScalarInteger(internal->dim_incubB));
  SET_VECTOR_ELT(variable_length, 7, ScalarInteger(internal->dim_infectiousA));
  SET_VECTOR_ELT(variable_length, 8, ScalarInteger(internal->dim_infectiousB));
  SET_VECTOR_ELT(variable_length, 9, allocVector(INTSXP, 3));
  int * dim_S = INTEGER(VECTOR_ELT(variable_length, 9));
  dim_S[0] = internal->dim_S_1;
  dim_S[1] = internal->dim_S_2;
  dim_S[2] = internal->dim_S_3;
  SET_VECTOR_ELT(variable_length, 10, allocVector(INTSXP, 3));
  int * dim_I1 = INTEGER(VECTOR_ELT(variable_length, 10));
  dim_I1[0] = internal->dim_I1_1;
  dim_I1[1] = internal->dim_I1_2;
  dim_I1[2] = internal->dim_I1_3;
  SET_VECTOR_ELT(variable_length, 11, allocVector(INTSXP, 3));
  int * dim_R1 = INTEGER(VECTOR_ELT(variable_length, 11));
  dim_R1[0] = internal->dim_R1_1;
  dim_R1[1] = internal->dim_R1_2;
  dim_R1[2] = internal->dim_R1_3;
  SET_STRING_ELT(variable_names, 0, mkChar("Lwt"));
  SET_STRING_ELT(variable_names, 1, mkChar("Mwt_S"));
  SET_STRING_ELT(variable_names, 2, mkChar("Mwt_E1"));
  SET_STRING_ELT(variable_names, 3, mkChar("Mwt_E2"));
  SET_STRING_ELT(variable_names, 4, mkChar("Mwt_I1"));
  SET_STRING_ELT(variable_names, 5, mkChar("incubA"));
  SET_STRING_ELT(variable_names, 6, mkChar("incubB"));
  SET_STRING_ELT(variable_names, 7, mkChar("infectiousA"));
  SET_STRING_ELT(variable_names, 8, mkChar("infectiousB"));
  SET_STRING_ELT(variable_names, 9, mkChar("S"));
  SET_STRING_ELT(variable_names, 10, mkChar("I1"));
  SET_STRING_ELT(variable_names, 11, mkChar("R1"));
  SET_VECTOR_ELT(ret, 0, variable_length);
  UNPROTECT(2);
  SEXP output_length = PROTECT(allocVector(VECSXP, 40));
  SEXP output_names = PROTECT(allocVector(STRSXP, 40));
  setAttrib(output_length, R_NamesSymbol, output_names);
  SET_VECTOR_ELT(output_length, 0, R_NilValue);
  SET_VECTOR_ELT(output_length, 1, R_NilValue);
  SET_VECTOR_ELT(output_length, 2, R_NilValue);
  SET_VECTOR_ELT(output_length, 3, R_NilValue);
  SET_VECTOR_ELT(output_length, 4, R_NilValue);
  SET_VECTOR_ELT(output_length, 5, R_NilValue);
  SET_VECTOR_ELT(output_length, 6, R_NilValue);
  SET_VECTOR_ELT(output_length, 7, ScalarInteger(internal->dim_agert));
  SET_VECTOR_ELT(output_length, 8, ScalarInteger(internal->dim_deathrt));
  SET_VECTOR_ELT(output_length, 9, ScalarInteger(internal->dim_births));
  SET_VECTOR_ELT(output_length, 10, ScalarInteger(internal->dim_Y1T));
  SET_VECTOR_ELT(output_length, 11, ScalarInteger(internal->dim_FOI1));
  SET_VECTOR_ELT(output_length, 12, ScalarInteger(internal->dim_FOI1p));
  SET_VECTOR_ELT(output_length, 13, ScalarInteger(internal->dim_FOI1nn));
  SET_VECTOR_ELT(output_length, 14, ScalarInteger(internal->dim_prop_Sp));
  SET_VECTOR_ELT(output_length, 15, ScalarInteger(internal->dim_FOI1Y));
  SET_VECTOR_ELT(output_length, 16, ScalarInteger(internal->dim_Kc));
  SET_VECTOR_ELT(output_length, 17, ScalarInteger(internal->dim_eip));
  SET_VECTOR_ELT(output_length, 18, ScalarInteger(internal->dim_Delta));
  SET_VECTOR_ELT(output_length, 19, ScalarInteger(internal->dim_NTp));
  SET_VECTOR_ELT(output_length, 20, ScalarInteger(internal->dim_Mwt_FOI1));
  SET_VECTOR_ELT(output_length, 21, ScalarInteger(internal->dim_rho1));
  SET_VECTOR_ELT(output_length, 22, ScalarInteger(internal->dim_infectious1));
  SET_VECTOR_ELT(output_length, 23, ScalarInteger(internal->dim_Mwt_tot));
  SET_VECTOR_ELT(output_length, 24, ScalarInteger(internal->dim_Lwt_birth));
  SET_VECTOR_ELT(output_length, 25, ScalarInteger(internal->dim_Mwt_inf1));
  SET_VECTOR_ELT(output_length, 26, ScalarInteger(internal->dim_O_Mwt_E1));
  SET_VECTOR_ELT(output_length, 27, ScalarInteger(internal->dim_O_Mwt_S));
  SET_VECTOR_ELT(output_length, 28, ScalarInteger(internal->dim_Lwt_mature));
  SET_VECTOR_ELT(output_length, 29, allocVector(INTSXP, 3));
  int * dim_Ntotal = INTEGER(VECTOR_ELT(output_length, 29));
  dim_Ntotal[0] = internal->dim_Ntotal_1;
  dim_Ntotal[1] = internal->dim_Ntotal_2;
  dim_Ntotal[2] = internal->dim_Ntotal_3;
  SET_VECTOR_ELT(output_length, 30, allocVector(INTSXP, 3));
  int * dim_O_S = INTEGER(VECTOR_ELT(output_length, 30));
  dim_O_S[0] = internal->dim_O_S_1;
  dim_O_S[1] = internal->dim_O_S_2;
  dim_O_S[2] = internal->dim_O_S_3;
  SET_VECTOR_ELT(output_length, 31, allocVector(INTSXP, 3));
  int * dim_inf_1 = INTEGER(VECTOR_ELT(output_length, 31));
  dim_inf_1[0] = internal->dim_inf_1_1;
  dim_inf_1[1] = internal->dim_inf_1_2;
  dim_inf_1[2] = internal->dim_inf_1_3;
  SET_VECTOR_ELT(output_length, 32, allocVector(INTSXP, 3));
  int * dim_age_S = INTEGER(VECTOR_ELT(output_length, 32));
  dim_age_S[0] = internal->dim_age_S_1;
  dim_age_S[1] = internal->dim_age_S_2;
  dim_age_S[2] = internal->dim_age_S_3;
  SET_VECTOR_ELT(output_length, 33, allocVector(INTSXP, 3));
  int * dim_O_I1 = INTEGER(VECTOR_ELT(output_length, 33));
  dim_O_I1[0] = internal->dim_O_I1_1;
  dim_O_I1[1] = internal->dim_O_I1_2;
  dim_O_I1[2] = internal->dim_O_I1_3;
  SET_VECTOR_ELT(output_length, 34, allocVector(INTSXP, 3));
  int * dim_recov1 = INTEGER(VECTOR_ELT(output_length, 34));
  dim_recov1[0] = internal->dim_recov1_1;
  dim_recov1[1] = internal->dim_recov1_2;
  dim_recov1[2] = internal->dim_recov1_3;
  SET_VECTOR_ELT(output_length, 35, allocVector(INTSXP, 3));
  int * dim_age_I1 = INTEGER(VECTOR_ELT(output_length, 35));
  dim_age_I1[0] = internal->dim_age_I1_1;
  dim_age_I1[1] = internal->dim_age_I1_2;
  dim_age_I1[2] = internal->dim_age_I1_3;
  SET_VECTOR_ELT(output_length, 36, allocVector(INTSXP, 3));
  int * dim_O_R1 = INTEGER(VECTOR_ELT(output_length, 36));
  dim_O_R1[0] = internal->dim_O_R1_1;
  dim_O_R1[1] = internal->dim_O_R1_2;
  dim_O_R1[2] = internal->dim_O_R1_3;
  SET_VECTOR_ELT(output_length, 37, allocVector(INTSXP, 3));
  int * dim_age_R1 = INTEGER(VECTOR_ELT(output_length, 37));
  dim_age_R1[0] = internal->dim_age_R1_1;
  dim_age_R1[1] = internal->dim_age_R1_2;
  dim_age_R1[2] = internal->dim_age_R1_3;
  SET_VECTOR_ELT(output_length, 38, allocVector(INTSXP, 3));
  int * dim_inf_1_prob = INTEGER(VECTOR_ELT(output_length, 38));
  dim_inf_1_prob[0] = internal->dim_inf_1_prob_1;
  dim_inf_1_prob[1] = internal->dim_inf_1_prob_2;
  dim_inf_1_prob[2] = internal->dim_inf_1_prob_3;
  SET_VECTOR_ELT(output_length, 39, allocVector(INTSXP, 3));
  int * dim_O_S_prob = INTEGER(VECTOR_ELT(output_length, 39));
  dim_O_S_prob[0] = internal->dim_O_S_prob_1;
  dim_O_S_prob[1] = internal->dim_O_S_prob_2;
  dim_O_S_prob[2] = internal->dim_O_S_prob_3;
  SET_STRING_ELT(output_names, 0, mkChar("FOI1av"));
  SET_STRING_ELT(output_names, 1, mkChar("Deltaav"));
  SET_STRING_ELT(output_names, 2, mkChar("Kcav"));
  SET_STRING_ELT(output_names, 3, mkChar("eipav"));
  SET_STRING_ELT(output_names, 4, mkChar("MwtCont"));
  SET_STRING_ELT(output_names, 5, mkChar("Mwt_FOI1av"));
  SET_STRING_ELT(output_names, 6, mkChar("TIME"));
  SET_STRING_ELT(output_names, 7, mkChar("agert"));
  SET_STRING_ELT(output_names, 8, mkChar("deathrt"));
  SET_STRING_ELT(output_names, 9, mkChar("births"));
  SET_STRING_ELT(output_names, 10, mkChar("Y1T"));
  SET_STRING_ELT(output_names, 11, mkChar("FOI1"));
  SET_STRING_ELT(output_names, 12, mkChar("FOI1p"));
  SET_STRING_ELT(output_names, 13, mkChar("FOI1nn"));
  SET_STRING_ELT(output_names, 14, mkChar("prop_Sp"));
  SET_STRING_ELT(output_names, 15, mkChar("FOI1Y"));
  SET_STRING_ELT(output_names, 16, mkChar("Kc"));
  SET_STRING_ELT(output_names, 17, mkChar("eip"));
  SET_STRING_ELT(output_names, 18, mkChar("Delta"));
  SET_STRING_ELT(output_names, 19, mkChar("NTp"));
  SET_STRING_ELT(output_names, 20, mkChar("Mwt_FOI1"));
  SET_STRING_ELT(output_names, 21, mkChar("rho1"));
  SET_STRING_ELT(output_names, 22, mkChar("infectious1"));
  SET_STRING_ELT(output_names, 23, mkChar("Mwt_tot"));
  SET_STRING_ELT(output_names, 24, mkChar("Lwt_birth"));
  SET_STRING_ELT(output_names, 25, mkChar("Mwt_inf1"));
  SET_STRING_ELT(output_names, 26, mkChar("O_Mwt_E1"));
  SET_STRING_ELT(output_names, 27, mkChar("O_Mwt_S"));
  SET_STRING_ELT(output_names, 28, mkChar("Lwt_mature"));
  SET_STRING_ELT(output_names, 29, mkChar("Ntotal"));
  SET_STRING_ELT(output_names, 30, mkChar("O_S"));
  SET_STRING_ELT(output_names, 31, mkChar("inf_1"));
  SET_STRING_ELT(output_names, 32, mkChar("age_S"));
  SET_STRING_ELT(output_names, 33, mkChar("O_I1"));
  SET_STRING_ELT(output_names, 34, mkChar("recov1"));
  SET_STRING_ELT(output_names, 35, mkChar("age_I1"));
  SET_STRING_ELT(output_names, 36, mkChar("O_R1"));
  SET_STRING_ELT(output_names, 37, mkChar("age_R1"));
  SET_STRING_ELT(output_names, 38, mkChar("inf_1_prob"));
  SET_STRING_ELT(output_names, 39, mkChar("O_S_prob"));
  SET_VECTOR_ELT(ret, 1, output_length);
  UNPROTECT(2);
  SET_VECTOR_ELT(ret, 2, ScalarInteger(7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1 + internal->dim_inf_1_prob + internal->dim_O_S_prob));
  UNPROTECT(2);
  return ret;
}
SEXP odin_model_stoch_initial_conditions(SEXP internal_p, SEXP step_ptr) {
  int step = INTEGER(step_ptr)[0];
  odin_model_stoch_internal *internal = odin_model_stoch_get_internal(internal_p, 1);
  GetRNGstate();
  double TIME = step * internal->DT;
  double MwtCont = ((TIME >= internal->TimeMwtControlOn * internal->YL) && (TIME < internal->TimeMwtControlOff * internal->YL) ? (1 - internal->propMwtControl) : 1);
  double DeltaMean = internal->DeltaBase / (double) MwtCont;
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->Delta[i - 1] = DeltaMean / (double) (1 + internal->season_amp[i - 1] * internal->Delta_season * cos(2 * internal->pi * (TIME + internal->season_phase[i - 1]) / (double) internal->YL));
  }
  {
     int i = internal->NP;
     internal->Delta[i - 1] = DeltaMean;
  }
  for (int i = 1; i <= internal->dim_Lwt; ++i) {
    internal->initial_Lwt[i - 1] = trunc(internal->Mwt[i - 1] * internal->N_eq[i - 1] * internal->Delta[i - 1] / (double) internal->Epsilon);
  }
  PutRNGstate();
  SEXP r_state = PROTECT(allocVector(REALSXP, internal->dim_Lwt + internal->dim_Mwt_S + internal->dim_Mwt_E1 + internal->dim_Mwt_E2 + internal->dim_Mwt_I1 + internal->dim_incubA + internal->dim_incubB + internal->dim_infectiousA + internal->dim_infectiousB + internal->dim_S + internal->dim_I1 + internal->dim_R1));
  double * state = REAL(r_state);
  memcpy(state + 0, internal->initial_Lwt, internal->dim_Lwt * sizeof(double));
  memcpy(state + internal->dim_Lwt, internal->initial_Mwt_S, internal->dim_Mwt_S * sizeof(double));
  memcpy(state + internal->offset_variable_Mwt_E1, internal->initial_Mwt_E1, internal->dim_Mwt_E1 * sizeof(double));
  memcpy(state + internal->offset_variable_Mwt_E2, internal->initial_Mwt_E2, internal->dim_Mwt_E2 * sizeof(double));
  memcpy(state + internal->offset_variable_Mwt_I1, internal->initial_Mwt_I1, internal->dim_Mwt_I1 * sizeof(double));
  memcpy(state + internal->offset_variable_incubA, internal->initial_incubA, internal->dim_incubA * sizeof(double));
  memcpy(state + internal->offset_variable_incubB, internal->initial_incubB, internal->dim_incubB * sizeof(double));
  memcpy(state + internal->offset_variable_infectiousA, internal->initial_infectiousA, internal->dim_infectiousA * sizeof(double));
  memcpy(state + internal->offset_variable_infectiousB, internal->initial_infectiousB, internal->dim_infectiousB * sizeof(double));
  memcpy(state + internal->offset_variable_S, internal->initial_S, internal->dim_S * sizeof(double));
  memcpy(state + internal->offset_variable_I1, internal->initial_I1, internal->dim_I1 * sizeof(double));
  memcpy(state + internal->offset_variable_R1, internal->initial_R1, internal->dim_R1 * sizeof(double));
  UNPROTECT(1);
  return r_state;
}
void odin_model_stoch_rhs(odin_model_stoch_internal* internal, size_t step, double * state, double * state_next, double * output) {
  double * Lwt = state + 0;
  double * Mwt_S = state + internal->dim_Lwt;
  double * Mwt_E1 = state + internal->offset_variable_Mwt_E1;
  double * Mwt_E2 = state + internal->offset_variable_Mwt_E2;
  double * Mwt_I1 = state + internal->offset_variable_Mwt_I1;
  double * incubA = state + internal->offset_variable_incubA;
  double * incubB = state + internal->offset_variable_incubB;
  double * infectiousA = state + internal->offset_variable_infectiousA;
  double * infectiousB = state + internal->offset_variable_infectiousB;
  double * S = state + internal->offset_variable_S;
  double * I1 = state + internal->offset_variable_I1;
  double * R1 = state + internal->offset_variable_R1;
  double TIME = step * internal->DT;
  double agerts = (trunc(TIME / (double) internal->age_per) == TIME / (double) internal->age_per ? internal->age_per / (double) internal->YL : 0);
  double MwtCont = ((TIME >= internal->TimeMwtControlOn * internal->YL) && (TIME < internal->TimeMwtControlOff * internal->YL) ? (1 - internal->propMwtControl) : 1);
  for (int i = 1; i <= internal->dim_incubB; ++i) {
    state_next[internal->offset_variable_incubB + i - 1] = incubB[i - 1] + internal->DT * 2 * (incubA[i - 1] - incubB[i - 1]) / (double) internal->incub;
  }
  for (int i = 1; i <= internal->dim_infectiousA; ++i) {
    state_next[internal->offset_variable_infectiousA + i - 1] = infectiousA[i - 1] + internal->DT * 2 * (incubB[i - 1] / (double) internal->incub - infectiousA[i - 1] / (double) internal->inf_per);
  }
  for (int i = 1; i <= internal->dim_infectiousB; ++i) {
    state_next[internal->offset_variable_infectiousB + i - 1] = infectiousB[i - 1] + internal->DT * 2 * (infectiousA[i - 1] - infectiousB[i - 1]) / (double) internal->inf_per;
  }
  for (int i = 1; i <= internal->dim_agert; ++i) {
    internal->agert[i - 1] = agerts / (double) internal->agec[i - 1];
  }
  double DeltaMean = internal->DeltaBase / (double) MwtCont;
  for (int i = 1; i <= internal->dim_eip; ++i) {
    internal->eip[i - 1] = internal->eip_mean * (1 - internal->season_amp[i - 1] * internal->eip_season * cos(2 * internal->pi * (TIME + internal->season_phase[i - 1]) / (double) internal->YL));
  }
  for (int i = 1; i <= internal->dim_infectious1; ++i) {
    internal->infectious1[i - 1] = infectiousA[i - 1] + infectiousB[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_tot; ++i) {
    internal->Mwt_tot[i - 1] = Mwt_S[i - 1] + Mwt_E1[i - 1] + Mwt_E2[i - 1] + Mwt_I1[i - 1];
  }
  for (int i = 1; i <= internal->dim_age_I1_prob; ++i) {
    internal->age_I1_prob[i - 1] = fmax(fmin(internal->agert[i - 1] / (double) (internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_age_R1_prob; ++i) {
    internal->age_R1_prob[i - 1] = fmax(fmin(internal->agert[i - 1] / (double) (internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_age_S_prob; ++i) {
    internal->age_S_prob[i - 1] = fmax(fmin(internal->agert[i - 1] / (double) (internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_births; ++i) {
    internal->births[i - 1] = Rf_rpois(internal->births_lambda[i - 1]);
  }
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->Delta[i - 1] = DeltaMean / (double) (1 + internal->season_amp[i - 1] * internal->Delta_season * cos(2 * internal->pi * (TIME + internal->season_phase[i - 1]) / (double) internal->YL));
  }
  {
     int i = internal->NP;
     internal->Delta[i - 1] = DeltaMean;
  }
  double Gamma = internal->Rm * DeltaMean * (internal->Epsilon + internal->Sigma) / (double) internal->Epsilon;
  for (int i = 1; i <= internal->dim_Mwt_FOI1; ++i) {
    internal->Mwt_FOI1[i - 1] = internal->DT * internal->Beta_hm_1 * internal->Kappa * internal->infectious1[i - 1];
  }
  for (int i = 1; i <= internal->dim_Ntotal_1; ++i) {
    for (int j = 1; j <= internal->dim_Ntotal_2; ++j) {
      for (int k = 1; k <= internal->dim_Ntotal_3; ++k) {
        internal->Ntotal[i - 1 + internal->dim_Ntotal_1 * (j - 1) + internal->dim_Ntotal_12 * (k - 1)] = S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] + I1[internal->dim_I1_12 * (k - 1) + internal->dim_I1_1 * (j - 1) + i - 1] + R1[internal->dim_R1_12 * (k - 1) + internal->dim_R1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_O_I1_prob; ++i) {
    internal->O_I1_prob[i - 1] = fmax(fmin(internal->nu + internal->agert[i - 1] + internal->deathrt[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_R1_prob; ++i) {
    internal->O_R1_prob[i - 1] = fmax(fmin(internal->agert[i - 1] + internal->deathrt[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_recov1_prob; ++i) {
    internal->recov1_prob[i - 1] = fmax(fmin(internal->nu / (double) (internal->nu + internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
  }
  double Kc_mean = DeltaMean * (pow((internal->Epsilon * (Gamma - DeltaMean) / (double) (DeltaMean * internal->Sigma) - 1), (-(1) / (double) internal->Omega))) / (double) internal->Epsilon;
  for (int i = 1; i <= internal->dim_Lwt_birth_lambda; ++i) {
    internal->Lwt_birth_lambda[i - 1] = internal->DT * (Gamma * internal->Mwt_tot[i - 1] * (internal->Mwt_tot[i - 1] + (1 - internal->Wb_cyto) * 0) / (double) (internal->Mwt_tot[i - 1] + 0) + internal->Wb_fF * (1 - internal->Wb_mat) * 0);
  }
  for (int i = 1; i <= internal->dim_Mwt_E1_incub_prob; ++i) {
    internal->Mwt_E1_incub_prob[i - 1] = fmax(fmin(1 / (double) (internal->Delta[i - 1] * internal->eip[i - 1] / (double) 2 + 1), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwt_E2_incub_prob; ++i) {
    internal->Mwt_E2_incub_prob[i - 1] = fmax(fmin(1 / (double) (internal->Delta[i - 1] * internal->eip[i - 1] / (double) 2 + 1), 1), 0);
  }
  for (int i = 1; i <= internal->dim_Mwt_inf1_prob; ++i) {
    internal->Mwt_inf1_prob[i - 1] = fmax(fmin(internal->Mwt_FOI1[i - 1] / (double) (internal->DT * internal->Delta[i - 1] + internal->Mwt_FOI1[i - 1]), 1), 0);
  }
  {
     int i = 1;
     for (int j = 1; j <= internal->NP; ++j) {
       internal->Ntotal_sum[i - 1 + internal->dim_Ntotal_sum_1 * (j - 1)] = internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 0 + i - 1] + internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 1 + i - 1];
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    for (int j = 1; j <= internal->NP; ++j) {
      internal->Ntotal_sum[i - 1 + internal->dim_Ntotal_sum_1 * (j - 1)] = internal->Ntotal_sum[internal->dim_Ntotal_sum_1 * (j - 1) + i - 1 - 1] + internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 0 + i - 1] + internal->Ntotal[internal->dim_Ntotal_12 * (j - 1) + internal->dim_Ntotal_1 * 1 + i - 1];
    }
  }
  for (int i = 1; i <= internal->dim_O_I1_1; ++i) {
    for (int j = 1; j <= internal->dim_O_I1_2; ++j) {
      for (int k = 1; k <= internal->dim_O_I1_3; ++k) {
        internal->O_I1[i - 1 + internal->dim_O_I1_1 * (j - 1) + internal->dim_O_I1_12 * (k - 1)] = Rf_rbinom(round(I1[internal->dim_I1_12 * (k - 1) + internal->dim_I1_1 * (j - 1) + i - 1]), internal->O_I1_prob[i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E1_prob; ++i) {
    internal->O_Mwt_E1_prob[i - 1] = fmax(fmin(internal->DT * (internal->Delta[i - 1] + 2 / (double) internal->eip[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E2_prob; ++i) {
    internal->O_Mwt_E2_prob[i - 1] = fmax(fmin(internal->DT * (internal->Delta[i - 1] + 2 / (double) internal->eip[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_I1_prob; ++i) {
    internal->O_Mwt_I1_prob[i - 1] = fmax(fmin(internal->DT * internal->Delta[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_S_prob; ++i) {
    internal->O_Mwt_S_prob[i - 1] = fmax(fmin(internal->DT * internal->Delta[i - 1] + internal->Mwt_FOI1[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_R1_1; ++i) {
    for (int j = 1; j <= internal->dim_O_R1_2; ++j) {
      for (int k = 1; k <= internal->dim_O_R1_3; ++k) {
        internal->O_R1[i - 1 + internal->dim_O_R1_1 * (j - 1) + internal->dim_O_R1_12 * (k - 1)] = Rf_rbinom(round(R1[internal->dim_R1_12 * (k - 1) + internal->dim_R1_1 * (j - 1) + i - 1]), internal->O_R1_prob[i - 1]);
      }
    }
  }
  for (int i = 2; i <= internal->vnc_row; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        internal->age_R1[i - 1 + internal->dim_age_R1_1 * (j - 1) + internal->dim_age_R1_12 * (k - 1)] = Rf_rbinom(round(internal->O_R1[internal->dim_O_R1_12 * (k - 1) + internal->dim_O_R1_1 * (j - 1) + i - 1 - 1]), internal->age_R1_prob[i - 1 - 1]);
      }
    }
  }
  {
     int i = 1;
     for (int j = 1; j <= 2; ++j) {
       for (int k = 1; k <= internal->NP; ++k) {
         internal->age_R1[i - 1 + internal->dim_age_R1_1 * (j - 1) + internal->dim_age_R1_12 * (k - 1)] = 0;
       }
     }
  }
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->Kc[i - 1] = internal->Mwt[i - 1] * Kc_mean * (1 + internal->season_amp[i - 1] * internal->Kc_season * cos(2 * internal->pi * (TIME + internal->season_phase[i - 1]) / (double) internal->YL));
  }
  {
     int i = internal->NP;
     internal->Kc[i - 1] = MwtCont * internal->Mwt_mean * Kc_mean * (1 + internal->season_amp[i - 1] * internal->Kc_season * cos(2 * internal->pi * (TIME + internal->season_phase[i - 1]) / (double) internal->YL));
  }
  for (int i = 1; i <= internal->dim_Lwt_birth; ++i) {
    internal->Lwt_birth[i - 1] = Rf_rpois(internal->Lwt_birth_lambda[i - 1]);
  }
  for (int i = 1; i <= internal->dim_NTp; ++i) {
    internal->NTp[i - 1] = internal->Ntotal_sum[internal->dim_Ntotal_sum_1 * (i - 1) + internal->na - 1];
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E1; ++i) {
    internal->O_Mwt_E1[i - 1] = Rf_rbinom(round(Mwt_E1[i - 1]), internal->O_Mwt_E1_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_E2; ++i) {
    internal->O_Mwt_E2[i - 1] = Rf_rbinom(round(Mwt_E2[i - 1]), internal->O_Mwt_E2_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_I1; ++i) {
    internal->O_Mwt_I1[i - 1] = Rf_rbinom(round(Mwt_I1[i - 1]), internal->O_Mwt_I1_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_O_Mwt_S; ++i) {
    internal->O_Mwt_S[i - 1] = Rf_rbinom(round(Mwt_S[i - 1]), internal->O_Mwt_S_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_recov1_1; ++i) {
    for (int j = 1; j <= internal->dim_recov1_2; ++j) {
      for (int k = 1; k <= internal->dim_recov1_3; ++k) {
        internal->recov1[i - 1 + internal->dim_recov1_1 * (j - 1) + internal->dim_recov1_12 * (k - 1)] = Rf_rbinom(round(internal->O_I1[internal->dim_O_I1_12 * (k - 1) + internal->dim_O_I1_1 * (j - 1) + i - 1]), internal->recov1_prob[i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_age_I1_trials_1; ++i) {
    for (int j = 1; j <= internal->dim_age_I1_trials_2; ++j) {
      for (int k = 1; k <= internal->dim_age_I1_trials_3; ++k) {
        internal->age_I1_trials[i - 1 + internal->dim_age_I1_trials_1 * (j - 1) + internal->dim_age_I1_trials_12 * (k - 1)] = internal->O_I1[internal->dim_O_I1_12 * (k - 1) + internal->dim_O_I1_1 * (j - 1) + i - 1] - internal->recov1[internal->dim_recov1_12 * (k - 1) + internal->dim_recov1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_FOI1p; ++i) {
    internal->FOI1p[i - 1] = internal->DT * internal->Beta_mh_1 * internal->Kappa * (Mwt_I1[i - 1] + 0 * internal->Wb_relinf1) / (double) internal->NTp[i - 1];
  }
  for (int i = 1; i <= internal->dim_L_deathrt; ++i) {
    internal->L_deathrt[i - 1] = internal->DT * internal->Sigma * ((1 + pow(((Lwt[i - 1] + 0) / (double) (internal->Kc[i - 1] * internal->NTp[i - 1])), internal->Omega)));
  }
  for (int i = 1; i <= internal->dim_Mwt_E1_incub; ++i) {
    internal->Mwt_E1_incub[i - 1] = Rf_rbinom(round(internal->O_Mwt_E1[i - 1]), internal->Mwt_E1_incub_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_Mwt_E2_incub; ++i) {
    internal->Mwt_E2_incub[i - 1] = Rf_rbinom(round(internal->O_Mwt_E2[i - 1]), internal->Mwt_E2_incub_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_Mwt_inf1; ++i) {
    internal->Mwt_inf1[i - 1] = Rf_rbinom(round(internal->O_Mwt_S[i - 1]), internal->Mwt_inf1_prob[i - 1]);
  }
  for (int i = 1; i <= internal->na; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        state_next[internal->offset_variable_R1 + i - 1 + internal->dim_R1_1 * (j - 1) + internal->dim_R1_12 * (k - 1)] = trunc(0.5 + internal->age_R1[internal->dim_age_R1_12 * (k - 1) + internal->dim_age_R1_1 * (j - 1) + i - 1] + internal->recov1[internal->dim_recov1_12 * (k - 1) + internal->dim_recov1_1 * (j - 1) + i - 1] + R1[internal->dim_R1_12 * (k - 1) + internal->dim_R1_1 * (j - 1) + i - 1] - internal->O_R1[internal->dim_O_R1_12 * (k - 1) + internal->dim_O_R1_1 * (j - 1) + i - 1]);
      }
    }
  }
  for (int i = 2; i <= internal->vnc_row; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        internal->age_I1[i - 1 + internal->dim_age_I1_1 * (j - 1) + internal->dim_age_I1_12 * (k - 1)] = Rf_rbinom(round(internal->age_I1_trials[internal->dim_age_I1_trials_12 * (k - 1) + internal->dim_age_I1_trials_1 * (j - 1) + i - 1 - 1]), internal->age_I1_prob[i - 1 - 1]);
      }
    }
  }
  {
     int i = 1;
     for (int j = 1; j <= 2; ++j) {
       for (int k = 1; k <= internal->NP; ++k) {
         internal->age_I1[i - 1 + internal->dim_age_I1_1 * (j - 1) + internal->dim_age_I1_12 * (k - 1)] = 0;
       }
     }
  }
  double FOI1av = (odin_sum1(internal->FOI1p, 0, internal->dim_FOI1p) - internal->FOI1p[internal->NP - 1]) / (double) (internal->NP - 1);
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->FOI1nn[i - 1] = (internal->FOI1p[internal->nn[internal->dim_nn_1 * 0 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 1 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 2 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 3 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 4 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 5 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 6 + i - 1] - 1] + internal->FOI1p[internal->nn[internal->dim_nn_1 * 7 + i - 1] - 1]) / (double) 8;
  }
  for (int i = 1; i <= internal->dim_L_dr; ++i) {
    internal->L_dr[i - 1] = (internal->L_deathrt[i - 1] >= 1 ? 0.999 : internal->L_deathrt[i - 1]);
  }
  for (int i = 1; i <= internal->dim_Mwt_E1; ++i) {
    state_next[internal->offset_variable_Mwt_E1 + i - 1] = internal->Mwt_inf1[i - 1] + Mwt_E1[i - 1] - internal->O_Mwt_E1[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_E2; ++i) {
    state_next[internal->offset_variable_Mwt_E2 + i - 1] = internal->Mwt_E1_incub[i - 1] + Mwt_E2[i - 1] - internal->O_Mwt_E2[i - 1];
  }
  for (int i = 1; i <= internal->dim_Mwt_I1; ++i) {
    state_next[internal->offset_variable_Mwt_I1 + i - 1] = internal->Mwt_E2_incub[i - 1] + Mwt_I1[i - 1] - internal->O_Mwt_I1[i - 1];
  }
  for (int i = 1; i <= (internal->NP - 1); ++i) {
    internal->FOI1[i - 1] = internal->propTransNN * internal->FOI1nn[i - 1] + internal->propTransGlobal * FOI1av + (1 - internal->propTransGlobal - internal->propTransNN) * internal->FOI1p[i - 1] + internal->DT * internal->BG_FOI / (double) internal->YL;
  }
  {
     int i = internal->NP;
     internal->FOI1[i - 1] = 0;
  }
  for (int i = 1; i <= internal->dim_Lwt_mature_prob; ++i) {
    internal->Lwt_mature_prob[i - 1] = fmax(fmin(internal->DT * internal->Epsilon / (double) (internal->DT * internal->Epsilon + internal->L_dr[i - 1]), 1), 0);
  }
  for (int i = 1; i <= internal->dim_O_Lwt_prob; ++i) {
    internal->O_Lwt_prob[i - 1] = fmax(fmin(internal->DT * internal->Epsilon + internal->L_dr[i - 1], 1), 0);
  }
  for (int i = 1; i <= internal->dim_inf_1_prob_1; ++i) {
    for (int j = 1; j <= internal->dim_inf_1_prob_2; ++j) {
      for (int k = 1; k <= internal->dim_inf_1_prob_3; ++k) {
        internal->inf_1_prob[i - 1 + internal->dim_inf_1_prob_1 * (j - 1) + internal->dim_inf_1_prob_12 * (k - 1)] = fmax(fmin(internal->rho1[j - 1] * internal->FOI1[k - 1] / (double) (internal->rho1[j - 1] * internal->FOI1[k - 1] + internal->agert[i - 1] + internal->deathrt[i - 1]), 1), 0);
      }
    }
  }
  for (int i = 1; i <= internal->dim_O_Lwt; ++i) {
    internal->O_Lwt[i - 1] = Rf_rbinom(round(Lwt[i - 1]), internal->O_Lwt_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_O_S_prob_1; ++i) {
    for (int j = 1; j <= internal->dim_O_S_prob_2; ++j) {
      for (int k = 1; k <= internal->dim_O_S_prob_3; ++k) {
        internal->O_S_prob[i - 1 + internal->dim_O_S_prob_1 * (j - 1) + internal->dim_O_S_prob_12 * (k - 1)] = fmax(fmin(internal->rho1[j - 1] * internal->FOI1[k - 1] + internal->agert[i - 1] + internal->deathrt[i - 1], 1), 0);
      }
    }
  }
  for (int i = 1; i <= internal->dim_Lwt_mature; ++i) {
    internal->Lwt_mature[i - 1] = Rf_rbinom(round(internal->O_Lwt[i - 1]), internal->Lwt_mature_prob[i - 1]);
  }
  for (int i = 1; i <= internal->dim_O_S_1; ++i) {
    for (int j = 1; j <= internal->dim_O_S_2; ++j) {
      for (int k = 1; k <= internal->dim_O_S_3; ++k) {
        internal->O_S[i - 1 + internal->dim_O_S_1 * (j - 1) + internal->dim_O_S_12 * (k - 1)] = Rf_rbinom(round(S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1]), internal->O_S_prob[internal->dim_O_S_prob_12 * (k - 1) + internal->dim_O_S_prob_1 * (j - 1) + i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_Lwt; ++i) {
    state_next[0 + i - 1] = internal->Lwt_birth[i - 1] + Lwt[i - 1] - internal->O_Lwt[i - 1];
  }
  for (int i = 1; i <= internal->dim_inf_1_1; ++i) {
    for (int j = 1; j <= internal->dim_inf_1_2; ++j) {
      for (int k = 1; k <= internal->dim_inf_1_3; ++k) {
        internal->inf_1[i - 1 + internal->dim_inf_1_1 * (j - 1) + internal->dim_inf_1_12 * (k - 1)] = Rf_rbinom(round(internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]), internal->inf_1_prob[internal->dim_inf_1_prob_12 * (k - 1) + internal->dim_inf_1_prob_1 * (j - 1) + i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_Mwt_S; ++i) {
    state_next[internal->dim_Lwt + i - 1] = internal->Lwt_mature[i - 1] + Mwt_S[i - 1] - internal->O_Mwt_S[i - 1];
  }
  for (int i = 1; i <= internal->dim_age_S_trials_1; ++i) {
    for (int j = 1; j <= internal->dim_age_S_trials_2; ++j) {
      for (int k = 1; k <= internal->dim_age_S_trials_3; ++k) {
        internal->age_S_trials[i - 1 + internal->dim_age_S_trials_1 * (j - 1) + internal->dim_age_S_trials_12 * (k - 1)] = internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1] - internal->inf_1[internal->dim_inf_1_12 * (k - 1) + internal->dim_inf_1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->na; ++i) {
    for (int j = 1; j <= 2; ++j) {
      for (int k = 1; k <= internal->NP; ++k) {
        state_next[internal->offset_variable_I1 + i - 1 + internal->dim_I1_1 * (j - 1) + internal->dim_I1_12 * (k - 1)] = trunc(0.5 + internal->age_I1[internal->dim_age_I1_12 * (k - 1) + internal->dim_age_I1_1 * (j - 1) + i - 1] + internal->inf_1[internal->dim_inf_1_12 * (k - 1) + internal->dim_inf_1_1 * (j - 1) + i - 1] + I1[internal->dim_I1_12 * (k - 1) + internal->dim_I1_1 * (j - 1) + i - 1] - internal->O_I1[internal->dim_O_I1_12 * (k - 1) + internal->dim_O_I1_1 * (j - 1) + i - 1]);
      }
    }
  }
  for (int i = 1; i <= internal->dim_Y1_1; ++i) {
    for (int j = 1; j <= internal->dim_Y1_2; ++j) {
      for (int k = 1; k <= internal->dim_Y1_3; ++k) {
        internal->Y1[i - 1 + internal->dim_Y1_1 * (j - 1) + internal->dim_Y1_12 * (k - 1)] = internal->phi1[j - 1] * internal->inf_1[internal->dim_inf_1_12 * (k - 1) + internal->dim_inf_1_1 * (j - 1) + i - 1];
      }
    }
  }
  for (int i = 1; i <= internal->dim_age_S_1; ++i) {
    for (int j = 1; j <= internal->dim_age_S_2; ++j) {
      for (int k = 1; k <= internal->dim_age_S_3; ++k) {
        internal->age_S[i - 1 + internal->dim_age_S_1 * (j - 1) + internal->dim_age_S_12 * (k - 1)] = Rf_rbinom(round(internal->age_S_trials[internal->dim_age_S_trials_12 * (k - 1) + internal->dim_age_S_trials_1 * (j - 1) + i - 1]), internal->age_S_prob[i - 1]);
      }
    }
  }
  {
     int i = 1;
     for (int j = 1; j <= internal->NP; ++j) {
       internal->Y1T_sum[i - 1 + internal->dim_Y1T_sum_1 * (j - 1)] = internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 0 + i - 1] + internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 1 + i - 1];
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    for (int j = 1; j <= internal->NP; ++j) {
      internal->Y1T_sum[i - 1 + internal->dim_Y1T_sum_1 * (j - 1)] = internal->Y1T_sum[internal->dim_Y1T_sum_1 * (j - 1) + i - 1 - 1] + internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 0 + i - 1] + internal->Y1[internal->dim_Y1_12 * (j - 1) + internal->dim_Y1_1 * 1 + i - 1];
    }
  }
  {
     int i = 1;
     int j = 1;
     for (int k = 1; k <= internal->NP; ++k) {
       state_next[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = trunc(0.5 + internal->births[k - 1] + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    int j = 1;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = trunc(0.5 + internal->age_S[internal->dim_age_S_12 * (k - 1) + internal->dim_age_S_1 * (j - 1) + i - 1 - 1] + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
    }
  }
  {
     int i = 1;
     int j = 2;
     for (int k = 1; k <= internal->NP; ++k) {
       state_next[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = trunc(0.5 + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    int j = 2;
    for (int k = 1; k <= internal->NP; ++k) {
      state_next[internal->offset_variable_S + i - 1 + internal->dim_S_1 * (j - 1) + internal->dim_S_12 * (k - 1)] = trunc(0.5 + internal->age_S[internal->dim_age_S_12 * (k - 1) + internal->dim_age_S_1 * (j - 1) + i - 1 - 1] + S[internal->dim_S_12 * (k - 1) + internal->dim_S_1 * (j - 1) + i - 1] - internal->O_S[internal->dim_O_S_12 * (k - 1) + internal->dim_O_S_1 * (j - 1) + i - 1]);
    }
  }
  for (int i = 1; i <= internal->dim_Y1T; ++i) {
    internal->Y1T[i - 1] = internal->Y1T_sum[internal->dim_Y1T_sum_1 * (i - 1) + internal->na - 1] / (double) internal->NTp[i - 1];
  }
  for (int i = 1; i <= internal->dim_incubA; ++i) {
    state_next[internal->offset_variable_incubA + i - 1] = incubA[i - 1] + internal->Y1T[i - 1] - internal->DT * 2 * incubA[i - 1] / (double) internal->incub;
  }
  memcpy(output + internal->offset_output_rho1, internal->rho1, internal->dim_rho1 * sizeof(double));
  output[6] = TIME;
  memcpy(output + internal->offset_output_deathrt, internal->deathrt, internal->dim_deathrt * sizeof(double));
  output[4] = MwtCont;
  double eipav = (odin_sum1(internal->eip, 0, internal->dim_eip) - internal->eip[internal->NP - 1]) / (double) (internal->NP - 1);
  memcpy(output + 7, internal->agert, internal->dim_agert * sizeof(double));
  memcpy(output + internal->offset_output_eip, internal->eip, internal->dim_eip * sizeof(double));
  memcpy(output + internal->offset_output_infectious1, internal->infectious1, internal->dim_infectious1 * sizeof(double));
  memcpy(output + internal->offset_output_Mwt_tot, internal->Mwt_tot, internal->dim_Mwt_tot * sizeof(double));
  {
     int i = 1;
     for (int j = 1; j <= internal->NP; ++j) {
       internal->sum_S[i - 1 + internal->dim_sum_S_1 * (j - 1)] = S[internal->dim_S_12 * (j - 1) + internal->dim_S_1 * 0 + i - 1];
     }
  }
  for (int i = 2; i <= internal->na; ++i) {
    for (int j = 1; j <= internal->NP; ++j) {
      internal->sum_S[i - 1 + internal->dim_sum_S_1 * (j - 1)] = S[internal->dim_S_12 * (j - 1) + internal->dim_S_1 * 0 + i - 1] + internal->sum_S[internal->dim_sum_S_1 * (j - 1) + i - 1 - 1];
    }
  }
  double Deltaav = (odin_sum1(internal->Delta, 0, internal->dim_Delta) - internal->Delta[internal->NP - 1]) / (double) (internal->NP - 1);
  double Mwt_FOI1av = (odin_sum1(internal->Mwt_FOI1, 0, internal->dim_Mwt_FOI1) - internal->Mwt_FOI1[internal->NP - 1]) / (double) (internal->NP - 1);
  memcpy(output + internal->offset_output_births, internal->births, internal->dim_births * sizeof(double));
  memcpy(output + internal->offset_output_Delta, internal->Delta, internal->dim_Delta * sizeof(double));
  output[3] = eipav;
  memcpy(output + internal->offset_output_Mwt_FOI1, internal->Mwt_FOI1, internal->dim_Mwt_FOI1 * sizeof(double));
  memcpy(output + internal->offset_output_Ntotal, internal->Ntotal, internal->dim_Ntotal * sizeof(double));
  output[1] = Deltaav;
  output[5] = Mwt_FOI1av;
  memcpy(output + internal->offset_output_O_I1, internal->O_I1, internal->dim_O_I1 * sizeof(double));
  memcpy(output + internal->offset_output_O_R1, internal->O_R1, internal->dim_O_R1 * sizeof(double));
  double Kcav = (odin_sum1(internal->Kc, 0, internal->dim_Kc) - internal->Kc[internal->NP - 1]) / (double) (internal->NP - 1);
  memcpy(output + internal->offset_output_age_R1, internal->age_R1, internal->dim_age_R1 * sizeof(double));
  memcpy(output + internal->offset_output_Kc, internal->Kc, internal->dim_Kc * sizeof(double));
  memcpy(output + internal->offset_output_Lwt_birth, internal->Lwt_birth, internal->dim_Lwt_birth * sizeof(double));
  memcpy(output + internal->offset_output_NTp, internal->NTp, internal->dim_NTp * sizeof(double));
  memcpy(output + internal->offset_output_O_Mwt_E1, internal->O_Mwt_E1, internal->dim_O_Mwt_E1 * sizeof(double));
  memcpy(output + internal->offset_output_O_Mwt_S, internal->O_Mwt_S, internal->dim_O_Mwt_S * sizeof(double));
  memcpy(output + internal->offset_output_recov1, internal->recov1, internal->dim_recov1 * sizeof(double));
  for (int i = 1; i <= internal->dim_prop_Sp; ++i) {
    internal->prop_Sp[i - 1] = internal->sum_S[internal->dim_sum_S_1 * (i - 1) + internal->na - 1] / (double) internal->NTp[i - 1];
  }
  for (int i = 1; i <= internal->dim_FOI1Y; ++i) {
    internal->FOI1Y[i - 1] = internal->YL * internal->FOI1p[i - 1] / (double) internal->DT;
  }
  memcpy(output + internal->offset_output_FOI1p, internal->FOI1p, internal->dim_FOI1p * sizeof(double));
  output[2] = Kcav;
  memcpy(output + internal->offset_output_Mwt_inf1, internal->Mwt_inf1, internal->dim_Mwt_inf1 * sizeof(double));
  memcpy(output + internal->offset_output_prop_Sp, internal->prop_Sp, internal->dim_prop_Sp * sizeof(double));
  memcpy(output + internal->offset_output_age_I1, internal->age_I1, internal->dim_age_I1 * sizeof(double));
  output[0] = FOI1av;
  memcpy(output + internal->offset_output_FOI1nn, internal->FOI1nn, internal->dim_FOI1nn * sizeof(double));
  memcpy(output + internal->offset_output_FOI1Y, internal->FOI1Y, internal->dim_FOI1Y * sizeof(double));
  memcpy(output + internal->offset_output_FOI1, internal->FOI1, internal->dim_FOI1 * sizeof(double));
  memcpy(output + internal->offset_output_inf_1_prob, internal->inf_1_prob, internal->dim_inf_1_prob * sizeof(double));
  memcpy(output + internal->offset_output_O_S_prob, internal->O_S_prob, internal->dim_O_S_prob * sizeof(double));
  memcpy(output + internal->offset_output_Lwt_mature, internal->Lwt_mature, internal->dim_Lwt_mature * sizeof(double));
  memcpy(output + internal->offset_output_O_S, internal->O_S, internal->dim_O_S * sizeof(double));
  memcpy(output + internal->offset_output_inf_1, internal->inf_1, internal->dim_inf_1 * sizeof(double));
  memcpy(output + internal->offset_output_age_S, internal->age_S, internal->dim_age_S * sizeof(double));
  memcpy(output + internal->offset_output_Y1T, internal->Y1T, internal->dim_Y1T * sizeof(double));
}
void odin_model_stoch_rhs_dde(size_t n_eq, size_t step, double * state, double * state_next, size_t n_out, double * output, void * internal) {
  odin_model_stoch_rhs((odin_model_stoch_internal*)internal, step, state, state_next, output);
}
SEXP odin_model_stoch_rhs_r(SEXP internal_p, SEXP step, SEXP state) {
  SEXP state_next = PROTECT(allocVector(REALSXP, LENGTH(state)));
  odin_model_stoch_internal *internal = odin_model_stoch_get_internal(internal_p, 1);
  SEXP output_ptr = PROTECT(allocVector(REALSXP, 7 + internal->dim_agert + internal->dim_deathrt + internal->dim_births + internal->dim_Y1T + internal->dim_FOI1 + internal->dim_FOI1p + internal->dim_FOI1nn + internal->dim_prop_Sp + internal->dim_FOI1Y + internal->dim_Kc + internal->dim_eip + internal->dim_Delta + internal->dim_NTp + internal->dim_Mwt_FOI1 + internal->dim_rho1 + internal->dim_infectious1 + internal->dim_Mwt_tot + internal->dim_Lwt_birth + internal->dim_Mwt_inf1 + internal->dim_O_Mwt_E1 + internal->dim_O_Mwt_S + internal->dim_Lwt_mature + internal->dim_Ntotal + internal->dim_O_S + internal->dim_inf_1 + internal->dim_age_S + internal->dim_O_I1 + internal->dim_recov1 + internal->dim_age_I1 + internal->dim_O_R1 + internal->dim_age_R1 + internal->dim_inf_1_prob + internal->dim_O_S_prob));
  setAttrib(state_next, install("output"), output_ptr);
  UNPROTECT(1);
  double *output = REAL(output_ptr);
  GetRNGstate();
  odin_model_stoch_rhs(internal, INTEGER(step)[0], REAL(state), REAL(state_next), output);
  PutRNGstate();
  UNPROTECT(1);
  return state_next;
}
double user_get_scalar_double(SEXP user, const char *name,
                              double default_value, double min, double max) {
  double ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected a scalar numeric for '%s'", name);
    }
    if (TYPEOF(el) == REALSXP) {
      ret = REAL(el)[0];
    } else if (TYPEOF(el) == INTSXP) {
      ret = INTEGER(el)[0];
    } else {
      Rf_error("Expected a numeric value for %s", name);
    }
  }
  if (ISNA(ret)) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_double(&ret, 1, min, max, name);
  return ret;
}
int user_get_scalar_int(SEXP user, const char *name,
                        int default_value, double min, double max) {
  int ret = default_value;
  SEXP el = user_list_element(user, name);
  if (el != R_NilValue) {
    if (length(el) != 1) {
      Rf_error("Expected scalar integer for %d", name);
    }
    if (TYPEOF(el) == REALSXP) {
      double tmp = REAL(el)[0];
      if (fabs(tmp - round(tmp)) > 2e-8) {
        Rf_error("Expected '%s' to be integer-like", name);
      }
    }
    ret = INTEGER(coerceVector(el, INTSXP))[0];
  }
  if (ret == NA_INTEGER) {
    Rf_error("Expected a value for '%s'", name);
  }
  user_check_values_int(&ret, 1, min, max, name);
  return ret;
}
void user_check_values_double(double * value, size_t len,
                                  double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values_int(int * value, size_t len,
                               double min, double max, const char *name) {
  for (size_t i = 0; i < len; ++i) {
    if (ISNA(value[i])) {
      Rf_error("'%s' must not contain any NA values", name);
    }
  }
  if (min != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] < min) {
        Rf_error("Expected '%s' to be at least %g", name, min);
      }
    }
  }
  if (max != NA_REAL) {
    for (size_t i = 0; i < len; ++i) {
      if (value[i] > max) {
        Rf_error("Expected '%s' to be at most %g", name, max);
      }
    }
  }
}
void user_check_values(SEXP value, double min, double max,
                           const char *name) {
  size_t len = (size_t)length(value);
  if (TYPEOF(value) == INTSXP) {
    user_check_values_int(INTEGER(value), len, min, max, name);
  } else {
    user_check_values_double(REAL(value), len, min, max, name);
  }
}
SEXP user_list_element(SEXP list, const char *name) {
  SEXP ret = R_NilValue, names = getAttrib(list, R_NamesSymbol);
  for (int i = 0; i < length(list); ++i) {
    if(strcmp(CHAR(STRING_ELT(names, i)), name) == 0) {
      ret = VECTOR_ELT(list, i);
      break;
    }
  }
  return ret;
}
void odin_set_dim(SEXP target, int rank, ...) {
  SEXP r_dim = PROTECT(allocVector(INTSXP, rank));
  int *dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t)rank; ++i) {
    dim[i] = va_arg(ap, int);
  }
  va_end(ap);

  setAttrib(target, R_DimSymbol, r_dim);
  UNPROTECT(1);
}
void* user_get_array_dim(SEXP user, bool is_integer, void * previous,
                         const char *name, int rank,
                         double min, double max, int *dest_dim) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  dest_dim[0] = LENGTH(el);
  if (rank > 1) {
    SEXP r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
    int *dim = INTEGER(r_dim);

    for (size_t i = 0; i < (size_t) rank; ++i) {
      dest_dim[i + 1] = dim[i];
    }

    UNPROTECT(1);
  }

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  int len = LENGTH(el);
  void *dest = NULL;
  if (is_integer) {
    dest = Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  Free(previous);

  UNPROTECT(1);

  return dest;
}
void* user_get_array(SEXP user, bool is_integer, void * previous,
                     const char *name, double min, double max,
                     int rank, ...) {
  SEXP el = user_get_array_check_rank(user, name, rank, previous == NULL);
  if (el == R_NilValue) {
    return previous;
  }

  SEXP r_dim;
  int *dim;

  size_t len = LENGTH(el);
  if (rank == 1) {
    r_dim = PROTECT(ScalarInteger(len));
  } else {
    r_dim = PROTECT(coerceVector(getAttrib(el, R_DimSymbol), INTSXP));
  }
  dim = INTEGER(r_dim);

  va_list ap;
  va_start(ap, rank);
  for (size_t i = 0; i < (size_t) rank; ++i) {
    int dim_expected = va_arg(ap, int);
    if (dim[i] != dim_expected) {
      va_end(ap); // avoid a leak
      if (rank == 1) {
        Rf_error("Expected length %d value for %s", dim_expected, name);
      } else {
        Rf_error("Incorrect size of dimension %d of %s (expected %d)",
                 i + 1, name, dim_expected);
      }
    }
  }
  va_end(ap);
  UNPROTECT(1);

  el = PROTECT(user_get_array_check(el, is_integer, name, min, max));

  void *dest = NULL;
  if (is_integer) {
    dest = Calloc(len, int);
    memcpy(dest, INTEGER(el), len * sizeof(int));
  } else {
    dest = Calloc(len, double);
    memcpy(dest, REAL(el), len * sizeof(double));
  }
  Free(previous);

  UNPROTECT(1);

  return dest;
}
SEXP user_get_array_check(SEXP el, bool is_integer, const char *name,
                          double min, double max) {
  size_t len = (size_t) length(el);
  if (is_integer) {
    if (TYPEOF(el) == INTSXP) {
      user_check_values_int(INTEGER(el), len, min, max, name);
    } else if (TYPEOF(el) == REALSXP) {
      el = PROTECT(coerceVector(el, INTSXP));
      user_check_values_int(INTEGER(el), len, min, max, name);
      UNPROTECT(1);
    } else {
      Rf_error("Expected a integer value for %s", name);
    }
  } else {
    if (TYPEOF(el) == INTSXP) {
      el = PROTECT(coerceVector(el, REALSXP));
      user_check_values_double(REAL(el), len, min, max, name);
      UNPROTECT(1);
    } else if (TYPEOF(el) == REALSXP) {
      user_check_values_double(REAL(el), len, min, max, name);
    } else {
      Rf_error("Expected a numeric value for %s", name);
    }
  }
  return el;
}
SEXP user_get_array_check_rank(SEXP user, const char *name, int rank,
                               bool required) {
  SEXP el = user_list_element(user, name);
  if (el == R_NilValue) {
    if (required) {
      Rf_error("Expected a value for '%s'", name);
    }
  } else {
    if (rank == 1) {
      if (isArray(el)) {
        Rf_error("Expected a numeric vector for '%s'", name);
      }
    } else {
      SEXP r_dim = getAttrib(el, R_DimSymbol);
      if (r_dim == R_NilValue || LENGTH(r_dim) != rank) {
        if (rank == 2) {
          Rf_error("Expected a numeric matrix for '%s'", name);
        } else {
          Rf_error("Expected a numeric array of rank %d for '%s'", rank, name);
        }
      }
    }
  }
  return el;
}
double odin_sum1(double *x, size_t from, size_t to) {
  double tot = 0.0;
  for (size_t i = from; i < to; ++i) {
    tot += x[i];
  }
  return tot;
}
double odin_sum2(double* x, int from_i, int to_i, int from_j, int to_j, int dim_x_1) {
  double tot = 0.0;
  for (int j = from_j; j < to_j; ++j) {
    int jj = j * dim_x_1;
    for (int i = from_i; i < to_i; ++i) {
      tot += x[i + jj];
    }
  }
  return tot;
}
double odin_sum3(double* x, int from_i, int to_i, int from_j, int to_j, int from_k, int to_k, int dim_x_1, int dim_x_12) {
  double tot = 0.0;
  for (int k = from_k; k < to_k; ++k) {
    int kk = k * dim_x_12;
    for (int j = from_j; j < to_j; ++j) {
      int jj = j * dim_x_1 + kk;
      for (int i = from_i; i < to_i; ++i) {
        tot += x[i + jj];
      }
    }
  }
  return tot;
}
