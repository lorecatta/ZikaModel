---
title: "Run a seasonal model"
author: "Lorenzo Cattarino"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Run a seasonal model}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
library(ZikaModel)
```

## Seasonality 
The model allows to account for the effect of seasonal variations in climatic 
variables (e.g. temperature and precipitation) on Zika transmission dynamics. 
In the model, seasonality affects: 

* adult mosquitoes mortality;
* mosquito larvae carrying capacity;
* Extrinsic Incubation Period.

A deterministic model which includes the effect of seasonality can be implemented
with the following:

```{r}
age_init <- c(1, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10)
  
deathrt <- c(1e-10, 
             1e-10, 
             1e-10, 
             0.00277068683332695, 
             0.0210680857689784,
             0.026724997685722,
             0.0525354529367476,
             0.0668013582441452,
             0.119271483740379,
             0.279105747097929,
             0.390197266957464)

time_frame <- 364 * 100

model_outputs <- run_model(agec = age_init,
                           death = deathrt,
                           nn_links,
                           time = time_frame,
                           season = TRUE)
```

Now postprocessing and plotting with 

```{r, fig.height = 4, fig.width = 6}
diagnostics <- post_processing(model_outputs)

plot_compartments(diagnostics$compartments)
```

The dynamics look more jagged compared to the baseline model due to the effect of seasonality on transmission which makes them jumping more up and down. 

```{r, fig.height = 6, fig.width = 8}
plot_demographics(diagnostics$demographics)
```
